/*! For license information please see player.v2.modern.js.LICENSE.txt */
(()=>{function e(i){var n=r[i];if(void 0!==n)return n.exports;var o=r[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={4661:(e,t,r)=>{(t=e.exports=r(6805)(!1)).push([e.id,"._1gZJUfw{user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;position:relative;background:#000;background-position:center;background-size:contain;background-repeat:no-repeat;width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;text-align:left;outline:0}._2jlIyxK{width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;user-select:none;text-align:left;outline:0;position:absolute;top:0;left:0;pointer-events:none;background:0 0}._1gZJUfw ._17DR8Wz{display:none!important}._1gZJUfw>iframe.KNlHF8r{position:absolute;width:100%;height:100%;border:0}._1gZJUfw .xDBHr4L{position:absolute;width:100%;height:100%;pointer-events:none}._1gZJUfw video{width:100%;height:100%}._1gZJUfw video::-webkit-media-controls-start-playback-button{z-index:2147483647!important}._1gZJUfw video._33stY3F::-webkit-media-controls-start-playback-button{display:none!important}",""]),t.locals={StreamPlayer:"_1gZJUfw",StreamPlayer_ui:"_2jlIyxK",hidden:"_17DR8Wz",container:"KNlHF8r",adSkin:"xDBHr4L","hide-native-play-button":"_33stY3F"}},8024:(e,t,r)=>{var i=r(3379),n=r(866);"string"===typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-ya-player-style":"data-ya-player-style"},insert:"head",singleton:!0};i(n,o);e.exports=n.locals||{}},3379:(e,t,r)=>{"use strict";function i(e){for(var t=-1,r=0;r<p.length;r++)if(p[r].identifier===e){t=r;break}return t}function n(e,t){for(var r={},n=[],o=0;o<e.length;o++){var a=e[o],s=t.base?a[0]+t.base:a[0],d=r[s]||0,c="".concat(s," ").concat(d);r[s]=d+1;var u=i(c),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==u?(p[u].references++,p[u].updater(h)):p.push({identifier:c,updater:l(h,t),references:1}),n.push(c)}return n}function o(e){var t=document.createElement("style"),i=e.attributes||{};if("undefined"===typeof i.nonce){var n=r.nc;n&&(i.nonce=n)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"===typeof e.insert)e.insert(t);else{var o=h(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}function a(e,t,r,i){var n=r?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=f(t,n);else{var o=document.createTextNode(n),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function s(e,t,r){var i=r.css,n=r.media,o=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function l(e,t){var r,i,n;if(t.singleton){var l=g++;r=v||(v=o(t)),i=a.bind(null,r,l,!1),n=a.bind(null,r,l,!0)}else r=o(t),i=s.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}var d,c,u=function(){return"undefined"===typeof d&&(d=Boolean(window&&document&&document.all&&!window.atob)),d},h=function(){var e={};return function(t){if("undefined"===typeof e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(i){r=null}e[t]=r}return e[t]}}(),p=[],f=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")}),v=null,g=0;e.exports=function(e,t){(t=t||{}).singleton||"boolean"===typeof t.singleton||(t.singleton=u());var r=n(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<r.length;o++){var a=i(r[o]);p[a].references--}for(var s=n(e,t),l=0;l<r.length;l++){var d=i(r[l]);0===p[d].references&&(p[d].updater(),p.splice(d,1))}r=s}}}},6197:(e,t)=>{"use strict";t.Z=function(e,t,r){for(var i=e.length+t.length,n=new Array(i),o=0,a=0,s=0;s<i;){var l=o>=e.length,d=a>=t.length;!l&&(d||r(e[o],t[a])<0)?(n[s]=e[o],o++):(n[s]=t[a],a++),s++}return n}},5983:e=>{e.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r]);return e})},1299:(e,t)=>{"use strict";function r(e,t){try{return t(e)}catch(r){return e}}t.parse=function(e,t){if("string"!==typeof e)throw new TypeError("argument str must be a string");for(var n={},a=t||{},s=e.split(o),l=a.decode||i,d=0;d<s.length;d++){var c=s[d],u=c.indexOf("=");if(!(u<0)){var h=c.substr(0,u).trim(),p=c.substr(++u,c.length).trim();'"'==p[0]&&(p=p.slice(1,-1)),void 0==n[h]&&(n[h]=r(p,l))}}return n},t.serialize=function(e,t,r){var i=r||{},o=i.encode||n;if("function"!==typeof o)throw new TypeError("option encode is invalid");if(!a.test(e))throw new TypeError("argument name is invalid");var s=o(t);if(s&&!a.test(s))throw new TypeError("argument val is invalid");var l=e+"="+s;if(null!=i.maxAge){var d=i.maxAge-0;if(isNaN(d))throw new Error("maxAge should be a Number");l+="; Max-Age="+Math.floor(d)}if(i.domain){if(!a.test(i.domain))throw new TypeError("option domain is invalid");l+="; Domain="+i.domain}if(i.path){if(!a.test(i.path))throw new TypeError("option path is invalid");l+="; Path="+i.path}if(i.expires){if("function"!==typeof i.expires.toUTCString)throw new TypeError("option expires is invalid");l+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(l+="; HttpOnly"),i.secure&&(l+="; Secure"),i.sameSite)switch("string"===typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"strict":l+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}return l};var i=decodeURIComponent,n=encodeURIComponent,o=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},6805:e=>{function t(e,t){var r,i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"===typeof btoa){var o=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[i].concat(a).concat([o]).join("\n")}return[i].join("\n")}e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var i=t(r,e);return r[2]?"@media "+r[2]+"{"+i+"}":i})).join("")},r.i=function(e,t){"string"===typeof e&&(e=[[null,e,""]]);for(var i={},n=0;n<this.length;n++){var o=this[n][0];"number"===typeof o&&(i[o]=!0)}for(n=0;n<e.length;n++){var a=e[n];"number"===typeof a[0]&&i[a[0]]||(t&&!a[2]?a[2]=t:t&&(a[2]="("+a[2]+") and ("+t+")"),r.push(a))}},r}},6386:e=>{e.exports=function(e){e||(e=window);var t=e.navigator.userAgent,r=t.indexOf("MSIE ");if(r>0)return parseInt(t.substring(r+5,t.indexOf(".",r)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var n=t.indexOf("Edge/");return n>0&&parseInt(t.substring(n+5,t.indexOf(".",n)),10)}},6048:e=>{"use strict";var t=Array.isArray,r=Object.keys,i=Object.prototype.hasOwnProperty;e.exports=function e(n,o){if(n===o)return!0;if(n&&o&&"object"==typeof n&&"object"==typeof o){var a,s,l,d=t(n),c=t(o);if(d&&c){if((s=n.length)!=o.length)return!1;for(a=s;0!==a--;)if(!e(n[a],o[a]))return!1;return!0}if(d!=c)return!1;var u=n instanceof Date,h=o instanceof Date;if(u!=h)return!1;if(u&&h)return n.getTime()==o.getTime();var p=n instanceof RegExp,f=o instanceof RegExp;if(p!=f)return!1;if(p&&f)return n.toString()==o.toString();var v=r(n);if((s=v.length)!==r(o).length)return!1;for(a=s;0!==a--;)if(!i.call(o,v[a]))return!1;for(a=s;0!==a--;)if(!e(n[l=v[a]],o[l]))return!1;return!0}return n!==n&&o!==o}},6394:e=>{function t(){var e,t,r,i,n=document.createElement("canvas");try{e=n.getContext("webgl")||n.getContext("experimental-webgl")}catch(o){}return e&&(t=e.getExtension("WEBGL_debug_renderer_info"),r=e.getParameter(t.UNMASKED_VENDOR_WEBGL),i=e.getParameter(t.UNMASKED_RENDERER_WEBGL)),{debugInfo:t,vendor:r,renderer:i}}e.exports=t,e.exports.getGpu=t},7179:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ErrorDetails:()=>n,ErrorTypes:()=>i});const i={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},n={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},1673:(e,t,r)=>{"use strict";function i(){const e=function(){if("undefined"!==typeof window)return window.MediaSource||window.WebKitMediaSource}(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"===typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove;return!!r&&!!i}r.r(t),r.d(t,{isSupported:()=>i})},5508:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TALB:"album",TBPM:"bpm",TCOM:"composer",TCON:"genre",TCOP:"copyright",TDEN:"encoding-time",TDLY:"playlist-delay",TDOR:"original-release-time",TDRC:"recording-time",TDRL:"release-time",TDTG:"tagging-time",TENC:"encoder",TEXT:"writer",TFLT:"file-type",TIPL:"involved-people",TIT1:"content-group",TIT2:"title",TIT3:"subtitle",TKEY:"initial-key",TLAN:"language",TLEN:"length",TMCL:"credits",TMED:"media-type",TMOO:"mood",TOAL:"original-album",TOFN:"original-filename",TOLY:"original-writer",TOPE:"original-artist",TOWN:"owner",TPE1:"artist",TPE2:"band",TPE3:"conductor",TPE4:"remixer",TPOS:"set-part",TPRO:"produced-notice",TPUB:"publisher",TRCK:"track",TRSN:"radio-name",TRSO:"radio-owner",TSOA:"album-sort",TSOP:"performer-sort",TSOT:"title-sort",TSRC:"isrc",TSSE:"encoder-settings",TSST:"set-subtitle",TXXX:"user-defined-text-information",TYER:"year",WCOM:"url-commercial",WCOP:"url-legal",WOAF:"url-file",WOAR:"url-artist",WOAS:"url-source",WORS:"url-radio",WPAY:"url-payment",WPUB:"url-publisher",WAF:"url-file",WAR:"url-artist",WAS:"url-source",WCM:"url-commercial",WCP:"url-copyright",WPB:"url-publisher",COMM:"comments",USLT:"lyrics",APIC:"image",PIC:"image",IPLS:"involved-people-list",OWNE:"ownership"},t.FrameTypeValueMap={TXXX:"array",COMM:"array",USLT:"array"}},3940:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop / Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast  Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Rock/Pop"]},4053:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["other","file-icon","icon","cover-front","cover-back","leaflet","media","artist-lead","artist","conductor","band","composer","lyricist-writer","recording-location","during-recording","during-performance","screen","fish","illustration","logo-band","logo-publisher"]},6636:function(e,t,r){"use strict";var i=this&&this.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},n=this&&this.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(r[i[n]]=e[i[n]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var o=r(6449);t.parseV1Tag=o.default;var a=r(3796);t.parseV2Tag=a.default,r(1689).default(),t.parse=function(e){var t=o.default(e),r=a.default(e);if(!r&&!t)return!1;var s={version:!1},l=r||s,d=l.version,c=n(l,["version"]),u=t||s,h=u.version,p=n(u,["version"]),f=i({version:{v1:h,v2:d}},p,c);return p.comments&&(f.comments=[{value:p.comments}].concat(c&&c.comments?c.comments:[])),f}},6449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(3940),n=r(9107);t.default=function(e){if(!e||e.length<128)return!1;e=e.slice(e.length-128);var t={version:{major:1,minor:0}};if("TAG"!==n.readBytesToUTF8(e,3))return!1;var r=/(^[\s0]+|[\s0]+$)/;return t.title=n.readBytesToUTF8(e.slice(3),30).replace(r,""),t.artist=n.readBytesToUTF8(e.slice(33),30).replace(r,""),t.album=n.readBytesToUTF8(e.slice(63),30).replace(r,""),t.year=n.readBytesToUTF8(e.slice(93),4).replace(r,""),0===e[125]?(t.comments=n.readBytesToUTF8(e.slice(97),28).replace(r,""),t.version.minor=1,t.track=e[126]):t.comments=n.readBytesToUTF8(e.slice(97),30).replace(r,""),t.genre=i.default[e[127]]||"",t}},3796:(e,t,r)=>{"use strict";function i(e){return 2097152*(127&e[0])+16384*(127&e[1])+128*(127&e[2])+(127&e[3])}function n(e){return e.length<4?0:16777216*e[0]+65536*e[1]+256*e[2]+e[3]}function o(e,t,r){var i={id:null,tag:null,value:null},n={id:d.readBytesToUTF8(e,4),type:null,size:r,flags:[e[8],e[9]]};if(n.type=n.id[0],i.id=n.id,0!==n.flags[1])return i;if(!(n.id in a.default))return i;i.tag=a.default[n.id];var o=0,c=0,u=0,h=0;if("T"===n.type){if(o=e[10],"TXXX"===n.id){c=11,u=d.getEndpointOfBytes(e,o,c)-c;var p={description:d.readBytesToString(e.slice(c),o,u),value:""};c+=u+1,c=d.skipPaddingZeros(e,c),p.value=d.readBytesToString(e.slice(c),o),i.value=p}else if(i.value=d.readBytesToString(e.slice(11),o),"TCON"===n.id&&null!==i.value)if("("===i.value[0]){var f=i.value.match(/\(\d+\)/g);f&&(i.value=f.map((function(e){return s.default[+e.slice(1,-1)]})).join(","))}else{var v=parseInt(i.value,10);isNaN(v)||(i.value=s.default[v])}}else if("W"===n.type)"WXXX"===n.id&&0===e[10]?i.value=d.readBytesToISO8859(e.slice(11)):i.value=d.readBytesToISO8859(e.slice(10));else if("COMM"===n.id||"USLT"===n.id){o=e[10],c=14,u=0;var g=d.readBytesToISO8859(e.slice(11),3);u=d.getEndpointOfBytes(e,o,c)-c;var m=d.readBytesToString(e.slice(c),o,u);c=d.skipPaddingZeros(e,c+u+1),i.value={language:g,description:m,value:d.readBytesToString(e.slice(c),o)}}else if("APIC"===n.id){o=e[10];var E={type:null,mime:null,description:null,data:null};for(c=11,u=d.getEndpointOfBytes(e,0,c)-c,E.mime=d.readBytesToString(e.slice(c),0,u),E.type=l.default[e[c+u+1]]||"other",c+=u+2,u=0,h=c;;h++)if(0===e[h]){u=h-c;break}E.description=0===u?null:d.readBytesToString(e.slice(c),o,u),c=d.skipPaddingZeros(e,c+u+1),E.data=e.slice(c),i.value=E}else if("IPLS"===n.id)o=e[10],i.value=d.readBytesToString(e.slice(11),o);else if("OWNE"===n.id){o=e[10],c=11,u=d.getEndpointOfBytes(e,o,c);var A=d.readBytesToISO8859(e.slice(c),u);c+=u+1;var y=d.readBytesToISO8859(e.slice(c),8);c+=8,i.value={pricePayed:A,dateOfPurch:y,seller:d.readBytesToString(e.slice(c),o)}}return i}Object.defineProperty(t,"__esModule",{value:!0});var a=r(5508),s=r(3940),l=r(4053),d=r(9107);t.default=function(e){if(!e||e.length<20)return!1;var t=function(e){if(!e||e.length<10)return!1;if("ID3"!==d.readBytesToUTF8(e,3))return!1;var t=e[5];return{version:{major:2,minor:e[3],revision:e[4],flags:{unsync:0!==(128&t),xheader:0!==(64&t),experimental:0!==(32&t)}}}}(e.slice(0,10));if(!t)return!1;var r=t.version.flags;if(r.unsync)throw new Error("no support for unsynchronisation");var s=10;r.xheader&&(s+=i(e.slice(10,14)));var l=i(e.slice(6,10));return function(e,t){var r=0,i=t.version;for(;r<e.length;){var s=n(e.slice(r+4));if(0===s)break;var l=e.slice(r,r+10+s);if(!l.length)break;var d=o(l,i.minor,s);d.tag&&("array"===a.FrameTypeValueMap[d.id]?t[d.tag]?t[d.tag].push(d.value):t[d.tag]=[d.value]:t[d.tag]=d.value),r+=l.length}}(e.slice(s,l+s),t),t},t.calcTagSize=i,t.calcFrameSize=n},1689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){"function"!==typeof Uint8Array||Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice})}},9107:(e,t)=>{"use strict";function r(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);var r=0;239===e[0]&&187===e[1]&&191===e[2]&&(r=3);for(var i=[],n=0;r<t;n++){var a=e[r++],s=void 0,l=void 0,d=void 0;if(0===a)break;a<128?i[n]=o(a):a>=194&&a<224?(s=e[r++],i[n]=o(((31&a)<<6)+(63&s))):a>=224&&a<240?(s=e[r++],l=e[r++],i[n]=o(((15&a)<<12)+((63&s)<<6)+(63&l))):a>=240&&a<245&&(d=((7&a)<<18)+((63&(s=e[r++]))<<12)+((63&(l=e[r++]))<<6)+(63&e[r++])-65536,i[n]=o(55296+(d>>10),56320+(1023&d)))}return i.join("")}function i(e,t,r){r=null==r||r<0?e.length:Math.min(r,e.length);var i=0,n=1,a=0;254===e[0]&&255===e[1]?(t=!0,i=2):255===e[0]&&254===e[1]&&(t=!1,i=2),t&&(n=0,a=1);for(var s,l,d,c,u=[],h=0;i<r&&(s=e[i+n],l=e[i+a],i+=2,0!==(d=(s<<8)+l));h++)s<216||s>=224?u[h]=o(d):(c=(e[i+n]<<8)+e[i+a],i+=2,u[h]=o(d,c));return u.join("")}function n(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);for(var r=[],i=0;i<t;i++)r.push(o(e[i]));return r.join("")}Object.defineProperty(t,"__esModule",{value:!0});var o=String.fromCharCode;t.readBytesToUTF8=r,t.readBytesToUTF16=i,t.readBytesToISO8859=n,t.readBytesToString=function(e,t,o){return 0===t?n(e,o):3===t?r(e,o):1===t||2===t?i(e,void 0,o):null},t.getEndpointOfBytes=function(e,t,r){void 0===r&&(r=0);for(var i=0===t?function(t){return 0===e[t]}:function(t){return 0===e[t]&&0===e[t+1]},n=r;n<e.length&&!i(n);n++);return n},t.skipPaddingZeros=function(e,t){for(var r=t;0===e[r];r++)t++;return t}},502:(e,t,r)=>{"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.hasCookies=function(){var e=new c;try{e.setItem("__test","1");var t=e.getItem("__test");return e.removeItem("__test"),"1"===t}catch(r){return!1}};var a,s=r(1299),l=(a=s)&&a.__esModule?a:{default:a},d="lS_",c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.cookieOptions=i({path:"/"},t),d=t.prefix||d}return o(e,[{key:"getItem",value:function(e){var t=l.default.parse(document.cookie);return t&&t.hasOwnProperty(d+e)?t[d+e]:null}},{key:"setItem",value:function(e,t){return document.cookie=l.default.serialize(d+e,t,this.cookieOptions),t}},{key:"removeItem",value:function(e){var t=i({},this.cookieOptions,{maxAge:-1});return document.cookie=l.default.serialize(d+e,"",t),null}},{key:"clear",value:function(){var e=l.default.parse(document.cookie);for(var t in e)0===t.indexOf(d)&&this.removeItem(t.substr(d.length));return null}}]),e}();t.default=c},4585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return r(e,[{key:"getItem",value:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0}},{key:"setItem",value:function(e,t){return this._data[e]=String(t)}},{key:"removeItem",value:function(e){return delete this._data[e]}},{key:"clear",value:function(){return this._data={}}}]),e}();t.default=i},2741:(e,t,r)=>{"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=i(r(1402)),o=i(r(502)),a=i(r(4585)),s=null;s=(0,n.default)("localStorage")?window.localStorage:(0,n.default)("sessionStorage")?window.sessionStorage:(0,n.default)("cookieStorage")?new o.default:new a.default,t.ZP=s,n.default,o.default,a.default},1402:(e,t,r)=>{"use strict";function i(e){try{var t=window[e];return t.setItem("__test","1"),t.removeItem("__test"),!0}catch(r){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"localStorage",t=String(e).replace(/storage$/i,"").toLowerCase();if("local"===t)return i("localStorage");if("session"===t)return i("sessionStorage");if("cookie"===t)return(0,n.hasCookies)();if("memory"===t)return!0;throw new Error("Storage method `"+e+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.")};var n=r(502)},5264:(e,t)=>{"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};t.S=function(e){function t(){s===a&&(s=a.slice())}function i(e){if("function"!==typeof e)throw new Error("Expected listener to be a function.");var r=!0;return t(),s.push(e),function(){if(r){r=!1,t();var i=s.indexOf(e);s.splice(i,1)}}}function n(){for(var e=a=s,t=0;t<e.length;t++)e[t]()}function o(){e(n)}if("function"!==typeof e)throw new Error("Expected batch to be a function.");var a=[],s=a;return function(e){return function(){function t(){var e=n.dispatch.apply(n,arguments);return o(),e}var n=e.apply(void 0,arguments),a=n.subscribe;return r({},n,{dispatch:t,subscribe:i,subscribeImmediate:a})}}}},8139:e=>{"use strict";e.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=t[r]);return e})},4957:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i}),e=r.hmd(e);const i=function(e){var t,r=e.Symbol;return"function"===typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:e)},3012:e=>{e.exports={config:{staticApi:"static.dzeninfra.ru",strmApi:"cdn.dzen.ru",gogolApi:"log.dzen.ru",s3:"s3.dzeninfra.ru",avatars:"avatars.dzeninfra.ru"}}},866:(e,t,r)=>{(t=e.exports=r(6805)(!1)).push([e.id,"video._20Eh5WL::-webkit-media-controls{display:none!important}video._1ll4Zna::-webkit-media-controls-current-time-display,video._1ll4Zna::-webkit-media-controls-time-remaining-display{visibility:hidden!important}video._3D52tih::-webkit-media-controls-timeline{visibility:hidden!important}video._2yNfXKt::-webkit-media-controls-toggle-closed-captions-button{display:none}",""]),t.locals={video_hiddenControls:"_20Eh5WL",videoHiddenControls:"_20Eh5WL",video_hiddenTime:"_1ll4Zna",videoHiddenTime:"_1ll4Zna",video_hiddenTimeline:"_3D52tih",videoHiddenTimeline:"_3D52tih",video_hiddenSubtitlesBtn:"_2yNfXKt",videoHiddenSubtitlesBtn:"_2yNfXKt"}}},r={};e.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},e.d=(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),e.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";function t(e){e&&"function"===typeof e.catch&&e.catch(e=>{})}function r(e,t){try{return e()}catch(r){"function"===typeof t&&t(r)}}function i(e){const t=e.document;let r=t.getElementsByTagName("head")[0];return r||(r=t.createElement("head"),t.documentElement.appendChild(r)),r}function n(e){return"function"===typeof e||"Function"===ss(e)}function o(e){void 0===e&&(e=window);try{return(e.navigator||{}).userAgent||""}catch(t){return""}}function a(e){if(void 0===e)return hs.DEFAULT;const t=function(e){switch(e){case ps.DEFAULT_ERROR:return hs.DEFAULT;case ps.BROADCAST_AD_BLOCK_INIT_ERROR:case ps.AD_TYPE_IS_NOT_RECOGNIZED:case ps.AD_IS_ALREADY_PLAYING:case ps.MULTIROLL_INIT_ERROR:case ps.PLAY_AD_VIEWERS_ERROR:return hs.ADS;case ps.INVALID_METADATA:case ps.NO_STREAMS:return hs.CONFIG;case ps.YANDEX_RPC_ERROR:case ps.ON_TICK_ERROR:case ps.SAGA_ERROR:case ps.SHAKA_FILTER_ERROR:case ps.SHAKA_CONFIGURE_ERROR:case ps.SHAKA_LOAD_SOURCE_ERROR:case ps.REFRESH_SUBTITLES_ERROR:case ps.NO_HLS_JS_INSTANCE:case ps.REACT_COMPONENT_DID_CATCH_ERROR_INFO:case ps.RECOVER_TASK_ERROR:case ps.PRELOAD_SOURCE_FAILED:case ps.MEDIA_ERR_ABORTED:return hs.EXCEPTION;case ps.UNSUPPORTED_MEDIA_TYPE:case ps.NATIVE_HLS_NOT_SUPPORTED_ERROR:case ps.HLS_JS_NOT_SUPPORTED_ERROR:case ps.MEDIA_ERR_SRC_NOT_SUPPORTED:case ps.MEDIA_ERR_CUSTOM:case ps.MEDIA_ERR_DECODE:case ps.REPRESENTATION_CHANGE:return hs.MEDIA;case ps.SCRIPT_INIT_ERROR:case ps.MPD_SHAKA_INIT_ERROR:case ps.META_INFO_REQUEST_FAILED:case ps.STRM_ABD_INVALID_RESPONSE:return hs.NETWORK_PLAYER;case ps.MEDIA_ERR_NETWORK:return hs.NETWORK_MEDIA;case ps.MPD_WIDEVINE_CERT_LOAD_ERROR:case ps.FAIRPLAY_CERT_LOAD_ERROR:case ps.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR:case ps.FAIRPLAY_CREATE_KEY_SESSION_ERROR:case ps.FAIRPLAY_SPC_LOAD_ERROR:case ps.FAIRPLAY_CREATE_KEY_ERROR:case ps.FAIRPLAY_INVALID_CONTENT_ID:case ps.DRM_PROXY_ERROR:case ps.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:case ps.MEDIA_ERR_ENCRYPTED:case ps.FAIRPLAY_NOT_SUPPORTED:case ps.NO_DRM:return hs.DRM;case ps.REGIONAL_LIMITATION_MANIFEST:case ps.REGIONAL_LIMITATION_LEVEL:case ps.REGIONAL_LIMITATION_SEGMENT:return hs.REGIONAL;case ps.SIGNATURE_EXPIRED_MANIFEST:case ps.SIGNATURE_EXPIRED_LEVEL:case ps.SIGNATURE_EXPIRED_SEGMENT:return hs.ACCESS;case ps.NO_CODECS:return hs.NO_CODECS;case ps.NO_PLAYABLE_STREAMS:return hs.CANNOT_PLAY;case ps.NO_MSE:return hs.UNSUPPORTED_ENV;case ps.INVALID_STREAM_URL:return hs.INVALID_STREAM_URL}return hs.DEFAULT}(e);if(t!==hs.DEFAULT)return t;switch(e){case fs.BUFFER_FULL_ERROR:case fs.BUFFER_NUDGE_ON_STALL:case fs.BUFFER_STALLED_ERROR:case fs.SHAKA_VIDEO_ERROR_3016:case fs.FRAG_PARSING_ERROR:case fs.BUFFER_SEEK_OVER_HOLE:case fs.BUFFER_APPENDING_ERROR:case fs.PIPELINE_ERROR_DECODE:case fs.DECODER_ERROR_NOT_SUPPORTED:case fs.BUFFER_APPEND_ERROR:case fs.SHAKA_MEDIA_SOURCE_OPERATION_THREW_3015:case fs.MEDIA_ELEMENT_ERROR_FORMAT_ERROR:case fs.REMUX_ALLOC_ERROR:case fs.BUFFER_ADD_CODEC_ERROR:case fs.DEMUXER_ERROR_COULD_NOT_OPEN:case fs.NS_ERROR_DOM_INVALID_STATE_ERR:case fs.SHAKA_DASH_INVALID_XML_4001:case fs.SHAKA_QUOTA_EXCEEDED_ERROR_3017:case fs.CHUNK_DEMUXER_ERROR_APPEND_FAILED:case fs.FAILED_TO_INIT_DECODER:case fs.PIPELINE_ERROR_INITIALIZATION_FAILED:case fs.NS_ERROR_FAILURE:case fs.SHAKA_MEDIA_SOURCE_OPERATION_FAILED_3014:case fs.REQUEST_FAILED:case fs.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED:case fs.PIPELINE_ERROR_COULD_NOT_RENDER:case fs.NS_ERROR_DOM_MEDIA_METADATA_ERR:case fs.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE:case fs.NS_ERROR_DOM_MEDIA_FATAL_ERR:case fs.SHAKA_RESTRICTIONS_CANNOT_BE_MET_4012:case fs.MANIFEST_PARSING_ERROR:return hs.MEDIA;case fs.FRAG_LOAD_ERROR:case fs.SHAKA_BAD_HTTP_STATUS_1001_MANIFEST:case fs.SHAKA_HTTP_ERROR_1002_SEGMENT:case fs.MANIFEST_LOAD_ERROR:case fs.LEVEL_LOAD_ERROR:case fs.SHAKA_HTTP_ERROR_1002_MANIFEST:case fs.SHAKA_BAD_HTTP_STATUS_1001_SEGMENT:case fs.SHAKA_UNSUPPORTED_SCHEME_1000:case fs.AUDIO_TRACK_LOAD_ERROR:return hs.NETWORK_MEDIA;case fs.SHAKA_TIMEOUT_1003_SEGMENT:case fs.FRAG_LOAD_TIME_OUT:case fs.MANIFEST_LOAD_TIME_OUT:case fs.LEVEL_LOAD_TIME_OUT:case fs.SHAKA_TIMEOUT_1003_MANIFEST:case fs.SHAKA_TIMEOUT_1003_LICENSE:case fs.AUDIO_TRACK_LOAD_TIME_OUT:return hs.NETWORK_TIMEOUT;case fs.INTERNAL_EXCEPTION:case fs.SHAKA_OPERATION_ABORTED_7001:case fs.ON_PLAYER_INIT_ERROR_INTERNAL:case fs.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case fs.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case fs.LOAD_SKIN_ERROR:case fs.INSERT_INTO_WITH_SECURE_FRAME:case fs.ERROR_SCREEN_LOAD_ERROR:return hs.EXCEPTION;case fs.UNABLE_TO_LOAD_PLAYER_IFRAME:case fs.ON_PLAYER_INIT_ERROR:case fs.LOADER_INIT_ERROR:case fs.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT:case fs.FAILED_TO_DOWNLOAD_DEBUG_INFO:case fs.SHAKA_REQUEST_FILTER_ERROR_1006:return hs.NETWORK_PLAYER;case fs.PLAYER_CONTAINER_NOT_FOUND:case fs.KEY_LOAD_ERROR:case fs.FEATURE_HANDLER_ERROR:case fs.SHAKA_NO_LICENSE_SERVER_GIVEN_6012:case fs.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER:case fs.INVALID_CONFIG_LANG_IN_CREATE_PLAYER:case fs.INVALID_CONFIG_IN_CREATE_PLAYER:case fs.INVALID_CONFIG_IN_SET_SOURCE:case fs.INVALID_CONFIG_IN_SOURCE_UPDATE:case fs.ELEMENT_NOT_IN_DOM:return hs.CONFIG;case fs.SHAKA_FAILED_TO_CREATE_CDM_6002:case fs.SHAKA_HTTP_ERROR_1002_LICENSE:case fs.SHAKA_LICENSE_REQUEST_FAILED_6007:case fs.SHAKA_FAILED_TO_GENERATE_LICENSE_REQUEST_6006:case fs.SHAKA_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001:case fs.SHAKA_FAILED_TO_ATTACH_TO_VIDEO_6003:case fs.SHAKA_LICENSE_RESPONSE_REJECTED_6008:case fs.SHAKA_INVALID_SERVER_CERTIFICATE_6004:case fs.SHAKA_EXPIRED_6014:case fs.SHAKA_BAD_HTTP_STATUS_1001_LICENSE:return hs.DRM;case fs.SHAKA_CONTENT_UNSUPPORTED_BY_BROWSER_4032:return hs.NO_CODECS}return hs.DEFAULT}function s(e,t){if(void 0===t&&(t=!1),e===ps.NO_CODECS&&cs&&us>6)return{title:"NO_CODECS_TITLE",message:"NO_CODECS_MESSAGE",helpLink:"https://yandex.ru/support/video-player/player-issues.html#no-codecs",helpLinkButtonText:"NO_CODECS_HELP_LINK_TITLE"};const r=a(e);return t&&function(e){return[hs.NETWORK_PLAYER,hs.NETWORK_MEDIA,hs.NETWORK_TIMEOUT,hs.DRM,hs.ADS].indexOf(e)>-1}(r)?{title:"ADBLOCK_DETECTED_TITLE",message:"ADBLOCK_DETECTED_MESSAGE",helpLink:"https://yandex.ru/support/video-player/blocker-settings.html",helpLinkButtonText:"ERROR_SCREEN_DEFAULT_HELP_LINK"}:function(e){return{title:gs[e],message:ms[e],helpLink:vs[e],helpLinkButtonText:Es[e]||"ERROR_SCREEN_DEFAULT_HELP_LINK"}}(r)}function l(e){if(e&&e.location){const{location:t}=e;return"function"===typeof t.toString?t.toString():t.href||""}return""}function d(e){const t=typeof e;return Boolean(e)&&("object"===t||"function"===t)}function c(e,t,r){return e>r?r:e<t?t:e}function u(e){return"string"===typeof e}function h(e,t){const r=e.style;for(const i in t)if(t.hasOwnProperty(i)){r[ws(i)]=t[i]}}function p(e){if(!e||!e.toString)return!1;const t=e.toString();return/\[native code\]/.test(t)||/\/\* source code not available \*\//.test(t)}function f(e,t){let r=e[t];if(!p(r)){const n=r;try{delete e[t];const i=e[t];"function"===typeof i&&(r=i),e[t]=n}catch(i){}}return r}function v(){}function g(e,t,r,i){const n=function(e){let t=!1,r=!1,i=!1;return!0===e?t=!0:"object"===typeof e&&(t=Boolean(e.capture),r=Boolean(e.passive),i=Boolean(e.once)),{capture:t,passive:r,once:i}}(i),o=Us?n:n.capture,a=n.once&&!xs?function(e){s(),r.call(this,e)}:r,s=()=>{Vs(e,t,a,o)};return Ms(e,t,a,o),s}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function E(e){if("function"===typeof Object.keys)return Object.keys(e);{const t=[];for(const r in e)m(e,r)&&t.push(r);return t}}function A(e){const t=[...e],r=t.pop();if(!r||0===t.length)throw new Error("memoizeSingle need at least 2 functions as arg");return{preparers:t,resolver:r}}function y(e,t,r){for(const i in e)m(e,i)&&t.call(r,e[i],i,e)}function T(e){return u(e.className)?e.className:e.namespaceURI===Gs.svg&&e.getAttribute("class")||""}function S(e,t){u(e.className)?e.className=t:e.namespaceURI===Gs.svg&&e.setAttributeNS("","class",t)}function R(e,t){void 0===t&&(t=""),0!==e.className.length?js(e)?Xs(e,t):function(e,t){let r=T(e).split(" ").concat(t.split(" "));r=function(e){const t={};for(let r=0;r<e.length;r++)t[e[r]]=r;return E(t)}(Bs(r,(function(e){return""!==e}))),S(e,r.join(" "))}(e,t):e.className=t}function _(e,t){void 0===t&&(t=!0);const r=zs(e);if(!r)return t;return!e[r]}function P(e,t){const r=function(e){const t=zs(e);if(t)return t.replace(/hidden/i,"visibilitychange")}(e);return r?g(e,r,()=>{t(_(e))}):v}function I(e,t){let{content:r,size:i}=void 0===t?{}:t;const n=e.ownerDocument.createElement("iframe");n.scrolling="no",n.setAttribute("allowfullscreen",""),n.style.display="block",i&&(n.height=i.height,n.width=i.width),e.appendChild(n);const o=n.contentDocument;return o.open(),r&&o.write(r),o.close(),o.body.style.margin="0",n.style.borderWidth="0",n}function b(e){if(!e)return;const{parentElement:t}=e;t&&t.removeChild(e)}function C(e){return void 0===e&&(e=window),void 0===$s&&($s=function(e){void 0===e&&(e=window);return e.JSON&&p(e.JSON.stringify)&&p(e.JSON.parse)}(e)?e.JSON:{stringify:tl("stringify"),parse:tl("parse")}),$s}function O(e){return C().stringify(e,function(){const e=[],t=function(){const e="undefined"!==typeof WeakMap?new WeakMap:void 0,t=[];return{set:(r,i)=>{if(void 0!==e)try{e.set(r,i)}catch(n){t.push({path:i,value:r})}else t.push({path:i,value:r})},get:r=>{const i=Zs(t,e=>e.value===r);return void 0!==e&&void 0===i?e.get(r):i?i.path:void 0}}}();return(r,i)=>{if(n(i))return u(i.name)?i.name:"[Function]";if(!d(i))return i;const o=t.get(i);if(o)return"[Circular "+o+"]";for(;e.length>0&&e[e.length-1].value[r]!==i;)e.pop();const a=(e.length>0?e[e.length-1].path:"")+(r?"/"+r:"~");return e.push({path:a,value:i}),t.set(i,a),i}}())}function w(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];cl(e)&&e.forEach(e=>{"function"===typeof e&&e(...r)})}function k(){return(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function D(e,t){!function(e){return"function"===typeof e.dispatch}(e)?e(t):e.dispatch(t)}function N(e,t){e.forEach(e=>{D(e,t)})}function L(e){return 0===Cl.length&&(bl=window.setInterval(()=>{Cl.forEach(e=>e())},250)),Cl.push(e),()=>{const t=Cl.indexOf(e);t>-1&&Cl.splice(t,1),0===Cl.length&&clearInterval(bl)}}function M(e){return e}function V(e){return Math.max(e,0)}function x(e){return V(Ol(e))}function F(e){return V(function(e){return Math.floor(e)}(e))}function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function B(e,t){const r=function(e){void 0===e&&(e=window);const{document:t={}}=e;return Gl.filter(e=>{let{enabled:r}=e;return r in t})}(e);if(r.length>0)return r[0];const i=function(e,t){return void 0===e&&(e=window),void 0===t&&(t=e.HTMLVideoElement&&e.HTMLVideoElement.prototype||{}),Gl.filter(e=>{let{enabled:r}=e;return r in t})}(e,t);return i.length>0?i[0]:void 0}function H(e,t){const r=B(e,t);if(!r)return null;let i=e.document[r.element];return t&&t[r.element]&&(i=t),i||null}function G(e){let t=function(){let r;return t=()=>r,r=e.apply(this,arguments),r};return function(){return t.apply(this,arguments)}}function W(e){return"number"===typeof e&&isFinite(e)}function Y(e){void 0===e&&(e=El);const t=e();return()=>Math.max(0,e()-t)}function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function K(e){Kl.href=e;let t=Kl.pathname||"";"/"!==t.charAt(0)&&(t="/"+t);const r=(Kl.search||"")+(Kl.hash||""),i=e.lastIndexOf(r),n=-1===i?e:e.slice(0,i);if(ql.test(e)){const t=K(e.replace(ql,"https:"));return Kl.href=e,j({},t,{originalPath:n,protocol:e.slice(0,e.indexOf(":")+1),href:Kl.href})}const o=Kl.protocol&&/^[a-z\-]+:/i.test(Kl.protocol)?Kl.protocol:"";return{originalPath:n,href:Kl.href,protocol:o,host:Kl.host,hostname:Kl.hostname,port:Kl.port,pathname:t,search:Kl.search,hash:Kl.hash}}function q(e,t){if(void 0===t&&(t=!1),t){const t=e.originalPath,r="/"===e.pathname&&"/"!==t[t.length-1];return e.originalPath+(r?"/":"")+e.search+e.hash}const r="443"===e.port||"80"===e.port?e.hostname:e.host;return e.protocol+"//"+r+e.pathname+e.search+e.hash}function X(e){const t={},r=e.replace(/^[?#]+/,"").replace(/#.*$/,"").split("&");for(let i=0;i<r.length;i++){const e=r[i].indexOf("=");let n,o;if(-1===e?(n=Xl(r[i]),o=""):(n=Xl(r[i].slice(0,e)),o=r[i].slice(e+1)),n){const e=Boolean(/(\[\])$/.exec(n));n=n.replace(/\[\]$/,""),e?void 0===t[n]?t[n]=[Xl(o)]:t[n]=[].concat(t[n],Xl(o)):t[n]=Xl(o)}}return t}function z(e){const t=[];for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];cl(i)?t.push(zl(r,i)):void 0!==i&&t.push(r+"="+encodeURIComponent(i))}return"?"+t.join("&")}function Q(e,t,r){if(void 0===r)return e;const i=K(e),n=X(i.search);return n[t]=r,q(j({},i,{search:z(n)}))}function J(e,t,r){let{override:i=!0,saveOriginalPath:n=!1}=void 0===r?{}:r;const o=K(e),a=X(o.search);y(t,(e,t)=>{(void 0===a[t]||i)&&(a[t]=e)});return q(j({},o,{search:z(a)}),n)}function Z(e){return K(e).pathname.split("/").pop()||""}function $(e){const t=Z(e).split(".");return t.length>1?t.pop():""}function ee(e){return function(e){return Boolean(e.PointerEvent)}(e)&&function(e){const t=e.navigator||{},{msMaxTouchPoints:r,maxTouchPoints:i}=t;return r||i||0}(e)>0&&!function(e){void 0===e&&(e=window);return Ds(e)>11}(e)}function te(e,t){if(!n(e.matchMedia))return!1;const r=e.matchMedia(t);return d(r)&&Boolean(r.matches)}function re(e){return void 0===e&&(e=window),ee(e)||function(e){return te(e,td)}(e)||function(e){return te(e,rd)}(e)||function(e){const{DocumentTouch:t}=e;return Boolean(t)&&e.document instanceof t}(e)||function(e){return"ontouchstart"in e}(e)}function ie(e){void 0===e&&(e=window);const t=e.navigator.userAgent.toLowerCase();return/ipad|iphone|ipod/.test(t)&&!e.MSStream&&!function(e){void 0===e&&(e=window);return e.navigator.userAgent.indexOf("UCBrowser")>-1}(e)}function ne(){}function oe(e){if(!e)return[];const t=[];for(let r=0;r<e.length;r++)t.push(e[r]);return t}function ae(e){return oe(e).map(e=>{let{screenX:t,screenY:r}=e;return{screenX:t,screenY:r}})}function se(e,t,r){function i(e){let{touches:t}=e;return d(t)&&t.length===h}function n(){return f>0}function o(){n()&&(window.clearTimeout(f),f=0,s=[])}function a(e){o(),p=!1}let s,{threshold:l=sd,delay:c=ld,handleContextmenu:u=!1,touchesCount:h=1}=void 0===r?{}:r,p=!1,f=0;const m=g(e,"touchstart",(function(e){i(e)&&(s=ae(e.touches),o(),f=window.setTimeout(()=>{n()&&t()},c),p=!0)}),{passive:!0}),E=g(e,"touchend",a,{passive:!0}),A=g(e,"touchcancel",a,{passive:!0}),y=g(e,"touchmove",(function(e){n()&&(i(e)?function(e){if(e.length!==s.length)return!0;for(let t=0;t<e.length;t++){if(Math.abs(s[t].screenX-e[t].screenX)>l)return!0;if(Math.abs(s[t].screenY-e[t].screenY)>l)return!0}return!1}(ae(e.touches))&&o():o())}),{passive:!0}),T=u?g(e,"contextmenu",(function(e){!n()&&p||(o(),t(e))}),{passive:!1}):v;return()=>{o(),m(),E(),A(),y(),T()}}function le(e){void 0===e&&(e=window);const{userAgent:t=""}=e.navigator,r=/Android/.test(t),i=function(e){void 0===e&&(e=window);return/Windows Phone/i.test(e.navigator.userAgent)}(e),n=/com\.yandex\.mobile\.metrica\.ads\.sdk.*?Android/.test(t);return r&&!i||n}function de(){return(de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ce(e){let{event:t}=e;const r=t.touches[0]||t.changedTouches[0];return{clientX:r?r.clientX:-1,clientY:r?r.clientY:-1}}function ue(e,t){return e.map(e=>({adViewer:e,additionalData:{},adType:t}))}function he(e){try{return JSON.stringify(e,function(){const e=[],t=function(){const e="undefined"!==typeof WeakMap?new WeakMap:void 0,t=[];return{set:(r,i)=>{if(void 0!==e)try{e.set(r,i)}catch(n){t.push({path:i,value:r})}else t.push({path:i,value:r})},get:r=>{const i=Zs(t,e=>e.value===r);return void 0!==e&&void 0===i?e.get(r):i?i.path:void 0}}}();return(r,i)=>{if(n(i))return u(i.name)?i.name:"[Function]";if(!d(i))return i;if(o=i,"[object Window]"===Object.prototype.toString.call(o))return"[object Window]";var o;if(function(e){return u(e.tagName)}(i))return"[DOMNode "+i.tagName+"]";const a=t.get(i);if(a)return"[Circular "+a+"]";for(;e.length>0&&e[e.length-1].value[r]!==i;)e.pop();const s=(e.length>0?e[e.length-1].path:"")+(r?"/"+r:"~");return e.push({path:s,value:i}),t.set(i,s),i}}())}catch({message:t,stack:r}){return JSON.stringify({__stringifyError:{message:t,stack:r}})}}function pe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=t.map(fe),n="YA PLAYER: "+(new Date).toString()+" "+i.join(" ");return n}function fe(e){return e&&"object"===typeof e?JSON.stringify(e,Object.getOwnPropertyNames(e)):e}function ve(e){const t=e;return t.Ya||(t.Ya={}),t.Ya.streamPlayer||(t.Ya.streamPlayer={}),t.Ya.streamPlayer}function ge(e){return Ae(e),Vd.flags[e]}function me(e){return"true"===e||"1"===e||"false"!==e&&"0"!==e&&void 0}function Ee(e){const t=me(ge(e));if("undefined"===typeof t){return me(xd[e])}return t}function Ae(e){if(Vd.flagsInited)return;const t=new Error(e?"Unexpected usage of player's flag "+e+" before any flag configuration":"Unexpected usage of player's getFlagsJson before any flag configuration");setTimeout(()=>{throw t})}function ye(){return(ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Te(e){return!!Gd[e]}function Se(e,t,r){function i(){var e=t.apply(void 0,arguments);return r?{type:a,payload:e,error:e instanceof Error,meta:r.apply(void 0,arguments)}:{type:a,payload:e,error:e instanceof Error}}function n(){return l(s,!1).apply(void 0,arguments)}"function"===typeof e&&(r=t,t=e,e=void 0),"function"!==typeof t&&(t=jd),"function"!==typeof r&&(r=void 0);var o="string"===typeof e&&/^[0-9A-Z_]+$/.test(e);o?(!function(e){if(Wd.checkExisting&&Te(e))throw new TypeError("Duplicate action type: ".concat(e))}(e),Gd[e]=!0):++Yd;var a=o?e:"[".concat(Yd,"]").concat(e?" "+e:""),s=void 0,l=function(e,t){return function(){var r=i.apply(void 0,arguments);return r.error||(r.error=t),Array.isArray(e)?e.map((function(e){return e(r)})):e?e(r):r}};return n.asError=function(){return l(s,!0).apply(void 0,arguments)},n.getType=function(){return a},n.toString=function(){return a},n.raw=i,n.assignTo=function(e){return s=qd(e),n},n.assigned=function(){return!!s},n.bound=function(){return!1},n.dispatched=n.assigned,n.bindTo=function(e){var t=l(qd(e));return t.asError=l(qd(e)),t.raw=i,t.getType=n.getType,t.toString=n.toString,t.assignTo=function(){return t},t.bindTo=function(){return t},t.assigned=function(){return!1},t.bound=function(){return!0},t.dispatched=t.bound,t},n}function Re(){return(Re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function _e(e){return e&&e.getType?e.toString():e}function Pe(){function e(e){return!!o[_e(e)]}function t(e,r){return Array.isArray(e)?e.forEach((function(e){t(e,r)})):o[_e(e)]=r,l}function r(e){return Array.isArray(e)?e.forEach(r):delete o[_e(e)],l}function i(e){return Object.keys(e).forEach((function(t){return s[t]=e[t]})),l}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;if(!t||"string"!==typeof t.type)return e;if(t.type.startsWith("@@redux/"))return e;var r=o[t.type]||s.fallback;return r?s.payload?r(e,t.payload,t.meta):r(e,t):e}var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,s={payload:!0,fallback:null},l=Re(n,{has:e,on:t,off:r,options:i});if("function"===typeof o){var d=o;o={},d(t,r)}return e(Xd)||t(Xd,(function(e,t){return s.payload?t.reduce(n,e):t.payload.reduce(n,e)})),l}function Ie(e){return e&&e.type===zd?(e.payload.type=zd,e.payload):e}function be(e,t){const r=e.height||0;return(t.height||0)-r}function Ce(e){return Boolean(e&&e.adType===wd.inroll)}function Oe(e,t){const{ad:{originalBroadcastAdCues:r}}=e,i=r[t];if(i){const{start:e}=i;if(void 0===e)return;const{end:t=e+yu}=i;return{start:Ll(e),end:Ll(t)}}}function we(e){const{ad:{originalBroadcastAdCues:t,adInfo:r}}=e;return Ce(r)?r.params.cueId:E(t).find(t=>function(e,t){const{controller:{currentTime:r,programDateTime:i}}=e;if(void 0===i)return!1;const n=i/1e3+r,o=Oe(e,t);if(!o)return!1;const{start:a,end:s}=o;return a<=n&&n<=s}(e,t))}function ke(e){const{controller:{currentTime:t,programDateTime:r}}=e;return void 0===r?r:xl(r,Ul(t,1e3))}function De(e,t){return Nl(Math.max(e+Cu,t+bu))}function Ne(e){let{cue_id:t,pts:r,offset:i,cutoff:n}=e;const o=xl(r,i);return{start:o,isEndReceived:void 0!==n,cueId:t,end:void 0!==n?xl(r,n):De(r,o),isValid:!0,invalidateReason:void 0}}function Le(e,t){const r=[],i=[];return((e,t,r)=>{for(let i=0;i<e.length;i++)t.call(r,e[i],i,e)})(e,(n,o)=>{t(n,o,e)?r.push(n):i.push(n)}),[r,i]}function Me(){return(Me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ve(e){return e.reduce((e,t)=>xl(e,Ll(t.getAdDuration())),Ll(0))}function xe(){return(xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Fe(e){void 0===e&&(e=window);try{return e.ya.videoAd.getBundleVersion()}catch(t){return"none"}}function Ue(e){void 0===e&&(e=window);try{return e.ya.videoAd.getModuleVersion()}catch(t){return"none"}}function Be(e,t){void 0===e&&(e="a"),void 0===t&&(t="z");const r=function(e,t){let r=e+yl()*(t+1-e);return r=Math.floor(r),r}(e.charCodeAt(0),t.charCodeAt(0));return String.fromCharCode(r)}function He(){return(He=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ge(e){const{dropCacheOnRetry:t=!1,onBeforeLoad:r=v,retries:n=0}=e;if(e.checkLoad&&e.checkLoad())return void(e.onLoad&&e.onLoad());let o=r,a=0;return t&&n>0&&(o=e=>{if(r(e),a>0){const t=-1===e.src.indexOf("?")?"?":"&",r=function(e){const t=[];for(let r=0;r<e;r++)t.push(Be());return t.join("")}(4);e.src+=t+r}a++}),function e(t){const{src:r,win:n=window,charset:o=Vu,async:a=!0,retries:s=0,onRetry:l=v,retryDelay:d=0,checkLoad:c=xu,onBeforeLoad:u=v,onLoad:h=v,onError:p=v}=t,f=n.document.createElement("script"),g=i=>{s>0?(l(i),e(He({},t,{src:r,retries:s-1}))):p(i),b(f)};f.type="text/javascript",f.async=a,f.onload=()=>c(f)?h():g(new Error("checkLoad for "+r+" failed")),f.onerror=e=>{try{n.setTimeout(()=>{g(e)},d)}catch(e){}},f.src=r,f.charset=o,u(f),i(n).appendChild(f)}(He({},e,{onBeforeLoad:o}))}function We(){return(We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ye(){return(Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}async function je(e,t,r,i){var n;void 0===e&&(e=window);const o=(a={serviceName:"player",serviceVersion:"1.0-1025",vasLoaderUrl:"https://yandex.ru/ads/system/adsdk.js",config:Ye({},t,{additionalCustomRootFields:{vsid:r,contentPlayerVersion:"1.0-1025",testIds:null==(n=t.additionalParams)?void 0:n.slots}}),win:e,moduleName:"Multiroll",yaDirectPixel:i?{url:i.url,data:i.data}:void 0},{promise:new Promise((e,t)=>{Ge({src:a.vasLoaderUrl,onError:t,onLoad:()=>{a.yaDirectPixel&&Ud(a.yaDirectPixel.url,We({},a.yaDirectPixel.data,{eventType:"dsp_request",inventory:"instream",eventUnixTime:Date.now()})),a.win.ya.videoAd.loadModule(a.moduleName).then(t=>e(t)).catch(t)}})})}).promise;var a;return o.catch(ne),o}function Ke(){return(Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function qe(){return(qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Xe(e){return new Promise((t,r)=>{!function e(t){const{method:r,url:i,async:n=!0,data:o,responseType:a="text",onBeforeSend:s=v,onRetry:l=v,checkStatus:d=(e=>Fu===e),headers:c={},xhrConstructor:u=XMLHttpRequest,retries:h=0,timeout:p=0,withCredentials:f,onAbort:g,onSetup:m}=t;if(!u)return;const E=t.onSuccess?G(t.onSuccess):v,A=t.onError?G(t.onError):v;let T,S=!1,R=0,_=e=>{S=!0,_=v,T=e,P(new Error("Abort request")),"function"===typeof g&&g(e)};const P=r=>{I.onerror=null,I.onreadystatechange=null,R&&clearTimeout(R);if(R&&4!==I.readyState||S)try{I.abort()}catch(r){}if(!S)if(h>0){const i=l(r,I);if("boolean"!==typeof i||Boolean(i)||_(),S)return;e(Ke({},t,{onSetup:e=>{let{abort:t}=e;_=e=>t(e),S&&t(T)},retries:h-1}))}else _=v,A(r,I)},I=new u;try{I.open(r,i,n)}catch(b){return void P(b)}if(I.responseType=a,I.withCredentials=Boolean(f),y(c,(e,t)=>{try{I.setRequestHeader(t,e)}catch(b){}}),p>0&&isFinite(p)&&(R=window.setTimeout(()=>{P(new Error("Request timeout, "+i))},p)),I.onerror=P,I.onreadystatechange=()=>{if(4===I.readyState){const{status:e}=I;d(e)?(_=v,clearTimeout(R),E(I)):P(new Error("Invalid request status "+e+", "+i))}},("function"!==typeof m||(m({abort:e=>_(e)}),!S))&&(s(I,t),!S))try{I.send(o)}catch(b){P(b)}}(qe({},e,{onSuccess:t,onError:r}))})}function ze(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Qe(e,t,r){function i(){p===h&&(p=h.slice())}function n(){if(f)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function o(e){if("function"!==typeof e)throw new Error("Expected the listener to be a function.");if(f)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return i(),p.push(e),function(){if(t){if(f)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,i();var r=p.indexOf(e);p.splice(r,1),h=null}}}function a(e){if(!ze(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(f)throw new Error("Reducers may not dispatch actions.");try{f=!0,u=c(u,e)}finally{f=!1}for(var t=h=p,r=0;r<t.length;r++){(0,t[r])()}return e}function s(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");c=e,a({type:Hu.REPLACE})}function l(){var e,t=o;return(e={subscribe:function(e){function r(){e.next&&e.next(n())}if("object"!==typeof e||null===e)throw new TypeError("Expected the observer to be an object.");return r(),{unsubscribe:t(r)}}})[Uu.Z]=function(){return this},e}var d;if("function"===typeof t&&"function"===typeof r||"function"===typeof r&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"===typeof t&&"undefined"===typeof r&&(r=t,t=void 0),"undefined"!==typeof r){if("function"!==typeof r)throw new Error("Expected the enhancer to be a function.");return r(Qe)(e,t)}if("function"!==typeof e)throw new Error("Expected the reducer to be a function.");var c=e,u=t,h=[],p=h,f=!1;return a({type:Hu.INIT}),(d={dispatch:a,subscribe:o,getState:n,replaceReducer:s})[Uu.Z]=l,d}function Je(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function Ze(e){for(var t=Object.keys(e),r={},i=0;i<t.length;i++){var n=t[i];0,"function"===typeof e[n]&&(r[n]=e[n])}var o,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if("undefined"===typeof r(void 0,{type:Hu.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if("undefined"===typeof r(void 0,{type:Hu.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+Hu.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(s){o=s}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var i=!1,n={},s=0;s<a.length;s++){var l=a[s],d=r[l],c=e[l],u=d(c,t);if("undefined"===typeof u){var h=Je(l,t);throw new Error(h)}n[l]=u,i=i||u!==c}return(i=i||a.length!==Object.keys(e).length)?n:e}}function $e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function et(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?et(r,!0).forEach((function(t){$e(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):et(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function rt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function it(){return(it=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function nt(e,t){var r=e.indexOf(t);r>=0&&e.splice(r,1)}function ot(e,t,r){void 0===t&&(t=gh),void 0===r&&(r="iterator");var i={meta:{name:r},next:e,throw:t,return:mh,isSagaIterator:!0};return"undefined"!==typeof Symbol&&(i[Symbol.iterator]=function(){return i}),i}function at(e,t){var r=t.sagaStack;console.error(e),console.error(r)}function st(e,t){var r=Object.keys(e),i=r.length;var n,o=0,a=nh(e)?Eh(i):{},s={};return r.forEach((function(e){var r=function(r,s){n||(s||Sh(r)?(t.cancel(),t(r,s)):(a[e]=r,++o===i&&(n=!0,t(a))))};r.cancel=ph,s[e]=r})),t.cancel=function(){n||(n=!0,r.forEach((function(e){return s[e].cancel()})))},s}function lt(e){return{name:e.name||"anonymous",location:dt(e)}}function dt(e){return e[$u]}function ct(e,t){void 0===e&&(e=10);var r=new Array(e),i=0,n=0,o=0,a=function(t){r[n]=t,n=(n+1)%e,i++},s=function(){if(0!=i){var t=r[o];return r[o]=null,i--,o=(o+1)%e,t}},l=function(){for(var e=[];i;)e.push(s());return e};return{isEmpty:function(){return 0==i},put:function(s){var d;if(i<e)a(s);else switch(t){case 1:throw new Error("Channel's Buffer overflow!");case 3:r[n]=s,o=n=(n+1)%e;break;case 4:d=2*e,r=l(),i=r.length,n=r.length,o=0,r.length=d,e=d,a(s)}},take:s,flush:l}}function ut(e,t){return void 0===e&&(e="*"),sh(e)?_h("TAKE",{pattern:e}):lh(r=e)&&r[qu]&&th(t)&&sh(t)?_h("TAKE",{channel:e,pattern:t}):lh(e)?_h("TAKE",{channel:e}):void 0;var r}function ht(e,t){return eh(t)&&(t=e,e=void 0),_h("PUT",{channel:e,action:t})}function pt(e){var t=_h("ALL",e);return t.combinator=!0,t}function ft(e,t){var r,i=null;return rh(e)?r=e:(nh(e)?(i=e[0],r=e[1]):(i=e.context,r=e.fn),i&&ih(r)&&rh(i[r])&&(r=i[r])),{context:i,fn:r,args:t}}function vt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return _h("CALL",ft(e,r))}function gt(e,t,r){void 0===r&&(r=[]);return _h("CALL",ft([e,t],r))}function mt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return _h("FORK",ft(e,r))}function Et(e){return void 0===e&&(e=zu),_h("CANCEL",e)}function At(e){void 0===e&&(e=fh);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return _h("SELECT",{selector:e,args:r})}function yt(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}function Tt(e){try{_t(),e()}finally{Pt()}}function St(e){Ch.push(e),Oh||(_t(),It())}function Rt(e){try{return _t(),e()}finally{It()}}function _t(){Oh++}function Pt(){Oh--}function It(){var e;for(Pt();!Oh&&void 0!==(e=Ch.shift());)Tt(e)}function bt(e){var t="*"===e?Lh:ih(e)?Dh:nh(e)?wh:dh(e)?Dh:rh(e)?kh:ch(e)?Nh:null;if(null===t)throw new Error("invalid pattern: "+e);return t(e)}function Ct(e){void 0===e&&(e=Rh());var t=!1,r=[];return{take:function(i){t&&e.isEmpty()?i(Mh):e.isEmpty()?(r.push(i),i.cancel=function(){nt(r,i)}):i(e.take())},put:function(i){if(!t){if(0===r.length)return e.put(i);r.shift()(i)}},flush:function(r){t&&e.isEmpty()?r(Mh):r(e.flush())},close:function(){if(!t){t=!0;var e=r;r=[];for(var i=0,n=e.length;i<n;i++){(0,e[i])(Mh)}}}}}function Ot(){var e,t,r,i,n,o,a=(t=!1,i=r=[],n=function(){i===r&&(i=r.slice())},o=function(){t=!0;var e=r=i;i=[],e.forEach((function(e){e(Mh)}))},(e={})[qu]=!0,e.put=function(e){if(!t)if(Vh(e))o();else for(var n=r=i,a=0,s=n.length;a<s;a++){var l=n[a];l[Ku](e)&&(l.cancel(),l(e))}},e.take=function(e,r){var o,a;void 0===r&&(r=Lh),t?e(Mh):(e[Ku]=r,n(),i.push(e),e.cancel=(o=function(){n(),nt(i,e)},a=!1,function(){a||(a=!0,o())}))},e.close=o,e),s=a.put;return a.put=function(e){e[Xu]?s(e):St((function(){s(e)}))},a}function wt(e,t){var r=e[Wu];rh(r)&&(t.cancel=r),e.then(t,(function(e){t(e,!0)}))}function kt(e){e.isRunning()&&e.cancel()}function Dt(e,t){return e+"?"+t}function Nt(e){var t=e.name,r=e.location;return r?t+"  "+Dt(r.fileName,r.lineNumber):t}function Lt(e){var t,r,i,n=(t=function(e){return e.cancelledTasks},r=e,(i=[]).concat.apply(i,r.map(t)));return n.length?["Tasks cancelled due to error:"].concat(n).join("\n"):""}function Mt(e,t,r,i,n,o,a){function s(t,r){if(r){if(u=2,Gh({meta:n,cancelledTasks:p}),g.isRoot){var i=Yh();Wh(),e.onError(t,{sagaStack:i})}c=t,h&&h.reject(t)}else t===Ju?u=1:1!==u&&(u=3),d=t,h&&h.resolve(t);g.cont(t,r),g.joiners.forEach((function(e){e.cb(t,r)})),g.joiners=null}var l;void 0===a&&(a=ph);var d,c,u=0,h=null,p=[],f=Object.create(r),v=function(e,t,r){function i(e){t(),o(),r(e,!0)}function n(t){s.push(t),t.cont=function(n,o){l||(nt(s,t),t.cont=ph,o?i(n):(t===e&&(a=n),s.length||(l=!0,r(a))))}}function o(){l||(l=!0,s.forEach((function(e){e.cont=ph,e.cancel()})),s=[])}var a,s=[],l=!1;return n(e),{addTask:n,cancelAll:o,abort:i,getTasks:function(){return s}}}(t,(function(){p.push.apply(p,v.getTasks().map((function(e){return e.meta.name})))}),s),g=((l={})[Qu]=!0,l.id=i,l.meta=n,l.isRoot=o,l.context=f,l.joiners=[],l.queue=v,l.cancel=function(){0===u&&(u=1,v.cancelAll(),s(Ju,!1))},l.cont=a,l.end=s,l.setContext=function(e){vh(f,e)},l.toPromise=function(){return h||(h=Ih(),2===u?h.reject(c):0!==u&&h.resolve(d)),h.promise},l.isRunning=function(){return 0===u},l.isCancelled=function(){return 1===u||0===u&&1===t.status},l.isAborted=function(){return 2===u},l.result=function(){return d},l.error=function(){return c},l);return g}function Vt(e,t,r,i,n,o,a){function s(e,r){try{var n;r?(n=t.throw(e),Wh()):Th(e)?(c.status=1,s.cancel(),n=rh(t.return)?t.return(Ju):{done:!0,value:Ju}):n=yh(e)?rh(t.return)?t.return():{done:!0}:t.next(e),n.done?(1!==c.status&&(c.status=3),c.cont(n.value)):l(n.value,i,s)}catch(o){if(1===c.status)throw o;c.status=2,c.cont(o,!0)}}function l(t,r,i,n){function o(r,n){a||(a=!0,i.cancel=ph,e.sagaMonitor&&(n?e.sagaMonitor.effectRejected(s,r):e.sagaMonitor.effectResolved(s,r)),n&&function(e){Bh=e}(t),i(r,n))}void 0===n&&(n="");var a,s=Fh();e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:s,parentEffectId:r,label:n,effect:t}),o.cancel=ph,i.cancel=function(){a||(a=!0,o.cancel(),o.cancel=ph,e.sagaMonitor&&e.sagaMonitor.effectCancelled(s))},d(t,s,o)}var d=e.finalizeRunEffect((function(t,r,i){if(oh(t))wt(t,i);else if(ah(t))Vt(e,t,u.context,r,n,!1,i);else if(t&&t[ju]){(0,Uh[t.type])(e,t.payload,i,h)}else i(t)}));s.cancel=ph;var c={meta:n,cancel:function(){0===c.status&&(c.status=1,s(Ju))},status:0},u=Mt(e,c,r,i,n,o,a),h={task:u,digestEffect:l};return a&&(a.cancel=u.cancel),s(),u}function xt(e,t){var r=e.channel,i=void 0===r?Ot():r,n=e.dispatch,o=e.getState,a=e.context,s=void 0===a?{}:a,l=e.sagaMonitor,d=e.effectMiddlewares,c=e.onError,u=void 0===c?at:c;for(var h=arguments.length,p=new Array(h>2?h-2:0),f=2;f<h;f++)p[f-2]=arguments[f];var v=t.apply(void 0,p);var g,m=Fh();if(l&&(l.rootSagaStarted=l.rootSagaStarted||ph,l.effectTriggered=l.effectTriggered||ph,l.effectResolved=l.effectResolved||ph,l.effectRejected=l.effectRejected||ph,l.effectCancelled=l.effectCancelled||ph,l.actionDispatched=l.actionDispatched||ph,l.rootSagaStarted({effectId:m,saga:t,args:p})),d){var E=rt.apply(void 0,d);g=function(e){return function(t,r,i){return E((function(t){return e(t,r,i)}))(t)}}}else g=fh;var A={channel:i,dispatch:Ah(n),getState:o,sagaMonitor:l,onError:u,finalizeRunEffect:g};return Rt((function(){var e=Vt(A,v,s,m,lt(t),!0,void 0);return l&&l.effectResolved(m,e),e}))}function Ft(e){return lh(e)?"channel":dh(e)?String(e):rh(e)?e.name:String(e)}function Ut(e,t,r){function i(t,r){if(s===qh)return Kh(t);if(r&&!o)throw s=qh,r;n&&n(t);var i=r?e[o](r):e[s]();return s=i.nextState,a=i.effect,n=i.stateUpdater,o=i.errorState,s===qh?Kh(t):a}var n,o,a,s=t;return ot(i,(function(e){return i(null,e)}),r)}function Bt(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];var o,a={done:!1,value:ut(e)},s=function(e){return{done:!1,value:mt.apply(void 0,[t].concat(i,[e]))}},l=function(e){return o=e};return Ut({q1:function(){return{nextState:"q2",effect:a,stateUpdater:l}},q2:function(){return{nextState:"q1",effect:s(o)}}},"q1","takeEvery("+Ft(e)+", "+t.name+")")}function Ht(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];var o,a,s={done:!1,value:ut(e)},l=function(e){return{done:!1,value:mt.apply(void 0,[t].concat(i,[e]))}},d=function(e){return{done:!1,value:Et(e)}},c=function(e){return o=e},u=function(e){return a=e};return Ut({q1:function(){return{nextState:"q2",effect:s,stateUpdater:u}},q2:function(){return o?{nextState:"q3",effect:d(o)}:{nextState:"q1",effect:l(a),stateUpdater:c}},q3:function(){return{nextState:"q1",effect:l(a),stateUpdater:c}}},"q1","takeLatest("+Ft(e)+", "+t.name+")")}function Gt(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];var o,a={done:!1,value:ut(e)},s=function(e){return{done:!1,value:vt.apply(void 0,[t].concat(i,[e]))}},l=function(e){return o=e};return Ut({q1:function(){return{nextState:"q2",effect:a,stateUpdater:l}},q2:function(){return{nextState:"q1",effect:s(o)}}},"q1","takeLeading("+Ft(e)+", "+t.name+")")}function Wt(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];return mt.apply(void 0,[Bt,e,t].concat(i))}function Yt(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];return mt.apply(void 0,[Ht,e,t].concat(i))}function jt(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];return mt.apply(void 0,[Gt,e,t].concat(i))}function Kt(e,t){return e.volume===t.volume&&e.muted===t.muted}function qt(e,t){return{reason:e,details:t,getElapsedTime:Y()}}function*Xt(e){const{ad:{adInfo:t}}=yield At();t||(yield vt([e,e.updateVideoControllerNativeControlsVisibility]))}function*zt(e){const t=function(e){const{ad:{nextAdInfo:t},controller:{videoType:r}}=e;if(void 0!==t&&("postroll"!==t.adBreakType||r===rp.VOD))return Ll(t.remainingTime)}(yield At());yield vt(e.callbacks.onNextAdRemainingTimeChange,t)}function*Qt(e){let{payload:{cueId:t,start:r,end:i}}=e;const{ad:{originalBroadcastAdCues:n}}=yield At(),o=op(n),a=o[t]||{start:r,end:i};void 0!==r&&(a.start=r),void 0!==i&&(a.end=i),o[t]=a,yield ht(nc(o))}function Jt(e){return cp.indexOf(K(e).hostname)>-1}function Zt(e){const t=function(e){return Jt(e)&&K(e).pathname.slice(1).split("/")[1]||""}(e);return{channel:t,metaInfoUrl:"https://strm.yandex.net/kal/"+t+"/break/last?start_ts={{video-timestamp}}"}}function*$t(e,t,r){yield Ph(lp);const i=yield At(),{ad:{adInfo:n},controller:{stream:o}}=i,a=function(e){const{controller:{stream:t}}=e;if(t)return void 0!==t.metaInfoUrl?t.metaInfoUrl:Jt(t.url)?Zt(t.url).metaInfoUrl:void 0}(i);if(!n||!Ce(n)||n.params.startTimestamp!==e.params.startTimestamp||!o||!a)return;const{startProgramDateTime:s,startVideoTime:l,startTimestamp:c}=n.params,h=xl(s,l),p=xl(h,up),f=Nl(Math.round(1e3*(h+(Date.now()/1e3-c)))),v=function(e,t,r){return e.replace(new RegExp("{{"+t+"}}","gm"),encodeURIComponent(r))}(a,"video-timestamp",String(f));let g;try{g=yield t({method:"GET",url:v})}catch(T){return r.callbacks.onError(new Cd({code:ps.META_INFO_REQUEST_FAILED,details:{url:v},fatal:!1})),void(yield ht(oc({end:p,cueId:n.params.cueId})))}const m=function(e){try{return u(e)?JSON.parse(e):void 0}catch(t){return}}(g.responseText);if(!d(m))return;const{cutoff:E,cue_id:A}=m;if(A!==n.params.cueId)return;const y=W(E)?Bl(xl(f,E),1e3):p;yield ht(oc({end:y,cueId:A})),yield $t(e,t,r)}function*er(e,t){let{payload:r}=t;const{ad:{adInfo:i}}=yield At();yield ht(tc(r)),i&&r&&i.adType!==r.adType?(yield vt(e.callbacks.onAdStateChange,{state:ap.NOT_PLAYING,type:i.adType,adParams:{}}),yield vt(e.callbacks.onAdStateChange,{state:ap.PLAYING,type:r.adType,adParams:{}})):i&&!r?yield vt(e.callbacks.onAdStateChange,{state:ap.NOT_PLAYING,type:i.adType,adParams:{}}):!i&&r&&(yield vt(e.callbacks.onAdStateChange,{state:ap.PLAYING,type:r.adType,adParams:{}})),void 0!==r&&Ce(r)&&(yield $t(r,Xe,e))}function*tr(e){const t=yield At(),{ad:{adInfo:r,originalBroadcastAdCueId:i},controller:{watchedTime:n}}=t,o=we(t);if(o&&Ce(r)){const i=Oe(t,o);if(i){const{startProgramDateTime:t,startVideoTime:n,startTimestamp:o}=r.params,a=i.end+Du,s=Fl(Bl(Date.now(),1e3),o),l=xl(t,n);if(a<xl(s,l)){const t={utc:xl(l,s),videoTime:W(n)?xl(n,s):void 0};return void e.stopAd({stopAdReason:Dd.CutOff,data:{loadPositionAfterAd:t}})}}}if(o===i)return;yield ht(rc(o));let a;void 0!==o?hp=n:a=Fl(n,hp),yield vt(e.callbacks.onOriginalBroadcastAdStateChange,{cueId:o,originalBroadcastAdDuration:a})}function*rr(e){const t=yield At(),{controller:{currentTimeLowGranularity:r,duration:i,videoType:n,watchedTime:o}}=t;if(isNaN(i))return;const a=e.getMultiroll(),s={watchedTime:o,sourceWatchedTime:o,currentTime:r,duration:i,videoType:n||rp.VOD},l=yield a.midroll.loadViewers(s),d=a.getNextAdInfo(s);yield ht(pc(d)),l.length<=0||(yield e.playAdViewers(wd.midroll,ue(l,wd.midroll),{}))}async function ir(e){await Xe({method:"GET",url:e,withCredentials:!1,timeout:pp})}function nr(){return(nr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function or(e){const t=vp[e];if(t)return t;fp.href=e;let r=fp.pathname||"";"/"!==r.charAt(0)&&(r="/"+r);const i={href:fp.href,protocol:fp.protocol,host:fp.host,hostname:fp.hostname,port:fp.port,pathname:r,search:fp.search,hash:fp.hash,baseDomain:(fp.hostname||"").split(".").slice(-2).join(".")};return vp[e]=i,nr({},i)}function ar(e,t,r){if(void 0===t)return e;if(void 0===r)return e;const i=encodeURIComponent(t)+"="+encodeURIComponent(r);return fp.href=e,fp.search=fp.search?fp.search+"&"+i:"?"+i,fp.href}function sr(e,t,r){if(void 0===t)return e;if(void 0===r)return e;const i=encodeURIComponent(t)+"="+encodeURIComponent(r);return fp.href=e,fp.hash=fp.hash?fp.hash+"&"+i:"#"+i,fp.href}function lr(e,t,r){return e=function(e,t){if(-1===e.indexOf("#"))return e;fp.href=e;const r=cr(fp.hash.slice(1),t);return fp.hash=r?"#"+r:"",fp.href}(e,t),void 0===r?e:sr(e,t,r)}function dr(e,t){if(-1===e.indexOf("?"))return e;fp.href=e;const r=cr(fp.search.slice(1),t);return fp.search=r?"?"+r:"",fp.href}function cr(e,t){return e.split("&").filter(e=>e!==t&&0!==e.indexOf(t+"=")).join("&")}function ur(e){if(!Jt(e))return;const{protocol:t,host:r}=or(e);return t+"//"+r+"/"+mp(r)}function hr(e,t){const r=e.getRecoverHelper();r&&r.planTask(()=>e.recoverStream(),t)}function*pr(e,t){void 0===t&&(t=Ep);const r=yield At(),{controller:{stream:i}}=r;if(!i)return;const n=function(e){const t=ur(e);if(!t)return;return Q(t,"r",""+Date.now()+Math.round(1e3*Math.random()))}(i.url);if(!n)return;let o=!1;for(;!1===o;){yield vt(()=>Yl(t).promise);try{yield vt(ir,n),o=!0}catch(a){}}yield ht(Vc(!0)),yield hr(e,Ap)}function*fr(e){const t=yield At(),{skin:{hiddenControls:r}}=t;yield vt([e,e.setHiddenControls],r)}function*vr(e){const{controller:{autoplay:r}}=yield At();r&&(yield pt([ht(vc(!1)),vt(()=>t(e.play()))]))}function gr(e,t){let{name:r,lang:i}=t;const n=e.find(e=>e.name===r);return n||(i?e.find(e=>e.lang===i):void 0)}function*mr(e){const{controller:{textTrackValue:t,textTracks:r,userTextTrackName:i,userTextTrackLang:n}}=yield At();if(t)return void(yield vt([e,e.setTextTrack],t));const o=gr(r,{name:i,lang:n})||function(e){if(0===e.length)return;const t=function(e,t){if("string"!==typeof t)return;const r=t.split("-")[0].toLowerCase();for(let i=0;i<e.length;i++){const t=e[i];if(t.name.toLowerCase()===r)return t}}(e,navigator.language);return void 0!==t?t:e[0]}(r);void 0===o?Ld.error("No text tracks to enable"):yield vt([e,e.setTextTrack],o.value)}function Er(e){return void 0!==e.ad.adInfo}function*Ar(e,t){let{payload:r}=t;const{controller:{playingState:i,watchedTime:n}}=yield At();if(i===r||i===Ql.END&&r===Ql.PAUSE)return;if(r===Ql.BUFFERING)return void(yield ht(Ic(Ql.BUFFERING)));if(i===Ql.BUFFERING&&r===Ql.PAUSE&&0===n||(yield ht(gc($h.started))),r!==Ql.END)return void(yield ht(Ic(r)));const o=yield At(),{ad:{adInfo:a}}=o;Er(o)?Ld.log("putPlayingState("+Ql.END+") has not been dispatched because ad("+(a&&a.adType)+") is playing"):yield function*(e){const t=e.getMultiroll(),r=yield t.postroll.loadViewers({});r.length>0&&(yield e.playAdViewers(wd.postroll,ue(r,wd.postroll),{})),yield ht(Ic(Ql.END)),e.stop()}(e)}function*yr(e,t){let{payload:r}=t;yield vt(e.callbacks.onAdblockDetected,r)}function*Tr(e,t){let{payload:r}=t;yield gt(e,e.callbacks.onAudioTracksChange,[r])}function Sr(e){const{audioTrackValue:t,audioTracks:r}=e.controller;return r.find(e=>{let{value:r}=e;return r===t})}function*Rr(e,t){let{payload:r}=t;const i=yield At();yield vt(e.callbacks.onAudioTrackChange,Sr(i))}function*_r(e,t){let{payload:r}=t;yield vt(e.callbacks.onBufferingRangesChange,r)}function Pr(e){return Ll("number"!==typeof(t=Math.floor(2*e)/2)||isNaN(t)||!isFinite(t)?0:t);var t}function Ir(e){const{controller:{currentTime:t,bufferingRanges:r},skin:{skinDVRStartTime:i,skinDVRDuration:n}}=e;if(0===r.length)return!1;return n===1/0||t>i+n-yp}function br(e){const{controller:{videoType:t}}=e;return t!==rp.VOD&&Ir(e)}function*Cr(e){const t=yield At(),{controller:{videoType:r,playbackRate:i,encoderState:n}}=t;r!==rp.VOD&&n===ep.Attached&&(Er(t)||(i>1.03?Ir(t)&&e.setPlaybackRate(1):!function(e){const{controller:{currentTime:t,dvrStartTime:r,dvrDuration:i}}=e;return t<r||t>r+i}(t)&&function(e){const{controller:{videoType:t}}=e;if(t!==rp.LIVE)return!1;const{controller:{currentTime:r},skin:{skinDVRStartTime:i}}=e;return i+(0===r?0:yp)>r}(t)&&e.setPlaybackRate(1)))}function Or(e){let{ad:{adInfo:t}}=e;return void 0!==t&&Rp.includes(t.adType)}function*wr(){const{controller:{currentTime:e,playingState:t,watchedTime:r,playbackRate:i,sourceId:n}}=yield At();if(Pp!==n&&(_p=void 0,Pp=n),void 0!==_p){const t=function(e,t){const r=e>=0&&e<=t+.5?e:t;return Ll(Math.max(0,r))}(Bl(Fl(e,_p.videoTime),i),Bl(Nl(_p.getElapsedTime()),1e3));yield ht(pu(xl(r,t)))}const o=yield At(Or);_p=t!==Ql.PLAY||o?void 0:{getElapsedTime:Y(),videoTime:e}}function*kr(e,t){let{payload:r}=t;yield wr(),yield Cr(e),yield gt(e,e.callbacks.onCurrentTimeChange,[r]),yield ht(Cc(Pr(r)))}function*Dr(){const{controller:{encoderState:e}}=yield At();e===ep.Attached&&(yield ht(Ac()))}function*Nr(e,t){const{error:r}=t.payload;if(void 0===r)return;const{code:i,isFatal:n,details:o}=r;n?(Ld.error(i,o),yield vt(e.setFullscreen,!1)):Ld.warn(i,o),yield vt(e.callbacks.onError,r)}function*Lr(e){let{payload:t}=e;const{controller:{videoTrackValue:r}}=yield At();yield ht(zc({videoTrackValue:r,isAbrEnabled:t}))}function*Mr(e,t){let{payload:r}=t;yield vt(e.callbacks.onFullScreenChange,r)}function*Vr(e,t){let{payload:r}=t;const{controller:{isOnline:i}}=yield At();i?Ip.includes(r.source)&&(yield vt(e.callbacks.onBandwidthEstimateChange,r)):yield vt(e.callbacks.onBandwidthEstimateChange,{value:wl(0),source:"default"})}function*xr(e,t){let{payload:r}=t;r||(yield Vr(e,{payload:{value:wl(0),source:"default"}})),yield vt(e.callbacks.onNetworkStatusChange,{isOnline:r})}function*Fr(e,t){let{payload:r}=t;yield vt(e.callbacks.onPlaybackRateChange,r)}function Ur(e){return"https://"+e+"/"+mp(e)+"?r="+function(e){let t="";for(let r=0;r<e;r++)t+=(16*yl()|0).toString(16);return t}(12)}function Br(e){return Ur(or(e).hostname)}function Hr(e){return e.map(e=>e&&e.name||"").filter(e=>{return Cp.includes($(e))&&(t=K(e).hostname,(r=Dp)===t.substring(t.length-r.length));var t,r})}function Gr(e,t,r){return void 0===r&&(r=0),Zs(e,e=>{let{start:i,end:n}=e;return i-r<=t&&t<=n+r})}function Wr(e,t){const r=Gr(e,t);return void 0===r?void 0:Fl(r.end,t)}function Yr(e){const{currentTime:t,bufferingRanges:r}=e.controller;return Wr(r,t)}function*jr(e){const t=yield At(),{bufferingRanges:r,stream:i}=t.controller;if(0===r.length)return;if(!function(e){return(Yr(e)||0)<Np}(t))return;if(e.getConnectionQuality()!==bp.OK)return;if(Er(t))return;if(!i)return;const n=ur(i.url);if(!n)return;const{resourceTimings:o}=e.getSyncDebugInfo(),a=function(e){const t=Hr(e);if(0===t.length)return[];const[r,i]=Le(t,e=>Z(e).includes("audio")),n=i[i.length-1],o=r[r.length-1],a=[];return n&&a.push(Br(n)),o&&a.push(Br(o)),a}(o),{controller:{isOnline:s}}=yield At();if(!s)return;const l=Q(n,"r",Date.now().toString()),d=a.map(e=>Q(e,"r",Date.now().toString()));if(a.length<=0)return;const c=ir(l),u={reason:"ChunkServerIsNotAvailable",delay:new Promise(e=>{c.then(()=>{Promise.all(d.map(ir)).catch(e)}).catch(ne)}),rawData:0};yield hr(e,u)}function*Kr(e){const{controller:{playingState:t},ad:{inStreamPlayingState:r}}=yield At();t===Ql.BUFFERING&&(yield jr(e),yield function*(e){const t=yield At(),{controller:{isOnline:r}}=t;if(!r){const t={reason:"recoverStreamIfIsOffline",delay:0,rawData:0};yield hr(e,t)}}(e)),yield wr(),void 0===r||r===Ql.END?yield vt(e.callbacks.onStateChange,t):yield vt(e.callbacks.onStateChange,r)}function*qr(e,t){let{payload:r}=t;if(!r)return;yield vt(e.callbacks.onResourcesIdle),e.callbacks.logEvent({event:Od.ResourcesIdle,params:{}}),yield Ph(5e3);const i=(0,Lp.getGpu)();e.callbacks.logEvent({event:Od.ClientInfo,params:{gpu:{renderer:i.renderer,vendor:i.vendor}}})}function*Xr(e,t){let{payload:r}=t;yield vt(e.callbacks.onStartStageChange,r)}function*zr(e,t){let{payload:r}=t;yield vt(e.callbacks.onChangeStream,r)}function*Qr(e,t){let{payload:r}=t;yield vt(e.callbacks.onStreamsWithSupportInfoChange,r)}function*Jr(e,t){let{payload:r}=t;yield gt(e,e.callbacks.onTextTracksChange,[r])}function*Zr(e,t){let{payload:r}=t;yield vt(e.callbacks.onVideoSizeChange,r)}function $r(){return($r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ei(e){const{videoTrackValue:t,videoTracks:r,isAbrEnabled:i}=e.controller,n=r.find(e=>{let{value:r}=e;return r===t});if(n)return $r({},n,{auto:i})}function*ti(e,t){yield Ph(0),yield vt(e.callbacks.onVideoTrackChange,yield At(ei))}function*ri(e,t){let{payload:r}=t;yield gt(e,e.callbacks.onVideoTracksChange,[r])}function*ii(e,t){let{payload:r}=t;yield vt(e.callbacks.onVideoTypeChange,r)}function*ni(e,t){let{payload:{volume:r,muted:i,changeReason:n}}=t;yield vt(e.callbacks.onVolumeChange,{volume:r,muted:i,changeReason:n})}function*oi(e){const t=yield At(),{skin:{nativeControlsVisibility:r},controller:{textTrackEnabled:i,nativeTextTrackVisible:n,isPip:o}}=t,a=void 0===n||n||o||Boolean(r&&i);yield vt([e,e.toggleNativeSubtitles],a)}function ai(e,t,r){void 0===r&&(r=Vp());let i=t;return function*(){var t;if(0===arguments.length)return;const{payload:n}=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],o=r(n,i)||Number.isNaN(n)&&Number.isNaN(i);o||(i=n,yield*e(...arguments))}}function*si(e){const{controller:{duration:t,playingState:r,watchedTime:i}}=yield At();if(isNaN(t)||0===i||r!==Ql.PAUSE)return;if(yield At(Er))return;const n=Y();for(;;){const t=Ll(n()/1e3),r=yield e.getMultiroll().postPauseroll.loadViewers({pausedTime:t});if(0!==r.length)return void e.planAdViewers(ue(r,wd.postPauseroll));yield Ph(xp)}}function li(e,t){const r=function(e,t){let{controller:{volume:r,muted:i,isAbrEnabled:n,videoTrackValue:o}}=t;return[Wt(yc,ai(ni,{volume:r,muted:i},Kt),e),Wt(yc,ai(fr,{volume:r,muted:i},Kt),e),Wt(Ic,ai(fr),e),Wt(lu,ai(fr),e),Wt(Pc,ai(ii),e),Wt(Eu,Ar,e),Wt(Ic,ai(Kr,tp.playingState),e),Wt(hc,ai(Kr,zh.inStreamPlayingState),e),Wt(bc,ai(kr),e),Wt(Ec,Dr),Wt(Ac,vr,e),Wt(wc,ai(zr),e),Wt(Lc,ai(Qr),e),Wt(Vc,ai(xr),e),Wt(Xc,ai(Lr,n)),Wt(zc,ai(ti,{videoTrackValue:o,isAbrEnabled:n}),e),Wt(Qc,ai(ri),e),Wt(Zc,ai(Rr),e),Wt($c,ai(Tr),e),Wt(tu,ai(Jr),e),Wt(su,mr,e),Wt(lu,ai(Mr),e),Wt(jc,Nr,e),Wt(ic,ai(yr),e),Wt(Yc,ai(_r),e),Wt(gc,ai(Xr),e),Wt(Wc,Fr,e),Wt(_c,ai(Zr),e),Wt(uc,ai(Vr),e),Wt(ru,oi,e),Wt(du,oi,e),Wt(iu,oi,e),Wt(lu,ai(oi),e),jt([pu,Ic],rr,e),Yt(Ic,si,e),Wt(oc,Qt),Wt(dc,tr,e),Wt(nc,tr,e),Wt(ec,ai(er),e),Wt(tc,ai(Xt),e),Wt(pc,ai(zt),e),Wt(fu,ai(qr),e),jt(Xh,pr,e)]}(e,t);return function*(){yield pt(r)}}function di(){return(di=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ci(e,t,r){return function(e,t){return e===t||!(!Number.isNaN(e)||!Number.isNaN(t))}(e[t],r)?e:di({},e,{[t]:r})}function ui(e){return function(t,r){return ci(t,e,r)}}function hi(){return(hi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function pi(e,t){return E(t).reduce((e,r)=>ci(e,r,t[r]),e)}function fi(){return(fi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function vi(e){return Ze({controller:(i=e.controller,Pe({},i).on(fc,ui("engine")).on(xc,ui("fragmentDuration")).on(Uc,ui("dvrStartTime")).on(Bc,ui("dvrDuration")).on(gc,ui("startStage")).on(Fc,ui("programDateTime")).on(uc,ui("lastKnownBandwidthEstimate")).on(yc,pi).on(Tc,ui("autoplayImpossible")).on(Sc,ui("userVolume")).on(Rc,ui("duration")).on(_c,pi).on(Pc,ui("videoType")).on(vc,ui("autoplay")).on(mc,ui("preload")).on(Ic,ui("playingState")).on(bc,ui("currentTime")).on(Cc,ui("currentTimeLowGranularity")).on(Oc,ui("from")).on(wc,ui("stream")).on(kc,ui("sourceParams")).on(Dc,e=>fi({},e,{sourceId:e.sourceId+1})).on(Nc,ui("streams")).on(Lc,ui("streamsWithSupportInfo")).on(Mc,ui("startPosition")).on(Yc,ui("bufferingRanges")).on(Ec,ui("encoderState")).on(qc,(e,t)=>ci(ci(e,"isAbrEnabled",e.isAbrEnabled&&t),"isAbrSupported",t)).on(Xc,(e,t)=>ci(e,"isAbrEnabled",t&&e.isAbrSupported)).on(zc,(e,t)=>{let{videoTrackValue:r,isAbrEnabled:i}=t;return pi(e,{videoTrackValue:r,isAbrEnabled:i&&e.isAbrSupported})}).on(Jc,(e,t)=>{let{name:r,height:i}=t;return pi(e,{userVideoTrackName:r,userVideoTrackHeight:i})}).on(Qc,ui("videoTracks")).on(Zc,ui("audioTrackValue")).on($c,ui("audioTracks")).on(eu,(e,t)=>{let{name:r,lang:i}=t;return ci(ci(e,"userAudioTrackName",r),"userAudioTrackLang",i)}).on(ru,ui("textTrackEnabled")).on(iu,ui("nativeTextTrackVisible")).on(nu,ui("feed")).on(ou,ui("textTrackValue")).on(tu,ui("textTracks")).on(au,(e,t)=>{let{enabled:r,name:i,lang:n}=t;return pi(e,{userTextTrackEnabled:r,userTextTrackName:i,userTextTrackLang:n})}).on(lu,ui("isFullscreen")).on(du,ui("isPip")).on(cu,ui("isVisible")).on(uu,ui("isDocumentVisible")).on(jc,(e,t)=>!t||function(e){return!E(e).length}(t)||t.error&&t.error.isFatal?fi({},e,{errorInfo:t}):e).on(Kc,ui("lastRecoverPosition")).on(Vc,ui("isOnline")).on(hu,ui("preview")).on(pu,ui("watchedTime")).on(Wc,ui("playbackRate")).on(mu,ui("videoElementStyle")).on(Au,ui("preloadDetails"))),ad:(r=e.ad,Pe({},r).on(hc,ui("inStreamPlayingState")).on($d,ui("adConfig")).on(tc,ui("adInfo")).on(pc,ui("nextAdInfo")).on(rc,ui("originalBroadcastAdCueId")).on(nc,ui("originalBroadcastAdCues")).on(ic,ui("adblockDetected")).on(sc,ui("hasPreroll")).on(lc,ui("adSyncInit")).on(cc,ui("nativeAdControlsVisibility")).on(ac,(e,t)=>{const r=op(e.originalBroadcastAdCues);return delete r[t],hi({},e,{originalBroadcastAdCues:r})})),skin:(t=e.skin,Pe({},t).on(vu,ui("hiddenControls")).on(gu,ui("nativeControlsVisibility")).on(Hc,ui("skinDVRStartTime")).on(Gc,ui("skinDVRDuration")).on(Fp,ui("useNativeSubtitles")))});var t,r,i}function gi(e,t){const r=jh(),i=function(e){let t=null;return rt(e,(0,Up.S)(e=>{t||(t=Promise.resolve().then(()=>{t=null,e()}))}))}((window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||rt)(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),i=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},n={getState:r.getState,dispatch:function(){return i.apply(void 0,arguments)}},o=t.map((function(e){return e(n)}));return tt({},r,{dispatch:i=rt.apply(void 0,o)(r.dispatch)})}}}(r))),n=Qe(vi(t),i),o=li(e,t);return r.run((function*(){for(;;)try{yield vt(o)}catch(t){0,e.callbacks.onError(new Cd(t,{code:ps.SAGA_ERROR,isFatal:!1}))}})),n}function mi(e){const{textTrackValue:t,textTracks:r}=e.controller;return r.find(e=>{let{value:r}=e;return r===t})}function Ei(e){let{controller:{videoType:t,currentTime:r},skin:{skinDVRStartTime:i,skinDVRDuration:n}}=e;return function(e){let{videoType:t,currentTime:r,dvrStartTime:i,dvrDuration:n}=e;return void 0===t||t===rp.VOD?Hp:n===1/0||r>i+n-yp?Wp:t!==rp.LIVE?Hp:i+(0===r?0:10)>r?Gp:Hp}({videoType:t,currentTime:r,dvrStartTime:i,dvrDuration:n})}function Ai(e){return(t=e.supportInfo).supported&&void 0!==t.engine;var t}function yi(e){return!(t=e.supportInfo).supported&&void 0!==t.noSupportReason;var t}function Ti(){return(Ti=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Si(e){const t=function(e){return e.filter(yi).map(e=>{let{supportInfo:t}=e;return t.noSupportReason})}(e),r={details:{streams:e},isFatal:!0};if(of(t,e=>e===df.INVALID_STREAM_URL))return new Cd(Ti({},r,{code:ps.INVALID_STREAM_URL}));if(of(t,e=>e===df.NO_SUPPORTED_DRM))return new Cd(Ti({},r,{code:ps.NO_DRM}));if(of(t,e=>e===df.NO_CODECS))return new Cd(Ti({},r,{code:ps.NO_CODECS}));const i=of(t,e=>e===df.NO_MSE);return new Cd(Ti({},r,i?lf?{code:ps.NO_PLAYABLE_STREAMS}:{code:ps.NO_MSE}:{code:ps.NO_PLAYABLE_STREAMS}))}function Ri(e,t){void 0===t&&(t=vf);const{hostname:r}=K(e),i=function(e){const{hostname:t}=K(e),r=t.split(".");return r.length<=2?t:r.slice(-2).join(".")}(e),n=t.includes(r)||t.includes(i);return n}function _i(e){return e.preferNative||Rf||nd?rf.NATIVE:rf.HLS}function Pi(e,t){return-1!==function(e,t,r,i){void 0===r&&(r=0);void 0===i&&(i=bf);for(let n=r;n<e.length;n++)if(i(e[n],t))return n;return-1}(e,t)}function Ii(e){const t=Object.values;if("function"===typeof t)return t(e);{const t=[];for(const r in e)m(e,r)&&t.push(e[r]);return t}}function bi(e,t){void 0===t&&(t=window);const r=o(t),i=new RegExp("\\b"+e+"/((?:\\d+)(?:\\.\\d+)*)\\b","i"),n=r.match(i);if(n)return n[1].split(".").map(e=>parseInt(e,10))}function Ci(){return(Ci=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Oi(e){if(!Af(e))return!1;const t=ie(e);if(t&&function(e){void 0===e&&(e=window);return/YandexSearch|YaSearchBrowser|YaApp_iOS|YaApp_Android/i.test(o(e))}(e))return!1;const r=function(e){return bi("YaBrowser",e)}(e);if(void 0===r)return!1;const[i,n,a,s]=r;if(i<18)return!0;if(18===i){if(n>4)return!1;if(t&&a<3)return!0;if(le(e)&&(a<1||!s||s<=526))return!0}return!1}async function wi(){const e=[],t=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]}];return await Promise.all(Lf.map(async r=>{try{await window.navigator.requestMediaKeySystemAccess(r,t),e.push(r)}catch(i){}})),e}function ki(){const e=[];return Lf.forEach(t=>{window.MSMediaKeys.isTypeSupported(t)&&e.push(t)}),e}function Di(e){let{video:t}=e;const r=[];return Lf.forEach(e=>{t.canPlayType("video/mp4",e)&&r.push(e)}),r}function Ni(){const e=[];return[Df,Nf].forEach(t=>{window.WebKitMediaKeys.isTypeSupported(t,"video/mp4")&&e.push(t)}),e}async function Li(e){void 0===Vf&&(Vf=async function(e){return wf&&!(Of||Cf||yf)?{supportedDrmSystems:[],detectionMethod:Mf.YandexBrowserLinux}:Oi()?{supportedDrmSystems:[],detectionMethod:Mf.OldYandexBrowser}:window.WebKitMediaKeys?{supportedDrmSystems:Ni(),detectionMethod:Mf.WebKitMediaKeys}:"function"===typeof window.navigator.requestMediaKeySystemAccess?{supportedDrmSystems:await wi(),detectionMethod:Mf.requestMediaKeySystemAccess}:"function"===typeof window.MSMediaKeys?{supportedDrmSystems:ki(),detectionMethod:Mf.MSMediaKeys}:e.video.webkitGenerateKeyRequest?{supportedDrmSystems:Di(e),detectionMethod:Mf.GenerateKeyRequest}:{supportedDrmSystems:[],detectionMethod:Mf.NotAvailable}}(e));const t=await Vf;return Ci({},t,{supportedDrmSystems:[...t.supportedDrmSystems]})}function Mi(){return Hf.canPlayType('video/mp4;codecs="avc1.4D481F"')?{supported:!0,engine:rf.MP4}:uf}async function Vi(e){const{stream:t,video:r,preferNative:i}=e,{drmConfig:n,url:o}=t;if(!(e=>function(e){const t=e.trim();return"//"===t.substr(0,2)||"http://"===t.substr(0,7)||"https://"===t.substr(0,8)}(e)&&Ri(e))(o))return ff;const a=(e=>"mpd"===$(e.toLocaleLowerCase()))(o),s=(e=>"m3u8"===$(e.toLocaleLowerCase()))(o);if((e=>"mp4"===$(e.toLocaleLowerCase()))(o))return Mi();if(!a&&!s)return pf;let l;if(l=a?Wf||(Wf=await Sf().then(()=>Gf).catch(()=>cf)):await async function(e){try{0,void 0===If&&(If=await Sf());return If.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')?lf?{supported:!0,engine:_i(e)}:Pf:lf?_f:uf}catch(t){return lf?_f:cf}}({stream:t,preferNative:i}),!l.supported)return l;if(void 0===n||!d(n))return l;return await async function(e,t){const{servers:r={}}=e,i=E(r);if(0===i.length)return!1;const n=await Bf({video:t});return of(i,e=>Pi(n,e))}(n,r)?l:hf}function xi(e){const{mpd:t,m3u8:r,mss:i}=function(e){return{mpd:e.filter(e=>{let{stream:t}=e;return"mpd"===$(t.url)}),m3u8:e.filter(e=>{let{stream:t}=e;return"m3u8"===$(t.url)}),mss:e.filter(e=>{let{stream:t}=e;return!["mpd","m3u8"].includes($(t.url))})}}(e),n=[...t,...i,...r];return n.find(e=>{let{stream:t}=e;return d(t.drmConfig)})||n[0]}function Fi(e){const t=e.filter(Ai);if(0===t.length)return;if(jf.isSmartTV())return xi(t);const r=t.find(e=>{let{stream:t}=e;return void 0!==t.drmConfig&&d(t.drmConfig)});if(r)return r;const i=t.find(e=>{let{supportInfo:t}=e;return t.engine===rf.NATIVE}),n=t.find(e=>{let{supportInfo:t}=e;return t.engine===rf.MPD}),o=Kf>=15&&!qf&&!((hd||Xf)&&(e=>{let t=!1;e&&(t=of(cp,t=>e.startsWith("https://"+t+"/live/")||e.startsWith("https://"+t+"/kal/")));return t})(null==n?void 0:n.stream.url));if(nd&&!o&&i)return i;if(n)return n;const a=t.find(e=>{let{supportInfo:t}=e;return t.engine!==rf.MP4});return a||t[0]}async function Ui(e){if(0===e.streams.length)return{status:"error",error:new Cd({code:ps.NO_STREAMS,details:{},isFatal:!0}),streamsWithSupportInfo:[]};const t=await function(e){let{streams:t,video:r,preferNative:i}=e;return Promise.all(t.map(async e=>({stream:e,supportInfo:await Vi({stream:e,video:r,preferNative:i})})))}(e),r=Fi(t);return r?{status:"success",supportedStream:r,streamsWithSupportInfo:t}:{status:"error",error:Si(t),streamsWithSupportInfo:t}}function Bi(e,t){for(let r=0;r<e.length;++r){const{start:i,end:n}=e[r];if(i<=xl(t,Ll(.1))&&t<=n)return Ll(Math.max(n-t,0))}return Ll(0)}function Hi(e,t){return{total:Bi(e.total,t),audio:Bi(e.audio,t),video:Bi(e.video,t)}}function Gi(e){return Q(e,"t",String(Date.now()))}async function Wi(e,t){const r=ur(e);return async function(e,t){try{return await Xe({url:e,withCredentials:t,method:"GET",checkStatus:e=>0!==e,retries:3}),!1}catch(r){return!0}}(r||Q(Gi(e),"abd","1"),!u(r)&&t)}function Yi(){return(Yi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ji(e){const{additionalParams:t=Kp}=e;if(!d(e.adConfig))return;const{partnerId:r,adBreaks:i}=e.adConfig;return r||i?Yi({},e.adConfig,{additionalParams:t}):void 0}function Ki(e){const t=K(e),r=X(t.search),i=(()=>{const e=void 0!==r.start,t=void 0!==r.end;return e||t?"?"+(e?"start="+r.start:"")+(t?(e?"&":"")+"end="+r.end:""):""})();return t.originalPath+i}function qi(e,t){return t&&"boolean"===typeof t.withCredentials?t.withCredentials:!!Jt(e.url)||qp.withCredentials}function Xi(e){const{stream:t,sourceParams:r}=e,i=K(t.url),n=X(i.search);return JSON.stringify([i.pathname,n.start,n.end,null==r?void 0:r.startPosition])}function zi(e){return e[0]}function Qi(e){return Array.isArray(e)}function Ji(e){const t=Jf.getItem("playerapi-numbers-session-storage-key"),i=r(()=>JSON.parse(t||""));return function(e,t){const r=e.find(e=>!!Qi(e)&&zi(e)===t);return void 0===r?void 0:Ll(r[1])}(Array.isArray(i)?i:[],e)}function Zi(e,t){const i=Jf.getItem("playerapi-numbers-session-storage-key"),n=r(()=>JSON.parse(i||"")),o=Array.isArray(n)?n:[];Jf.setItem("playerapi-numbers-session-storage-key",JSON.stringify(function(e,t,r){const i=function(e,t){return[e,t]}(t,r),n=e.findIndex(e=>!!Qi(e)&&zi(e)===t);for(0===n?e[0]=i:(n>0&&e.splice(n,1),e.splice(0,0,i));10<e.length;)e.pop();return e}(o,e,t)))}async function $i(e){let{url:t,data:r,contentType:i}=e;if(await ev(),Ee("web_gogol_fetch_keepalive")&&$f()){const e={method:"POST",body:r,keepalive:!0,priority:"low",credentials:"include"};void 0!==i&&(e.headers={"Content-Type":i});if((await fetch(t,e)).ok)return;if(!Ee("web_gogol_fetch_retry_once"))return;return await ev(),void fetch(t,e)}if(((e,t)=>{if("function"!==typeof navigator.sendBeacon)return!1;try{return navigator.sendBeacon(e,t)}catch(r){return!1}})(t,i?new Blob([r],{type:i}):r))return;const n=new XMLHttpRequest;n.open("POST",t),n.withCredentials=!0,void 0!==i&&n.setRequestHeader("Content-Type",i),n.send(r)}function en(e,t){try{e.details||(e.details={}),e.details.stage=t}catch(r){}}function tn(e,t){return Af(e)?function(e){void 0===e&&(e=window);const t=o(e).match(/YaBrowser\/([\d.]+)/),r=t&&t[1]||"";return r?parseFloat(r):-1}(e)<18.6?"pip":"x-yandex-pip":"disablePictureInPicture"in t?"disablePictureInPicture":void 0}function rn(e,t,r){const i=tn(e,r);i&&(t?r.removeAttribute(i):r.setAttribute(i,"true"))}function nn(){return(nn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function on(e){if(isNaN(e.value))return;const t={bandwidthEstimate:wl(Math.floor(e.value)),time:pl(),source:e.source};Ef.setItem("videolayer-bandwidth-estimate",JSON.stringify(t))}function an(e,t){return e.responseEnd-t.responseEnd}function sn(){if("undefined"===typeof window.performance)return{value:wl(NaN),source:"timing-api"};const e=mv.reduce((e,t)=>(0,gv.Z)(e,function(e){try{return e.performance.getEntriesByType("resource").filter(e=>{let{duration:t,responseEnd:r,transferSize:i}=e;return t>0&&r>0&&i>1024})}catch(t){return[]}}(t),an),[]).filter(e=>{let{name:t}=e;return tv.test(t)});if(0===e.length)return{value:wl(NaN),source:"timing-api"};const t=new Tv;return e.forEach(e=>{let{transferSize:r,duration:i}=e;return t.sample(Nl(i),r)}),t.getBandwidthEstimate({value:wl(NaN),source:"timing-api"})}function ln(e){const{controller:{lastKnownBandwidthEstimate:t,playerConfig:r}}=e;if(isFinite(t.value))return t;if(null!=r&&r.slowConnection)return{value:fv,source:"default-slow"};const i=function(){try{const e=Ef.getItem("videolayer-bandwidth-estimate");if(!e)return wl(NaN);const{bandwidthEstimate:t,time:r}=JSON.parse(e);return pl()-r<vv?t:wl(NaN)}catch(e){return wl(NaN)}}();if(!isNaN(i)&&i>0)return{value:i,source:"cache"};const n=sn();if(!isNaN(n.value)&&n.value>0)return n;const o=Dl(function(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:r={}}=t;if("number"===typeof r.downlink)return r.downlink;if("number"===typeof r.downlinkMax)return r.downlinkMax;if("string"===typeof r.type||"number"===typeof r.type)switch(r.type){case hv.BLUETOOTH:return 3;case uv.CELL_2G:return.384;case uv.CELL_3G:case hv.CELLULAR:return 2;case hv.WIMAX:return 37;case hv.NONE:return 0;case uv.ETHERNET:case hv.ETHERNET:case uv.WIFI:case hv.WIFI:case hv.MIXED:return 10;case uv.UNKNOWN:case hv.UNKNOWN:case hv.OTHER:}return-1}(window));return-1===o?{value:pv,source:"network-api"}:{value:Ul(Ul(o,1e3),1e3),source:"network-api"}}function dn(){return(dn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function cn(){return(cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function un(e){return new Promise((t,r)=>{!function(e){const{win:t=window,src:r,retries:i=0,onError:n=v}=e,o=new ll({id:Sv.LOAD_SCRIPT_ERROR,message:"Failed to load script ["+r+"]",details:{src:r,isSelfWindow:t===window,onBeforeLoad:Boolean(e.onBeforeLoad),retries:i}});Ge(dn({},e,{win:t,onError:()=>n(o)}))}(cn({},e,{onLoad:t,onError:r}))})}function hn(){Cv(),p(window.VTTCue)||(Ov?window.VTTCue=Ov:Ov=window.VTTCue)}function pn(e){let{win:t=window,src:r,checkLoad:i,onBeforeLoad:n=ne,onLoad:o=ne,withCredentials:a=!1}=e;Pv["ll1.0-1025"]=Pv["ll1.0-1025"]||{};const s=Pv["ll1.0-1025"];return s[r]||(s[r]=un({checkLoad:i,win:t,src:r,retries:3,dropCacheOnRetry:!0,onBeforeLoad:e=>{a||(e.crossOrigin="anonymous"),n()}}).then(o),s[r].catch(()=>delete s[r])),s[r]}function fn(){return pn({src:Iv,checkLoad:()=>"undefined"!==typeof Hls})}function vn(){return pn({src:bv,checkLoad:()=>"undefined"!==typeof shaka}).then(hn)}function gn(e,t,r){if(e.length<1)return;let[i]=e,n=t(i);for(let o=1;o<e.length;o++){const a=e[o],s=t(a);r(s,n)<0&&(i=a,n=s)}return i}function mn(e,t){return gn(e,t,(e,t)=>t-e)}function En(e,t){return gn(e,t,(e,t)=>e-t)}function An(e){return d(e.video)&&W(e.video.width)&&W(e.video.height)}function yn(e,t){let{maxWidth:r=Vl(1/0),maxHeight:i=Vl(1/0),width:n=Vl(1/0),height:o=Vl(1/0)}=t;const a=e.filter(An);if(a.length<=1)return e;const s=function(e,t){let{width:r,height:i}=e;return t>r/i?{width:r,height:Bl(r,t)}:{width:Ul(i,t),height:i}}({width:n,height:o},a[0].video.width/a[0].video.height),l=[],d=s.width*s.height,c=En(a.slice().reverse(),e=>{let{video:{width:t,height:r}}=e;return Math.abs(d-t*r)});for(let u=0;u<a.length&&(a[u].video.width<r&&a[u].video.height<i&&l.push(a[u]),c!==a[u]);u++);return l.length<1?[a[0]]:l}function Tn(e){const t=[],r=Object.create(null),i=Object.create(null);return e.forEach(e=>{const{video:n,audio:o}=e;n&&n.height&&n.width&&n.originalId&&o&&o.bandwidth?(void 0===r[n.originalId]&&(r[n.originalId]=[],i[n.originalId]=n),r[n.originalId].push(e)):t.push(e)}),y(r,(e,r)=>{const n=i[r];if(function(e){let{width:t,height:r}=e;const i=Math.max(t,r),n=Math.min(t,r);if(i<=0)return 0;let o=wv[0];for(let a=0;a<wv.length;a++){const e=wv[a],t=kv[e];if(i>=1.3*Math.floor(16*t/9)||n>=1.3*t)return o;o=e}return wv[wv.length-1]}({width:Vl(n.width),height:Vl(n.height)})<=360)t.push(...e);else{const r=mn(e,e=>{var t;return(null==(t=e.audio)?void 0:t.bandwidth)||0});t.push(r)}}),t}function Sn(e){return void 0!==e&&null!==e.getManifest()}function Rn(e){if(Sn(e))try{var t;const r=e.getVariantTracks(),i=r.find(xv),n=null==(t=e.getConfiguration().abr)?void 0:t.enabled,o=e.getMediaElement();if(!o||!n)return i;const{videoWidth:a=0,videoHeight:s=0}=o;return r.find(e=>e.width===a&&e.height===s&&e.originalAudioId===(null==i?void 0:i.originalAudioId))||i}catch(r){return}}function _n(e,t){return e.getAll().find(e=>e.pathname===t)}function Pn(e){return/\/init-?.*\.mp4/.test(e)}function In(e){const t=e.getNetworkingEngine();t&&(t.unregisterScheme("http"),t.unregisterScheme("https"))}function bn(e){if(void 0===e)return;const t=e.getManifest();if(!t)return;const r=e.getMediaElement();if(!r)return;const{currentTime:i}=r,{periods:n=[]}=t;for(let o=0;o<n.length-1;o++)if(n[o].startTime<i&&i<n[o+1].startTime)return n[o];return n[n.length-1]}function Cn(e){const t=Rn(e);if(!t)return;const r=bn(e);return r?r.variants.find(e=>t.id===e.id):void 0}function On(e,t){const r=Cn(e);if(!r||!r.video)return null;try{const e=r.video.findSegmentPosition(t);return W(e)?r.video.getSegmentReference(e):null}catch(i){return null}}function wn(e,t){let r=Ll(0);if(!Sn(e))return r;if(void 0===t){const i=e.getMediaElement();if(!i)return r;t=Ll(i.currentTime)}const i=On(e,t);if(i){const{startTime:e,endTime:t}=i;r=Fl(t,e)}return r}function kn(e,t){Of&&Yv<81&&Yv>77&&Ll(e.duration)-t<jv&&(t=Fl(Ll(e.duration),jv)),e.currentTime=t}function Dn(e){if(!Sn(e))return;if(!e.isLive())return rp.VOD;const t=function(e){const t=Cn(e);if(t&&t.video)return t.video.presentationTimeOffset}(e);return void 0!==t?0===t?rp.LIVE:rp.EVENT:void 0}function Nn(e,t){if(void 0===e)return;if(Dn(e)===rp.LIVE)return Ll(0);if(void 0===t)return;const r=t.documentElement.getAttribute("publishTime");if(!r)return;const i=Date.parse(r);return isNaN(i)?void 0:Ll(i/1e3)}function Ln(e){return e?function(e){let t="",r=0;const i=e.length;let n=0,o=0,a=0;for(;r<i;)switch(n=e[r++],n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(n);break;case 12:case 13:o=e[r++],t+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=e[r++],a=e[r++],t+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&a)<<0)}return t}(new Uint8Array(Array.from(e))):""}function Mn(e,t){if(void 0!==shaka&&e===shaka.net.NetworkingEngine.RequestType.MANIFEST&&t.data)return function(e){if(!e)return null;try{const t=(new DOMParser).parseFromString(e,"application/xml");return null===t.querySelector("parsererror")?t:null}catch(t){return null}}(Ln(new Uint8Array(t.data)))||void 0}async function Vn(e){let{shakaPlayer:t,streamUrl:r,startPosition:i}=e,n=!1;t.addEventListener("unloading",()=>n=!0);const o=W(null==i?void 0:i.utc),a=o||null==i?void 0:i.videoTime,s=t.load(r,W(a)?a:void 0);if(!o)return void await s;const l=null==i?void 0:i.utc,d=new Kv(t);if(await s,n)throw new Error("loadShakaSource aborted");const c=d.getManifestXml()||await d.waitForManifestXml();if(n)throw new Error("loadShakaSource aborted");const u=Nn(t,c),h=void 0===u?null==i?void 0:i.videoTime:0===u?null==i?void 0:i.utc:Math.max(Fl(l,u),0);if(void 0===h)return;const p=t.getMediaElement();(function(e){if(!Sn(e))return!1;const t=e.getMediaElement();return!!t&&(Number(t.readyState)>0&&Number(t.duration)>0)})(t)||await new Promise((e,r)=>{g(p,"loadeddata",e,{once:!0}),t.addEventListener("unloading",r)}),kn(p,Ll(h))}function xn(){return(xn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Fn(e){const{error:t}=e;return new Qv(t)}function Un(e){const t=K(e).pathname;return 0===t.indexOf("/vod/")||0===t.indexOf("/live/")||0===t.indexOf("/kal/")}function Bn(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.status:void 0}function Hn(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.readyState:void 0}function Gn(e){if(void 0===e)return;const{level:t,start:r,duration:i,url:n,relurl:o,sn:a,programDateTime:s,deltaPTS:l,dropped:d,endDTS:c,endPTS:u,startDTS:h,startPTS:p}=e;return{level:t,start:r,duration:i,url:n,relurl:o,sn:a,programDateTime:s,deltaPTS:l,dropped:d,endDTS:c,endPTS:u,startDTS:h,startPTS:p}}function Wn(){return(Wn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Yn(e){try{return JSON.parse(he(Wn({},e,{networkDetails:void 0,frag:Gn(e.frag)})))}catch(t){return{message:r(()=>t.message)||"Cannot serialize hlsJsError"}}}function jn(){return(jn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Kn(e){let{details:t,networkDetails:r}=e;if(451===(r?r.status:NaN))switch(t){case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:return ps.REGIONAL_LIMITATION_MANIFEST;case Hls.ErrorDetails.LEVEL_LOAD_ERROR:return ps.REGIONAL_LIMITATION_LEVEL;case Hls.ErrorDetails.FRAG_LOAD_ERROR:return ps.REGIONAL_LIMITATION_SEGMENT;default:return}}function qn(e){let{details:t,networkDetails:r}=e;const i=r?r.status:NaN;if(eg.includes(i))switch(t){case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:return ps.SIGNATURE_EXPIRED_MANIFEST;case Hls.ErrorDetails.LEVEL_LOAD_ERROR:return ps.SIGNATURE_EXPIRED_LEVEL;case Hls.ErrorDetails.FRAG_LOAD_ERROR:return ps.SIGNATURE_EXPIRED_SEGMENT;default:return}}function Xn(e){return void 0!==Kn(e)}function zn(e){return void 0!==qn(e)}function Qn(e){const{details:t,fatal:r}=e;return t?!og.includes(t)&&(!(!Xn(e)&&!zn(e))||Boolean(r)):Boolean(r)}function Jn(e,t){return void 0===e.err||void 0===e.err.message?"MISSED_STACK__"+t:e.err.message}function Zn(e){if(void 0===e)return;const{details:t}=e;if(t===Hls.ErrorDetails.BUFFER_STALLED_ERROR)return;const r=Qn(e)&&!$n(e),i=Kn(e)||qn(e)||t||ps.DEFAULT_ERROR,{err:{stack:n=new Error(Jn(e,i)).stack}={stack:void 0}}=e;return new Cd({code:i,isFatal:r,details:jn({},Yn(e),{networkErrorStatus:Bn(e),xhrReadyState:Hn(e)}),stack:n})}function $n(e){return!Xn(e)&&!zn(e)&&(!!e.details&&rg.includes(e.details))}function eo(e){const{details:t}=e;return!!t&&ng.includes(t)}function to(e){const t=e.split("x");if(t.length<2)return;const r={rows:parseInt(t[0],10),columns:parseInt(t[1],10)};return isNaN(r.rows)||isNaN(r.columns)?void 0:r}function ro(e,t){const{rows:r,columns:i}=e;if(!r||!i)return null;const{width:n,height:o}=t;return{width:Vl(n/i),height:Vl(o/r)}}function io(e,t){return 0===e.rows||0===e.columns?Ll(0):Ll(t/(e.rows*e.columns))}function no(e,t){if(0===Object.keys(e).length)return;const{uri:r,duration:i,resolution:n,tiles:o}=e;if([r,i,n,o].some(e=>!e))return void(t&&t("NonValidHLSThumbnailTileSessionData"));const a=to(o),s=function(e){if(""===e)return;const[t,r]=e.split("x"),i={width:Vl(parseInt(t,10)),height:Vl(parseInt(r,10))};return isNaN(i.width)||isNaN(i.height)?void 0:i}(n),l=Ll(parseFloat(i));if(void 0===a||void 0===s||isNaN(l))return void(t&&t("MapTileSessionDataParseError"));return{tiles:a,uriTemplate:r,spriteDuration:l,resolution:s,tileSize:ro(a,s),tileDuration:io(a,l)}}function oo(e,t,r){const i=t===ag.LOWRES?sg:lg,{VALUE:n=""}=e[i.tiles]||{},{VALUE:o=""}=e[i.duration]||{},{VALUE:a=""}=e[i.resolution]||{},{VALUE:s=""}=e[i.uri]||{},l=[n,o,a,s];if(!l.every(e=>""===e)){if(!l.some(e=>""===e))return{tiles:n,duration:o,resolution:a,uri:s};r&&r("NonValidHLSSessionData")}}function ao(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function so(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function lo(e){let{width:t,height:r,bitrate:i}=e;return t+"x"+r+"@"+i}function co(e){return e+"p"}function uo(e){let{width:t,height:r}=e;const i=!W(r)||r<=0;if(!W(t)||t<=0||i)return i?"":co(Vl(r));const n=Math.max(t,r),o=Math.min(t,r);let a=dg[0];for(let s=0;s<dg.length;s++){if(dg[s]===o)return co(dg[s]);if(n>=cg*Math.floor(16*dg[s]/9)||o>=cg*dg[s])return co(a);a=dg[s]}return co(dg[dg.length-1])}function ho(e,t){const{attrs:r={},width:i,height:n}=e;if(!W(n))return"";const o=uo(e);if(!W(i))return o;const a=lo({width:i,height:n,bitrate:wl(r["AVERAGE-BANDWIDTH"]?parseInt(r["AVERAGE-BANDWIDTH"],10):e.bitrate)}),s=t.get(a);return void 0===s?o:s}function po(e,t){if(void 0===e)return;const{height:r,width:i,url:n,bitrate:o}=e;return Array.isArray(n)?{name:ho(e,t),value:n[0],width:i,height:r,bitrate:o?Bl(wl(o),1e3):zp}:void 0}function fo(e,t){const r=function(e,t,r){const i={};return e.filter(e=>Boolean(r(e))).forEach(e=>{const n=t(e);(!i[n]||r(i[n])<r(e))&&(i[n]=e)}),Ii(i)}(e,e=>{let{height:t}=e;return t},e=>{let{bitrate:t}=e;return t}),i=[];return r.forEach(e=>{const r=po(e,t);r&&i.push(r)}),i}function vo(e,t){let{name:r,lang:i}=t;const n=r?e.find(e=>e.name===r):void 0;return n||(i?e.find(e=>e.lang===i):void 0)}function go(e,t){let{name:r,height:i}=t;const n=r?e.find(e=>e.name===r):void 0;if(n)return n;if(void 0===i)return;return En(e.filter(e=>{let{height:t}=e;return void 0!==t}),e=>{let{height:t}=e;return Math.abs(t-i)})}function mo(e,r){const{paused:i}=e,n=r();return i||t(e.play()),n}function Eo(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}function Ao(e){return void 0!==e&&W(e)&&e>=0}function yo(e){const{type:t}=e;return t===rp.VOD||!1===e.live?rp.VOD:t===rp.EVENT?rp.EVENT:rp.LIVE}function To(e){const t=function(e){let t;void 0===e&&(e=window);try{t=e.devicePixelRatio}catch(r){}return t||1}();return{width:(e.width||e.clientWidth||e.offsetWidth)*t,height:(e.height||e.clientHeight||e.offsetHeight)*t}}function So(e){const t=e.match(pg);if(t)return{width:Vl(parseInt(t[1],10)),height:Vl(parseInt(t[2],10)),bitrate:kl(parseInt(t[3],10))}}function Ro(e,t){E(t).forEach(r=>{const i=t[r];null===i?e.removeAttribute(r):e.setAttribute(r,i)})}function _o(e,t,r){void 0===t&&(t=Vp());let i=r;return function(r){if(!t(i,r))return i=r,e(r)}}function Po(e){let{skin:{hiddenControls:t}}=e;return!t.includes(Jl.TIMELINE)}function Io(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:r={}}=t;return Boolean(r.saveData)}function bo(e,t){void 0===t&&(t={});let r=0;const i=[],n=(t,n)=>{i.push(g(e,t,n,mg)),clearTimeout(r)},o=()=>w(i),a=new Promise((i,o)=>{const a=t=>{e.paused&&o(t)},s=e.play();if(a(gg.VideoTagPaused),n("durationchange",()=>a(gg.VideoTagPausedAfterDurationChange)),n("error",()=>a(gg.VideoTagPausedAfterError)),n("pause",()=>o(gg.PauseEvent)),n("playing",()=>{i(gg.PlayingEvent)}),s)t.useProgressEvent&&n("progress",()=>{i(gg.ProgressEvent)}),s.then(()=>i(gg.PromiseResolve)).catch(e=>o(function(e){return e?gg.PromiseReject+"["+e.code+"]["+e.name+"]["+e.message+"]":gg.PromiseReject}(e)));else{const{timeoutForNonPromisePlay:e}=t;"number"===typeof e&&e>0&&(r=window.setTimeout(()=>{o(gg.Timeout)},t.timeoutForNonPromisePlay))}});return a.then(o,o),a}function Co(e){let{kind:t}=e;return"subtitles"===t}function Oo(e){const t=[];for(let r=0;r<e.length;r++)Co(e[r])&&t.push(e[r]);return t}function wo(e){return e?"showing":"hidden"}function ko(e,t){let{paused:r}=e;return r?Ql.PAUSE:t?Ql.BUFFERING:Ql.PLAY}function Do(){return(Do=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function No(e){if("function"===typeof e.getVideoPlaybackQuality){const t=e.getVideoPlaybackQuality();return{droppedVideoFrames:t.droppedVideoFrames,corruptedVideoFrames:t.corruptedVideoFrames,totalVideoFrames:t.totalVideoFrames}}const t=e;return"number"===typeof t.webkitDroppedFrameCount&&"number"===typeof t.webkitDecodedFrameCount?Do({},_g,{droppedVideoFrames:t.webkitDroppedFrameCount,totalVideoFrames:t.webkitDecodedFrameCount}):_g}function Lo(){return(Lo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Mo(){return(Mo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Vo(e,t){if(void 0===t)return e;return void 0!==function(e){const t=function(e,t){return fp.href=e,((fp.hash||"").slice(1).split("&").map(e=>e.split("=")).map(e=>{let[t,r]=e;return[t,void 0===r?"":r]}).find(e=>{let[r]=e;return r===t})||[])[1]}(e,"t");return void 0===t?t:Ll(Number(t))}(e)?lr(e,"t",t):sr(e,"t",String(t))}function xo(e){if(Bg(e.message))return ps[e.message];if(Bg(e.code))return ps[e.code];const t=zv[e.code];return Bg(t)?ps[t]:ps.DEFAULT_ERROR}function Fo(e){if(void 0===e)return;const{id:t,label:r,language:i}=e;return{name:r||i,value:t,lang:i||""}}function Uo(e){const t=oe(e.audioTracks).find(e=>e.enabled);return t?Fo(t):void 0}function Bo(e){return"subtitles"===e.kind&&"StreamPlayerJs TextTrack"!==e.label}function Ho(e,t){if(void 0===e)return;const{id:r,label:i,language:n}=e;return{name:i||n,value:"undefined"!==typeof r&&""!==r?r:"index:"+t,lang:n||""}}function Go(e){const t=[];return oe(e).forEach(e=>{const r=Fo(e);r&&t.push(r)}),t}function Wo(e){const t=[];return oe(e).forEach((e,r)=>{if(!Bo(e))return;const i=Ho(e,r);i&&t.push(i)}),t}function Yo(e){if(void 0===e)return;const{id:t,label:r,language:i,bitrate:n=zp,height:o=0,width:a=0}=e;return{name:r||i,value:t,bitrate:n,height:o,width:a}}function jo(e){const t=[];return oe(e).forEach(e=>{const r=Yo(e);r&&t.push(r)}),t.filter(e=>{let{value:t}=e;return"auto"!==t})}function Ko(e){let{videoTracks:t=[],videoHeight:r,videoWidth:i}=e;const n=oe(t),o=n.find(e=>{let{selected:t}=e;return t});if(void 0!==o)return"auto"===o.id?(e=>{let{tracks:t,videoHeight:r,videoWidth:i}=e;return t.sort((e,t)=>{const{width:n=0,height:o=0}=e,{width:a=0,height:s=0}=t;return Math.abs(o-r)-Math.abs(s-r)||Math.abs(n-i)-Math.abs(a-i)})[0]})({tracks:n,videoHeight:r,videoWidth:i}):o}function qo(e,t){return t.code!==e.util.Error.Code.BAD_HTTP_STATUS?0:t.data[1]||0}function Xo(){return(Xo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function zo(e){return{error:String(e.error)||"",isFatal:Boolean(e.isFatal)}}function Qo(e,t){if(!t)return;const r=t,{code:i,severity:n,category:o,data:a}=r;let s="shaka."+function(e,t){let r;for(r in e.util.Error.Code)if(e.util.Error.Code.hasOwnProperty(r)&&t.code===e.util.Error.Code[r])return r;return"ERROR"}(e,r)+"_"+i,l=a,d=n===e.util.Error.Severity.CRITICAL;switch(o){case e.util.Error.Category.NETWORK:l.networkErrorStatus=qo(e,r);const t=function(e,t){if(t.code!==e.util.Error.Code.BAD_HTTP_STATUS)return;if(451!==qo(e,t))return;switch(t.data[t.data.length-1]){case e.net.NetworkingEngine.RequestType.MANIFEST:return ps.REGIONAL_LIMITATION_MANIFEST;case e.net.NetworkingEngine.RequestType.SEGMENT:return ps.REGIONAL_LIMITATION_SEGMENT;default:return}}(e,r)||function(e,t){if(t.code!==e.util.Error.Code.BAD_HTTP_STATUS)return;const r=qo(e,t);if(!eg.includes(r))return;switch(t.data[t.data.length-1]){case e.net.NetworkingEngine.RequestType.MANIFEST:return ps.SIGNATURE_EXPIRED_MANIFEST;case e.net.NetworkingEngine.RequestType.SEGMENT:return ps.SIGNATURE_EXPIRED_SEGMENT;default:return}}(e,r);void 0===t?s+=function(e,t){switch(t.code){case e.util.Error.Code.BAD_HTTP_STATUS:case e.util.Error.Code.HTTP_ERROR:case e.util.Error.Code.TIMEOUT:const r=function(e,t){const{RequestType:r}=e.net.NetworkingEngine;switch(t){case r.APP:return"APP";case r.LICENSE:return"LICENSE";case r.MANIFEST:return"MANIFEST";case r.SEGMENT:return"SEGMENT";case r.TIMING:return"TIMING";default:return}}(e,t.data[t.data.length-1]);return void 0===r?"_UNKNOWN":"_"+r;default:return""}}(e,r):(d=!0,s=t);break;case e.util.Error.Category.DRM:const n=a[0];if(!n||!(e=>{if(!e.data)return!1;return 418===e.data[1]})(n))break;const o=function(e){return new Cd({isFatal:e.isFatal,code:e.error===jg.EXPIRED_SIGNATURE?ps.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:ps.DRM_PROXY_ERROR,details:{drmProxyError:e.error}})}((e=>{try{return function(e){if("string"===typeof e)try{return zo(JSON.parse(e))}catch(t){return Xo({},Kg,{error:e})}return"object"===typeof e?zo(e):Kg}(e.data[2])}catch(t){return Kg}})(n));s=o.code,l=o.details,d=d||o.isFatal;break;case e.util.Error.Category.PLAYER:if(i===e.util.Error.Code.LOAD_INTERRUPTED)return;break;case e.util.Error.Category.CAST:case e.util.Error.Category.STORAGE:}return new Cd({code:s,isFatal:d,details:l,message:t.message,stack:t.stack})}function Jo(e){return!!d(e)&&(!!W(e.severity)&&(!!W(e.category)&&(!!W(e.code)&&!!cl(e.data))))}function Zo(e,t){return function(e,t){const r=t===ag.HIGHRES?zg:Qg,i=e.querySelector(r.version);if(!i||"2"!==i.getAttribute("value"))return;const n=e.querySelector(r.tiles),o=e.querySelector(r.uriTemplate),a=e.querySelector(r.spriteDuration),s=e.querySelector(r.resolution);if(!n||!o||!a||!s)return;const l=n.getAttribute("value"),d=o.getAttribute("value"),c=Ll(parseFloat(a.getAttribute("value")||"")),u=s.getAttribute("value");if(!l||!u||!d||isNaN(c))return;const h=function(e){const t=e.split("x");if(t.length<2)return;const r={width:Vl(parseInt(t[0],10)),height:Vl(parseInt(t[1],10))};return isNaN(r.width)||isNaN(r.height)?void 0:r}(u);if(!h)return;const p=to(l);if(!p)return;const f=ro(p,h),v=io(p,c);return{tiles:p,uriTemplate:d,spriteDuration:c,resolution:h,tileSize:f,tileDuration:v}}(e,t)||function(e,t){const r=oe(e.querySelectorAll('AdaptationSet[mimeType="image/jpeg"]'));let i=r[0];if(!i)return;if(t===ag.LOWRES){let e;if(r.forEach(t=>{t.querySelector('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:type"][value="'+ag.LOWRES+'"]')&&(e=t)}),!e)return;i=e}const n=i.querySelector("SegmentTemplate"),o=i.querySelector("Representation"),a=i.querySelector("EssentialProperty");if(!n||!o||!a)return;const s=a.getAttribute("value"),l=n.getAttribute("media"),d=Ll(parseFloat(n.getAttribute("duration")||"")),c=parseFloat(o.getAttribute("width")||""),u=parseFloat(o.getAttribute("height")||""),h={width:Vl(c),height:Vl(u)};if(!s||!l||!d||!c||!u)return;const p=to(s);if(!p)return;const f=ro(p,h),v=io(p,d);return{tiles:p,uriTemplate:l,spriteDuration:d,resolution:h,tileSize:f,tileDuration:v}}(e,t)}function $o(e,t){const r=Math.pow(10,t);return Math.round((e+tm)*r)/r}function ea(e,t){const r=function(e,t){let{stream:r}=e,{audio:i=Ll(0),video:n=Ll(0)}=t;if(!r||!rm())return;const{type:o}=r;switch(o){case"audio":return $o(i,3);case"video":return $o(n,3);default:return}}(e,t);void 0!==r&&(e.uris=e.uris.map(e=>function(e,t){const{hostname:r}=K(e);return r.match(im)?J(e,{bufsize:String(t)}):e}(e,r)))}function ta(e){return(e.getAttribute("id")||"")+"@"+(e.getAttribute("width")||"")+"x"+(e.getAttribute("height")||"")+";"}function ra(e){return oe(e.querySelectorAll("Representation")).map(ta).sort()}function ia(e,t,r){void 0===e&&(e=[]);const i=e.find(e=>{var i,n;const o=(null==(i=e.video)?void 0:i.originalId)===t,a=(null==(n=e.audio)?void 0:n.originalId)===r;return o&&a});if(void 0!==i)return i.id;const n=function(e,t,r){void 0===t&&(t=e=>Boolean(e));void 0===r&&(r=e.length-1);for(let i=r;i>=0;i--)if(t(e[i],i,e))return i;return-1}(e,e=>{var r;return(null==(r=e.video)?void 0:r.originalId)===t});return-1===n?void 0:e[n].id}function na(e,t){if(!t||!e)return;const r='AdaptationSet > Representation[id="'+t+'"]',i=e.querySelector(r);if(!i)return;const n=i.parentElement;if(!n)return;const o=n.getAttribute("lang");return o?o.toLowerCase():void 0}function oa(e,t){const{width:r,height:i,bandwidth:n}=e;if(!W(i))return"";const o=uo(e);if(!W(r)||!W(n))return o;const a=lo({width:r,height:i,bitrate:wl(n)}),s=t.get(a);return void 0===s?o:s}function aa(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:r}=t;return r||void 0}function sa(e){return e&&aa(e)||window}function la(){return(la=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function da(e){if(e in fm)return fm[e];const t=document.createElement("link");return t.rel="preload",t.as="script",fm[e]=new Promise((r,i)=>{t.onload=r,t.onerror=i,t.href=e,t.crossOrigin="anonymous",pm.appendChild(t)}).then(()=>{fm[e]=Promise.resolve()}).catch(()=>{delete fm[e],pm.removeChild(t)}),fm[e]}function ca(){return(ca=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ua(e){return"videoplayer-iframe-api-raa-cache-"+e.autoplay+"-"+e.allowMuted+"-"+e.muted}function ha(e){return r(()=>{const t=JSON.parse(Ef.getItem(ua(e))),{time:r,cacheVersion:i}=t,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,Em);return 2!==i?null:Date.now()-r<Am?n:null})||null}function pa(e){const t=e.navigator;if(!t)return;const{userActivation:r}=t;if(!d(r))return;const{isActive:i,hasBeenActive:n}=r;return{isActive:i,hasBeenActive:n}}function fa(e){const t=()=>Tm.forEach(e=>window.removeEventListener(e,r)),r=r=>{"pagehide"===r.type&&r.persisted||(e(r),t())};return Tm.forEach(e=>window.addEventListener(e,r)),t}function va(e){return"ya-video-player-"+e}function ga(e,t){const r=t.getElementById(va(e));let i=r&&r.parentElement;return i=i&&i.parentElement,i||void 0}function ma(e,t){if(void 0===t&&(t=window),!t||!t[e]||!t[e].prototype)return;const{play:r}=t[e].prototype;return r&&p(r)?r:void 0}function Ea(){return(Ea=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Aa(e){let{canPlayUnMuted:t,canPlayMuted:r,detectionMethod:i}=e;return{canPlayUnMuted:t,canPlayMuted:r,requireMute:!t&&r,requireUserGesture:!t&&!r,detectionMethod:i}}function ya(e){if("boolean"===typeof e.allowedToPlay)return Promise.resolve(function(e){const t=Im(e);return e.muted=!1,e.volume=1,e.allowedToPlay?(t(),Aa({canPlayUnMuted:!0,canPlayMuted:!0,detectionMethod:Rm.YaBroAllowedToPlay})):(e.muted=!0,e.volume=0,e.allowedToPlay?(t(),Aa({canPlayUnMuted:!1,canPlayMuted:!0,detectionMethod:Rm.YaBroAllowedToPlay})):(t(),Aa({canPlayUnMuted:!1,canPlayMuted:!1,detectionMethod:Rm.YaBroAllowedToPlay})))}(e));return ud&&dm<=9?Promise.resolve(Ea({},Cm,{detectionMethod:Rm.IOS9OrLess})):ns?bm?Promise.resolve(Ea({},Om,{detectionMethod:Rm.OldIE})):void 0:Promise.resolve(Ea({},Cm,{detectionMethod:Rm.HTML5VideoIsNotSupported}))}function Ta(e){let t,r,{videoSlot:i,autoplay:n,muted:o,allowMuted:a}=e;if(!n){const e={autoplay:!1,muted:o,detectionMethod:Dm.AutoplayDisabled};return{promise:Promise.resolve(e),abort:ne}}return{promise:new Promise(async e=>{t=e;const{promise:n,stop:s}=function(e,t){let{checkSoundEnabled:r=!0}=void 0===t?{}:t;const i=ya(e),n=new km(e,{checkSoundEnabled:r,promise:i});return{promise:n.promise,stop:n.stop}}(i,{checkSoundEnabled:!o});r=s;const{requireMute:l,requireUserGesture:d,detectionMethod:c}=await n.catch(()=>Om);e(function(e){let{requireUserGesture:t,requireMute:r,muted:i,allowMuted:n,detectionMethod:o}=e;return t?{autoplay:!1,muted:i,autoplayImpossible:!0,detectionMethod:o}:r?i||n?{autoplay:!0,muted:!0,detectionMethod:o}:{autoplay:!1,muted:i,autoplayImpossible:!0,requireAllowMutedToAutoplay:!0,detectionMethod:o}:{autoplay:!0,muted:i,detectionMethod:o}}({requireUserGesture:d,requireMute:l,muted:o,allowMuted:a,detectionMethod:c}))}),abort:()=>{r(),t({autoplay:!0,muted:o,detectionMethod:Dm.RASAborted})}}}function Sa(e,t){return void 0===e?void 0===t:"auto"in e&&!0===e.auto?"auto"===t:e.value===t}function Ra(){return(Ra=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function _a(){return(_a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Pa(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.join("")}function Ia(){this.returnValue=!1}function ba(){this.cancelBubble=!0}function Ca(e){return function(t){const r=function(e){return e.stopPropagation||(e.stopPropagation=ba),e.preventDefault||(e.preventDefault=Ia),e.target||(e.target=e.srcElement),e}(t);e.call(this,r)}}function Oa(e){e&&e.un()}function wa(e,t,r){return Math.max(Math.min(t,r)-Math.max(e,0),0)}function ka(e){const t=Qs(e),r=t.width,i=t.height;let n=0;if(r>0&&i>0){const e={width:window.innerWidth,height:window.innerHeight};n=wa(t.left,t.right,e.width)*wa(t.top,t.bottom,e.height)/(r*i)}return n}function Da(e){void 0===e&&(e=window);const t=o(e).match(/YaBrowser\/([\d]+)\.([\d]+)/);if(!t)return{major:-1,minor:-1};const[,r,i]=t;return{major:parseInt(r,10),minor:parseInt(i,10)}}function Na(){return Af(window)&&!ud&&!hd}function La(e,t){return Gl.some(r=>{if(!e[r.element])return!1;let i=t;for(;i;){if(e[r.element]===i)return!0;i=i.parentElement}return!1})}function Ma(){return(Ma=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Va(e){setTimeout(()=>{throw e},0)}function xa(){return(xa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Fa(e){let{url:t,adConfig:r,additionalParams:i}=e;t=((e,t)=>{if(!e||!t)return e;const r={"partner-id":"number"===typeof t.partnerId?String(t.partnerId):t.partnerId,"video-category-id":"number"===typeof t.category?String(t.category):t.category,"imp-id":String(t.impId),gzip:"1"};return J(e,r,{override:!0,saveOriginalPath:!0})})(t,r);const{from:n,vsid:o}=i,a=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(i,hE);return t=J(t,{from:n,vsid:o},{override:!0,saveOriginalPath:!0}),J(t,a,{override:!1,saveOriginalPath:!0})}function Ua(){return(Ua=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ba(e,t){if(!e.servers)return e;const r={};return function(e){return"function"===typeof Object.entries?Object.entries(e):E(e).map(t=>[t,e[t]])}(e.servers).forEach(e=>{let[i,n]=e;!function(e){const{hostname:t}=K(e);return-1!==pE.indexOf(t)}(n)?r[i]=n:r[i]=Q(n,"vsid",t)}),Ua({},e,{servers:r})}function Ha(e){const t=function(e,t){if(void 0===t&&(t=!0),nd&&t)return[];{const t=[];let i=e;for(;;)try{if(i=i.ownerDocument.defaultView.frameElement,!i)return t;t.push(i)}catch(r){return t}}}(e.documentElement).map(e=>e.ownerDocument);return t.unshift(e),t.map(e=>({location:l(e.defaultView),referrer:e.referrer}))}function Ga(){return(Ga=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Wa(e){void 0===e&&(e={});const t={};for(const r in e){const i=e[r],n=typeof i;"string"!==n&&"number"!==n&&"boolean"!==n||(t[r]=i)}return t}function Ya(){const{plugins:e}=window.navigator;return void 0===e||0===e.length?[]:Hm(e,Wa)}function ja(){const e=window.navigator||{},t=window.performance||{},{location:r,referrer:i}=function(e){let t="",r="";if(e){Ha(e).reverse().forEach(e=>{let{location:i,referrer:n}=e;t=t||i,r=r||n})}return{location:t,referrer:r}}(document);return{navigator:Ga({},Wa(e),{connection:Wa(e.connection),plugins:Ya()}),performance:{memory:Wa(t.memory)},playerLocation:location.href,iframeApiLocation:r,iframeApiReferrer:i}}function Ka(e){return[...e.hash.substr(1).split("&"),...e.search.substr(1).split("&")].reduce((e,t)=>{const[r,i]=t.split("=");return void 0!==i&&(e[r]=decodeURIComponent(i.replace(/\+/g," "))),e},{})}function qa(){return(qa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Xa(e){return n(e.toJSON)?e.toJSON():e}function za(){return(za=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Qa(e,t,r){if(void 0===r&&(r=window),!r.history)return;if(_m>-1&&_m<=15)return;const i=((e,t,r)=>{const i=za({},Ka(e));i.mq_url=void 0,i.lq_url=void 0,i.hq_url=void 0,i.hd_url=void 0,i.stream_url=r?function(e,t){return-1===e.indexOf("?")?e:t.reduce(dr,e)}(r,["vsid","partner-id","video-category-id","imp-id","gzip"]):"",i.additional_params="object"===typeof t.additionalParams?JSON.stringify(t.additionalParams):void 0;const{adConfig:n={}}=t;return i.partner_id=AE(n.partnerId),i.category=AE(n.category),i.imp_id=AE(n.impId),i.distr_id=AE(n.distrId),i.video_content_id=AE(n.videoContentId),i.video_content_name=AE(n.videoContentName),i.video_publisher_id=AE(n.videoPublisherId),i.video_publisher_name=AE(n.videoPublisherName),i.video_genre_id=AE(n.videoGenreId),i.video_genre_name=AE(n.videoGenreName),i.start_position=AE(t.startPosition),i.loop=AE(t.loop),i.with_credentials=AE(t.withCredentials),i.preview=AE(t.preview),i.host=e.hostname,i})(r.location,e,t),n=function(e,t,r){void 0===r&&(r={});for(const i in t)t.hasOwnProperty(i)&&(e=ar(e,i,t[i]));for(const i in r)r.hasOwnProperty(i)&&(e=sr(e,i,r[i]));return e}(r.location.href.split("?")[0].split("#")[0],i);try{r.history.replaceState(void 0,"",n)}catch(o){}}function Ja(){return(Ja=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Za(e){if(void 0===e&&(e=window),!e.navigator)return CE;const{connection:t={}}=e.navigator;return W(t.rtt)?t.rtt:CE}function $a(){return($a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function es(){return(es=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ts(){return ME?ME.getSourceId():NaN}var rs={};e.r(rs),e.d(rs,{actionTransformer:()=>Ie,logger:()=>Qd});const is=document.createElement("video"),ns="function"===typeof is.load;(function(){function e(){const e=r.apply(this);return t(e),e}if(!ns)return;const r=HTMLMediaElement.prototype.play;e.__yaMuffleVideoPlayPromiseOriginalPlay=r,HTMLMediaElement.prototype.play=e})(),"toJSON"in Error.prototype||Object.defineProperty(Error.prototype,"toJSON",{value(){const e={};return r(()=>{Object.getOwnPropertyNames(this).forEach((function(t){e[t]=this[t]}),this)}),e},configurable:!0,writable:!0});const os={}.toString,as=/\[object (\w+)\]/,ss=e=>{const t=os.call(e);if(!t)return null;const r=t.match(as);if(!r)return null;const i=r[1];return i||null},ls="https://strm.yandex.net/int/enc/srvr.xml",ds=-1===ls.indexOf("int/enc/srvr.xml"),cs=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase();return/windows/.test(t)}(),us=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase(),r=/windows nt (\d+\.\d+)/.exec(t);if(r){const e=Number(r[1]);return e>0?e:-1}return-1}();let hs,ps,fs;!function(e){e.DEFAULT="DEFAULT",e.MEDIA="MEDIA",e.NETWORK_MEDIA="NETWORK_MEDIA",e.NETWORK_PLAYER="NETWORK_PLAYER",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NO_CODECS="NO_CODECS",e.CANNOT_PLAY="CANNOT_PLAY",e.UNSUPPORTED_ENV="UNSUPPORTED_ENV",e.EXCEPTION="EXCEPTION",e.ADS="ADS",e.CONFIG="CONFIG",e.REGIONAL="REGIONAL",e.DRM="DRM",e.ACCESS="ACCESS",e.INVALID_STREAM_URL="INVALID_STREAM_URL"}(hs||(hs={})),function(e){e.DEFAULT_ERROR="DEFAULT_ERROR",e.YANDEX_RPC_ERROR="YANDEX_RPC_ERROR",e.BROADCAST_AD_BLOCK_INIT_ERROR="BROADCAST_AD_BLOCK_INIT_ERROR",e.AD_TYPE_IS_NOT_RECOGNIZED="AD_TYPE_IS_NOT_RECOGNIZED",e.INVALID_METADATA="INVALID_METADATA",e.INVALID_STREAM_URL="INVALID_STREAM_URL",e.UNSUPPORTED_MEDIA_TYPE="UNSUPPORTED_MEDIA_TYPE",e.SCRIPT_INIT_ERROR="SCRIPT_INIT_ERROR",e.MPD_WIDEVINE_CERT_LOAD_ERROR="MPD_WIDEVINE_CERT_LOAD_ERROR",e.MPD_SHAKA_INIT_ERROR="MPD_SHAKA_INIT_ERROR",e.NATIVE_HLS_NOT_SUPPORTED_ERROR="NATIVE_HLS_NOT_SUPPORTED_ERROR",e.HLS_JS_NOT_SUPPORTED_ERROR="HLS_JS_NOT_SUPPORTED_ERROR",e.REFRESH_SUBTITLES_ERROR="REFRESH_SUBTITLES_ERROR",e.ON_TICK_ERROR="ON_TICK_ERROR",e.FAIRPLAY_NOT_SUPPORTED="FAIRPLAY_NOT_SUPPORTED",e.FAIRPLAY_CERT_LOAD_ERROR="FAIRPLAY_CERT_LOAD_ERROR",e.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR="FAIRPLAY_CREATE_MEDIA_KEYS_ERROR",e.FAIRPLAY_CREATE_KEY_SESSION_ERROR="FAIRPLAY_CREATE_KEY_SESSION_ERROR",e.FAIRPLAY_SPC_LOAD_ERROR="FAIRPLAY_SPC_LOAD_ERROR",e.FAIRPLAY_CREATE_KEY_ERROR="FAIRPLAY_CREATE_KEY_ERROR",e.FAIRPLAY_INVALID_CONTENT_ID="FAIRPLAY_INVALID_CONTENT_ID",e.DRM_PROXY_ERROR="DRM_PROXY_ERROR",e.DRM_PROXY_ERROR_SIGNATURE_EXPIRED="DRM_PROXY_ERROR_SIGNATURE_EXPIRED",e.NO_HLS_JS_INSTANCE="NO_HLS_JS_INSTANCE",e.AD_IS_ALREADY_PLAYING="AD_IS_ALREADY_PLAYING",e.META_INFO_REQUEST_FAILED="META_INFO_REQUEST_FAILED",e.MULTIROLL_INIT_ERROR="MULTIROLL_INIT_ERROR",e.REACT_COMPONENT_DID_CATCH_ERROR_INFO="REACT_COMPONENT_DID_CATCH_ERROR_INFO",e.PLAY_AD_VIEWERS_ERROR="PLAY_AD_VIEWERS_ERROR",e.SAGA_ERROR="SAGA_ERROR",e.STRM_ABD_INVALID_RESPONSE="STRM_ABD_INVALID_RESPONSE",e.REPRESENTATION_CHANGE="REPRESENTATION_CHANGE",e.RECOVER_TASK_ERROR="RECOVER_TASK_ERROR",e.PRELOAD_SOURCE_FAILED="PRELOAD_SOURCE_FAILED",e.REGIONAL_LIMITATION_MANIFEST="REGIONAL_LIMITATION_MANIFEST",e.REGIONAL_LIMITATION_LEVEL="REGIONAL_LIMITATION_LEVEL",e.REGIONAL_LIMITATION_SEGMENT="REGIONAL_LIMITATION_SEGMENT",e.SIGNATURE_EXPIRED_MANIFEST="SIGNATURE_EXPIRED_MANIFEST",e.SIGNATURE_EXPIRED_LEVEL="SIGNATURE_EXPIRED_LEVEL",e.SIGNATURE_EXPIRED_SEGMENT="SIGNATURE_EXPIRED_SEGMENT",e.NO_STREAMS="NO_STREAMS",e.NO_CODECS="NO_CODECS",e.NO_MSE="NO_MSE",e.NO_DRM="NO_DRM",e.NO_PLAYABLE_STREAMS="NO_PLAYABLE_STREAMS",e.SHAKA_FILTER_ERROR="SHAKA_FILTER_ERROR",e.SHAKA_CONFIGURE_ERROR="SHAKA_CONFIGURE_ERROR",e.SHAKA_LOAD_SOURCE_ERROR="SHAKA_LOAD_SOURCE_ERROR",e.MEDIA_ERR_CUSTOM="MEDIA_ERR_CUSTOM",e.MEDIA_ERR_ABORTED="MEDIA_ERR_ABORTED",e.MEDIA_ERR_NETWORK="MEDIA_ERR_NETWORK",e.MEDIA_ERR_DECODE="MEDIA_ERR_DECODE",e.MEDIA_ERR_SRC_NOT_SUPPORTED="MEDIA_ERR_SRC_NOT_SUPPORTED",e.MEDIA_ERR_ENCRYPTED="MEDIA_ERR_ENCRYPTED"}(ps||(ps={})),function(e){e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.BUFFER_STALLED_ERROR="bufferStalledError",e.SHAKA_VIDEO_ERROR_3016="shaka.VIDEO_ERROR_3016",e.FRAG_PARSING_ERROR="fragParsingError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.PIPELINE_ERROR_DECODE="PIPELINE_ERROR_DECODE",e.DECODER_ERROR_NOT_SUPPORTED="DECODER_ERROR_NOT_SUPPORTED",e.SHAKA_CONTENT_UNSUPPORTED_BY_BROWSER_4032="shaka.CONTENT_UNSUPPORTED_BY_BROWSER_4032",e.BUFFER_APPEND_ERROR="bufferAppendError",e.SHAKA_MEDIA_SOURCE_OPERATION_THREW_3015="shaka.MEDIA_SOURCE_OPERATION_THREW_3015",e.MEDIA_ELEMENT_ERROR_FORMAT_ERROR="MEDIA_ELEMENT_ERROR: Format error",e.REMUX_ALLOC_ERROR="remuxAllocError",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.DEMUXER_ERROR_COULD_NOT_OPEN="DEMUXER_ERROR_COULD_NOT_OPEN",e.NS_ERROR_DOM_INVALID_STATE_ERR="NS_ERROR_DOM_INVALID_STATE_ERR",e.SHAKA_DASH_INVALID_XML_4001="shaka.DASH_INVALID_XML_4001",e.SHAKA_QUOTA_EXCEEDED_ERROR_3017="shaka.QUOTA_EXCEEDED_ERROR_3017",e.CHUNK_DEMUXER_ERROR_APPEND_FAILED="CHUNK_DEMUXER_ERROR_APPEND_FAILED",e.FAILED_TO_INIT_DECODER="Failed to init decoder",e.PIPELINE_ERROR_INITIALIZATION_FAILED="PIPELINE_ERROR_INITIALIZATION_FAILED",e.NS_ERROR_FAILURE="NS_ERROR_FAILURE",e.SHAKA_MEDIA_SOURCE_OPERATION_FAILED_3014="shaka.MEDIA_SOURCE_OPERATION_FAILED_3014",e.REQUEST_FAILED="2147500036: Request failed",e.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED="PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED",e.PIPELINE_ERROR_COULD_NOT_RENDER="PIPELINE_ERROR_COULD_NOT_RENDER",e.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE="MEDIA_ELEMENT_ERROR: Empty src attribute",e.NS_ERROR_DOM_MEDIA_METADATA_ERR="NS_ERROR_DOM_MEDIA_METADATA_ERR",e.NS_ERROR_DOM_MEDIA_FATAL_ERR="NS_ERROR_DOM_MEDIA_FATAL_ERR",e.SHAKA_RESTRICTIONS_CANNOT_BE_MET_4012="shaka.RESTRICTIONS_CANNOT_BE_MET_4012",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.FRAG_LOAD_ERROR="fragLoadError",e.SHAKA_BAD_HTTP_STATUS_1001_MANIFEST="shaka.BAD_HTTP_STATUS_1001_MANIFEST",e.SHAKA_HTTP_ERROR_1002_SEGMENT="shaka.HTTP_ERROR_1002_SEGMENT",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.LEVEL_LOAD_ERROR="levelLoadError",e.SHAKA_HTTP_ERROR_1002_MANIFEST="shaka.HTTP_ERROR_1002_MANIFEST",e.SHAKA_BAD_HTTP_STATUS_1001_SEGMENT="shaka.BAD_HTTP_STATUS_1001_SEGMENT",e.SHAKA_UNSUPPORTED_SCHEME_1000="shaka.UNSUPPORTED_SCHEME_1000",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.SHAKA_TIMEOUT_1003_SEGMENT="shaka.TIMEOUT_1003_SEGMENT",e.FRAG_LOAD_TIME_OUT="fragLoadTimeOut",e.MANIFEST_LOAD_TIME_OUT="manifestLoadTimeOut",e.LEVEL_LOAD_TIME_OUT="levelLoadTimeOut",e.SHAKA_TIMEOUT_1003_MANIFEST="shaka.TIMEOUT_1003_MANIFEST",e.SHAKA_TIMEOUT_1003_LICENSE="shaka.TIMEOUT_1003_LICENSE",e.AUDIO_TRACK_LOAD_TIME_OUT="audioTrackLoadTimeOut",e.INTERNAL_EXCEPTION="internalException",e.SHAKA_OPERATION_ABORTED_7001="shaka.OPERATION_ABORTED_7001",e.ON_PLAYER_INIT_ERROR_INTERNAL="ON_PLAYER_INIT_ERROR_INTERNAL",e.UNABLE_TO_LOAD_PLAYER_IFRAME="UNABLE_TO_LOAD_PLAYER_IFRAME",e.ON_PLAYER_INIT_ERROR="ON_PLAYER_INIT_ERROR",e.LOADER_INIT_ERROR="LoaderInitError",e.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT="UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT",e.FAILED_TO_DOWNLOAD_DEBUG_INFO="FAILED_TO_DOWNLOAD_DEBUG_INFO",e.SHAKA_REQUEST_FILTER_ERROR_1006="shaka.REQUEST_FILTER_ERROR_1006",e.PLAYER_CONTAINER_NOT_FOUND="PLAYER_CONTAINER_NOT_FOUND",e.KEY_LOAD_ERROR="keyLoadError",e.FEATURE_HANDLER_ERROR="FEATURE_HANDLER_ERROR",e.SHAKA_NO_LICENSE_SERVER_GIVEN_6012="shaka.NO_LICENSE_SERVER_GIVEN_6012",e.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER="InvalidConfigElementInCreatePlayer",e.INVALID_CONFIG_LANG_IN_CREATE_PLAYER="InvalidConfigLangInCreatePlayer",e.INVALID_CONFIG_IN_CREATE_PLAYER="InvalidConfigInCreatePlayer",e.INVALID_CONFIG_IN_SET_SOURCE="InvalidConfigInSetSource",e.INVALID_CONFIG_IN_SOURCE_UPDATE="InvalidConfigInSourceUpdate",e.SHAKA_FAILED_TO_CREATE_CDM_6002="shaka.FAILED_TO_CREATE_CDM_6002",e.SHAKA_HTTP_ERROR_1002_LICENSE="shaka.HTTP_ERROR_1002_LICENSE",e.SHAKA_LICENSE_REQUEST_FAILED_6007="shaka.LICENSE_REQUEST_FAILED_6007",e.SHAKA_FAILED_TO_GENERATE_LICENSE_REQUEST_6006="shaka.FAILED_TO_GENERATE_LICENSE_REQUEST_6006",e.SHAKA_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001="shaka.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001",e.SHAKA_FAILED_TO_ATTACH_TO_VIDEO_6003="shaka.FAILED_TO_ATTACH_TO_VIDEO_6003",e.SHAKA_LICENSE_RESPONSE_REJECTED_6008="shaka.LICENSE_RESPONSE_REJECTED_6008",e.SHAKA_INVALID_SERVER_CERTIFICATE_6004="shaka.INVALID_SERVER_CERTIFICATE_6004",e.SHAKA_EXPIRED_6014="shaka.EXPIRED_6014",e.SHAKA_BAD_HTTP_STATUS_1001_LICENSE="shaka.BAD_HTTP_STATUS_1001_LICENSE",e.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.LOAD_SKIN_ERROR="LOAD_SKIN_ERROR",e.INSERT_INTO_WITH_SECURE_FRAME="INSERT_INTO_WITH_SECURE_FRAME",e.ELEMENT_NOT_IN_DOM="ELEMENT_NOT_IN_DOM",e.ERROR_SCREEN_LOAD_ERROR="ERROR_SCREEN_LOAD_ERROR"}(fs||(fs={}));const vs={[hs.MEDIA]:"https://yandex.ru/support/video-player/loading-issues.html",[hs.NETWORK_MEDIA]:"https://yandex.ru/support/video-player/loading-issues.html",[hs.NETWORK_PLAYER]:"https://yandex.ru/support/video-player/player-issues.html",[hs.NETWORK_TIMEOUT]:"https://yandex.ru/support/video-player/player-issues.html",[hs.NO_CODECS]:"https://yandex.ru/search/?text=\u043a\u043e\u0434\u0435\u043a\u0438",[hs.UNSUPPORTED_ENV]:"https://yandex.ru/soft/browsers/",[hs.EXCEPTION]:"https://yandex.ru/support/video-player/loading-issues.html",[hs.DRM]:"https://yandex.ru/support/video-player/drm.html",[hs.INVALID_STREAM_URL]:null},gs={[hs.DEFAULT]:"DEFAULT_ERROR_CATEGORY_TITLE",[hs.MEDIA]:"MEDIA_ERROR_CATEGORY_TITLE",[hs.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_TITLE",[hs.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_TITLE",[hs.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_TITLE",[hs.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_TITLE",[hs.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_TITLE",[hs.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_TITLE",[hs.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_TITLE",[hs.CONFIG]:"CONFIG_ERROR_CATEGORY_TITLE",[hs.REGIONAL]:"REGIONAL_ERROR_CATEGORY_TITLE",[hs.DRM]:"DRM_ERROR_CATEGORY_TITLE",[hs.ACCESS]:"ACCESS_ERROR_CATEGORY_TITLE",[hs.INVALID_STREAM_URL]:"CONFIG_ERROR_CATEGORY_TITLE"},ms={[hs.DEFAULT]:"DEFAULT_ERROR_CATEGORY_MESSAGE",[hs.MEDIA]:"MEDIA_ERROR_CATEGORY_MESSAGE",[hs.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_MESSAGE",[hs.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_MESSAGE",[hs.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_MESSAGE",[hs.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_MESSAGE",[hs.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_MESSAGE",[hs.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_MESSAGE",[hs.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_MESSAGE",[hs.CONFIG]:"CONFIG_ERROR_CATEGORY_MESSAGE",[hs.DRM]:"DRM_ERROR_CATEGORY_MESSAGE",[hs.ACCESS]:"ACCESS_ERROR_CATEGORY_MESSAGE",[hs.INVALID_STREAM_URL]:"INVALID_STREAM_URL_ERROR_CATEGORY_MESSAGE"},Es={[hs.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_HELP_LINK",[hs.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_HELP_LINK"},As=e=>{const t=[];for(;e;)try{if(l(e),t.push(e),e.parent===e)break;e=e.parent}catch(r){break}return t},ys=(e,t)=>{for(const r of t.split(".")){if(!d(e)){e=void 0;break}e=e[r]}return e},Ts="__ADB_CONFIG__",Ss=d(Ts)&&Ts.fn&&n(Ts.fn.encodeUrl)?Ts.fn.encodeUrl:void 0,Rs=void 0!==Ss?e=>Ss(e):void 0,_s=function(e){if(void 0===e&&(e=window),Rs)return Rs;const t=As(e);for(;t.length;){const e=t.pop();if(!e)continue;const r=ys(e,"ya.videoAd.encodeUrl");if(n(r))return r}}(window);let Ps;const Is=function(e){return void 0===e&&(e=window),Ps||(Ps=e.document.createElement("div")),Ps}(window),bs=(e,t)=>{const r="undefined"!==typeof Is.style[e];if(r&&t&&u(t))try{Is.style.cssText=e+": "+t+";";const r=Boolean(Is.style.cssText);return Is.style.cssText="",r}catch(i){return!1}return r},Cs=["","webkit","moz","o","ms"],Os={},ws=function(e){return void 0===e&&(e=""),Os[e]||function(e){const t=""+e[0].toUpperCase()+e.slice(1);for(let r=0;r<Cs.length;r++){const i=Cs[r],n=i?""+i+t:e;if(bs(n))return Os[e]=n}return Os[e]=e}(e)},ks=e(6386),Ds=function(e){void 0===e&&(e=window);const t=ks(e);return"boolean"===typeof t?-1:t},Ns=function(e){return void 0===e&&(e=window),-1!==Ds(e)}(),Ls=function(e){return void 0===e&&(e=window),o(e).indexOf("SamsungBrowser")>-1}();let Ms=function(e,t,r){e.attachEvent("on"+t,r)},Vs=function(e,t,r){e.detachEvent("on"+t,r)};f(document,"addEventListener")&&f(document,"removeEventListener")&&(Ms=function(e,t,r,i){const n=e&&f(e,"addEventListener");n&&n.call(e,t,r,i)},Vs=function(e,t,r,i){const n=e&&f(e,"removeEventListener");n&&n.call(e,t,r,i)});let xs=!1,Fs=!1,Us=!1;try{if(function(e){void 0===e&&(e=window);const t=e.Object;try{const e={};return t.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(r){return!1}}()){const e=document.createElement("div"),t={};Object.defineProperty(t,"once",{get:()=>xs=!0}),Object.defineProperty(t,"passive",{get:()=>Fs=!0}),Object.defineProperty(t,"capture",{get:()=>Us=!0}),Ms(e,"click",v,t)}}catch(YE){}const Bs=(e,t,r)=>{const i=[];for(let n=0;n<e.length;n++){const o=e[n];t.call(r,o,n,e)&&i.push(o)}return i},Hs=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const{resolver:i,preparers:n}=A(t);let o,a=null,s=null;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(a&&a.every((e,r)=>t[r]===e))return o;const l=n.map(e=>e(...t));if(s&&s.every((e,t)=>l[t]===e))return a=t,o;const d=i(...l);return a=t,s=l,o=d,d}},Gs={xml:"http://www.w3.org/XML/1998/namespace",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},Ws={};y({xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type"},(function(e,t){const r=e.split(":"),i=Gs[r[0]];i&&(Ws[t]=i)}));const Ys="classList"in document.documentElement,js=Hs(e=>e.classList&&e.classList.add,p),Ks=(Hs(e=>e.classList&&e.classList.remove,p),Hs(e=>e.classList&&e.classList.toggle,p),(()=>{const e=document.createElement("p");return!!Ys&&(e.classList.add("c1","c2"),!!e.classList.contains("c2")&&(e.classList.toggle("c3",!1),!e.classList.contains("c3")))})()),qs=((()=>{const e=document.createElement("p");!!Ys&&(e.classList.toggle("a",!1),e.classList.contains("a"))})(),e=>e.split(" ").filter(e=>Boolean(e))),Xs=Ks?(e,t)=>{const r=qs(t);e.classList.add(...r)}:(e,t)=>{const r=qs(t);for(let i=0;i<r.length;i++)e.classList.add(r[i])},zs=e=>"hidden"in e?"hidden":"webkitHidden"in e?"webkitHidden":void 0,Qs=e=>{try{const{left:t,right:r,top:i,bottom:n}=e.getBoundingClientRect();return{left:t,right:r,top:i,bottom:n,width:r-t,height:n-i}}catch(t){return{left:0,width:0,top:0,height:0,right:0,bottom:0}}},Js=[].find,Zs=p(Js)?(e,t)=>Js.call(e,t):(e,t)=>{for(let r=0;r<e.length;r++){const i=e[r];if(t(i,r,e))return i}};let $s;const el=function(e){void 0===e&&(e=document.body);const t=function(e){const t=I(e);return t.width="0",t.height="0",t.style.position="absolute",t}(e);return{JSON:t.contentWindow.JSON,clean:()=>function(e){e.src="",b(e)}(t)}},tl=e=>t=>{const{JSON:r,clean:i}=el();try{return r[e](t)}finally{i()}},rl="DEFAULT_ERROR_MESSAGE",il=0,nl="",ol="?:?:?",al=!0,sl=e(5983);class ll extends Error{constructor(e,t){void 0===t&&(t={});const r="object"===typeof e?e:{message:String(e||rl)};super(),sl(this,ll.prototype),this.message=t.message||r.message||rl,this.code=t.code||r.code||r.id||il,this.isFatal=Boolean(function(e){const[t]=Bs(e,e=>void 0!==e);return t}([t.isFatal,r.isFatal,al])),this.details=t.details||r.details||nl;const i=t.stack||r.stack||function(e){const{url:t,line:r,col:i,fileName:n,columnNumber:o,lineNumber:a}=e;return(t||n||"?")+":"+(r||a||"?")+":"+(i||o||"?")}(r);let n=i===ol?this.stack:i;if(n&&n!==ol)this.stack=n;else if(!this.stack)try{throw new Error(this.message)}catch(o){this.stack=n=o.stack||ol}this.toString=()=>O(this.toJSON()),this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:this.details,stack:n})}}const dl=f(Array,"isArray"),cl=Boolean(dl)?e=>dl.call(Array,e):e=>"Array"===ss(e),ul=function(e,t){void 0===e&&(e=document);const r=e.currentScript;if(r)return r;{const r=e.getElementsByTagName("script"),i=[];for(let e=0;e<r.length;e++)i.push(r[e]);if("function"===typeof t){const e=i.filter(t);return e[e.length-1]}return i[i.length-1]}}(),hl=(ul&&ul.src,!p(Math.random)||Math.random()===Math.random()),pl=Date&&n(Date.now)?()=>Date.now():()=>(new Date).getTime(),fl="undefined"===typeof window?void 0:window.performance,vl=fl&&n(fl.now),gl=fl&&fl.timing&&fl.timing.navigationStart?fl.timing.navigationStart:pl();let ml=0;const El=vl?()=>fl.now():()=>(()=>{const e=pl()-gl;return ml=Math.max(e,ml),ml})();let Al=Date.now()*El()%2147483647;const yl=hl?function(){return Al=16807*Al%2147483647,(Al-1)/2147483646}:function(){return Math.random()},Tl=v,Sl=v,Rl=v;(e=>{let{win:t,propertyName:r}=e})({propertyName:"YANDEX_DESTROYABLE_GLOBAL_CALLBACK_PROPERTY_NAME",win:window});class _l{constructor(){this._isDestroyed=!1,this.destroyHandlers=[]}get destroyReason(){return this._destroyReason}get isDestroyed(){return this._isDestroyed}static addErrorHandler(e){_l.errorHandlers.push(e)}onDestroy(e){this._addDestroyHandler(e)}addDestroyListener(e){this._addDestroyHandler(e)}addDestroyHandler(e){this._addDestroyHandler(e)}destroy(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i]=t;if(!this._isDestroyed){this._isDestroyed=!0,this._destroyReason=i;try{w(this.destroyHandlers,...t)}catch(YE){w(_l.errorHandlers,YE)}this.destroyHandlers.length=0}}getIsDestroyed(){return this._isDestroyed}ignoreAfterDestroy(e){var t=this;let r=e;return function(){t.isDestroyed&&(r=v);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];r.apply(t,i)}}_addDestroyHandler(e){this._isDestroyed?e(this._destroyReason):this.destroyHandlers.push(e)}}_l.errorHandlers=[];class Pl{constructor(){this.on=[],this.once=[]}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.on.push(...t),()=>this.remove(...t)}addOne(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.once.push(...t),()=>this.remove(...t)}promise(){return new Promise(e=>this.addOne(e))}dispatch(e){const{once:t}=this;this.once=[],N(this.on,e),N(t,e)}removeAll(){this.on.length=0,this.once.length=0}remove(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.on=this.on.filter(e=>t.indexOf(e)<0),this.once=this.once.filter(e=>t.indexOf(e)<0)}}class Il extends Pl{constructor(e,t){void 0===t&&(t=(e,t)=>e===t),super(),this.checkToEqualFunction=t,this.value=e}getValue(){return this.value}subscribeValueCondition(e,t){return this.add(r=>{e(r)&&D(t,r)})}subscribeValueConditionOnce(e,t){const r=this.subscribeValueCondition(e,e=>{r(),D(t,e)});return r}dispatch(e){this.checkToEqualFunction(this.value,e)||(this.value=e,super.dispatch(e))}}let bl=0;const Cl=[],Ol=M,wl=M,kl=M,Dl=M,Nl=M,Ll=M,Ml=M,Vl=M,xl=function(e){let t=e;for(let r=0;r<(arguments.length<=1?0:arguments.length-1);r++)t+=r+1<1||arguments.length<=r+1?void 0:arguments[r+1];return t};xl.operator="+";const Fl=function(e){let t=e;for(let r=0;r<(arguments.length<=1?0:arguments.length-1);r++)t-=r+1<1||arguments.length<=r+1?void 0:arguments[r+1];return t};Fl.operator="-";const Ul=function(e){let t=e;for(let r=0;r<(arguments.length<=1?0:arguments.length-1);r++)t*=r+1<1||arguments.length<=r+1?void 0:arguments[r+1];return t};Ul.operator="*";const Bl=function(e){let t=e;for(let r=0;r<(arguments.length<=1?0:arguments.length-1);r++)t/=r+1<1||arguments.length<=r+1?void 0:arguments[r+1];return t};Bl.operator="/";class Hl extends _l{constructor(e){super(),this.onResize=void 0,this.resizeObserverCallback=e=>{let[{contentRect:{width:t,height:r}}]=e;this.onResize.dispatch({width:Vl(t),height:Vl(r)})};const t=Qs(e);if(this.onResize=new Il({width:Vl(t.width),height:Vl(t.height)},(e,t)=>{let{width:r,height:i}=t;return!!(isNaN(r)||isNaN(i)||r<1||i<1)||e.width===r&&e.height===i}),this.addDestroyHandler(()=>{this.onResize.removeAll()}),"undefined"!==typeof ResizeObserver)try{const t=new ResizeObserver(this.resizeObserverCallback);t.observe(e),this.addDestroyHandler(()=>{t.disconnect()})}catch(YE){this.fallbackToCustomDetectionMethods(e)}else this.fallbackToCustomDetectionMethods(e)}getSize(){return U({},this.onResize.getValue())}fallbackToCustomDetectionMethods(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:r}=t;if(!r)return;const i=()=>{const t=Qs(e);this.onResize.dispatch({width:Vl(t.width),height:Vl(t.height)})};this.addDestroyHandler(g(r,"resize",i,{passive:!0})),this.addDestroyHandler(L(i))}}const Gl=[{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}},{enabled:"webkitSupportsFullscreen",element:"webkitDisplayingFullscreen",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}}],Wl=e=>(e=>e instanceof Promise||"Promise"===ss(e)&&Boolean(r(()=>p(e.constructor))))(e)||(e=>Boolean(r(()=>n(e.then)&&n(e.catch))))(e),Yl=e=>{let t=0;return{promise:new Promise(r=>{t=window.setTimeout(r,e)}),clear(){clearTimeout(t)},timeoutId:t}};class jl{constructor(e){this.cache=e}get(e){return this.cache[e]}has(e){return e in this.cache}set(e,t){this.cache[e]=t}}const Kl=document.createElement("a"),ql=(function(e,t,r){void 0===t&&(t=e=>e),void 0===r&&(r=new jl({}))}(e=>j({},K(e))),/^(android-app:|chrome-extension:)/),Xl=e=>{try{return decodeURIComponent(e)}catch(t){return e}},zl=(e,t)=>t.map(t=>e+"[]="+encodeURIComponent(t)).join("&");let Ql,Jl;!function(e){e.PLAY="play",e.PAUSE="pause",e.BUFFERING="buffering",e.END="end"}(Ql||(Ql={})),function(e){e.ALL="*",e.PLAY="play",e.START_SCREEN_PLAY="startScreenPlay",e.VOLUME="sound",e.VOLUME_SLIDER="volumeSlider",e.SETTINGS="settings",e.SETTINGS_ITEM="settingsItem",e.FULLSCREEN="fullscreen",e.TIMELINE="timeline",e.TIMELINE_PREVIEW="timelinePreview",e.LIVE="live",e.POSTER="poster",e.START_POSITION_CONFIRM="startPositionConfirm",e.TIME_DISPLAY="time",e.TITLE_DISPLAY="titleDisplay",e.REPORT="report",e.FORWARD="forward",e.BACKWARD="backward",e.LOGO="logo",e.PRELOADER="preloader",e.CONTEXT_MENU="contextMenu",e.START_SCREEN="startScreen",e.PLAYBACK_RATE="playbackRate",e.SKIPPABLE_FRAGMENTS="skippableFragments",e.EXTERNAL_PLAYBACK="externalPlayback",e.RECOMMENDATIONS="recommendations",e.CLOSE_BUTTON="closeButton",e.NEXT_AD_INFO="nextAdInfo",e.SUBTITLES_TOGGLE="subtitlesToggle",e.LOGO_WIDGET="logoWidget",e.SKIP_AD="skipAd",e.MOBILE_SEEK_BUTTONS="mobileSeekButtons",e.TITLE="title"}(Jl||(Jl={}));const Zl=E(Jl).map(e=>Jl[e]),$l=e=>Zl.every(t=>e.includes(t)),ed=["","-webkit-","-ms-","-moz-","-o-"],td=ed.map(e=>"("+e+"any-pointer:coarse)").join(","),rd=ed.map(e=>"("+e+"touch-enabled)").join(","),id=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase();if(t.indexOf("android")>-1)return!1;const r=t.replace(/\(.+?\)/gi,"").split(" ").map(e=>e.trim().split("/")[0]).filter(e=>e&&"mobile"!==e);return 4===r.length&&"mozilla"===r[0]&&"applewebkit"===r[1]&&"version"===r[2]&&"safari"===r[3]},nd=function(e){return void 0===e&&(e=window),id(e)||ie(e)||function(e){return void 0===e&&(e=window),/Apple/.test(e.navigator.vendor)&&re(e)}(e)}(),od=nd?"":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";class ad{constructor(){this.resolve=void 0,this.reject=void 0,this.promise=void 0;let e=ne,t=ne;this.promise=new Promise((r,i)=>{e=r,t=i}),this.resolve=e,this.reject=t}}const sd=15,ld=1500,dd=le(),cd=function(e){void 0===e&&(e=window);const{platform:t=""}=e.navigator||{};return function(e){void 0===e&&(e=window);const{vendor:t=""}=e.navigator||{};return 0===t.indexOf("Google")}(e)&&!le(e)&&0===t.indexOf("Linux ")&&re(e)}(),ud=ie(),hd=navigator&&"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,pd=cd||dd||ud||hd;let fd;!function(e){e.Space="Space",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowRight="ArrowRight",e.ArrowLeft="ArrowLeft",e.KeyF="KeyF",e.Tab="Tab",e.Escape="Escape",e.Enter="Enter"}(fd||(fd={}));const vd={9:fd.Tab,13:fd.Enter,27:fd.Escape,32:fd.Space,37:fd.ArrowLeft,38:fd.ArrowUp,39:fd.ArrowRight,40:fd.ArrowDown,70:fd.KeyF},gd=["keyup","keydown"],md=["mousemove","click","dblclick","mouseenter","mouseleave","contextmenu"],Ed=["touchstart","touchend","longtouch"];class Ad{constructor(){this.handlers=Object.create(null),this.onceHandlers=Object.create(null),this.maxEventListeners=10}setMaxListeners(e){!isFinite(e)||e<=0||(this.maxEventListeners=e)}on(e,t){this.getHandlers(e).push(t),this.checkSubscriptions(e)}once(e,t){this.getOnceHandlers(e).push(t),this.checkSubscriptions(e)}off(e,t){const r=this.getHandlers(e),i=this.getOnceHandlers(e);if(void 0===t)return r.length=0,void(i.length=0);this.removeHandler(t,r),this.removeHandler(t,i)}emit(e,t){const r=this.getHandlers(e),i=this.getOnceHandlers(e).slice();this.getOnceHandlers(e).length=0,r.slice().concat(i).forEach(e=>{try{e(t)}catch(YE){setTimeout(()=>{throw YE},0)}})}getHandlers(e){return void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e]}getOnceHandlers(e){return void 0===this.onceHandlers[e]&&(this.onceHandlers[e]=[]),this.onceHandlers[e]}checkSubscriptions(e){const t=this.getHandlers(e).length+this.getOnceHandlers(e).length;t>this.maxEventListeners&&console.warn("There are "+t+" subscriptions on event named "+e)}removeHandler(e,t){const r=t.indexOf(e);-1!==r&&t.splice(r,1)}}class yd extends Ad{destroy(){this.emit("Destroy")}}class Td extends yd{constructor(e){super(),this.clickElement=e,this.createKeyboardEventHandler=e=>t=>{const r="code"in(i=t)&&i.code?i.code in fd?i.code:void 0:vd[i.which||i.keyCode];var i;void 0!==r&&(r!==fd.Tab&&t.preventDefault(),this.emit("Event",{type:e,event:{keyName:r,preventDefault:ne}}))},this.createMouseEventHandler=e=>"contextmenu"===e?e=>this.handleContextMenuMouseEvent(e):t=>this.handleMouseEvent(e,t),this.handleMouseEvent=(e,t)=>{if(!(r=t.target)||r.ownerDocument&&r.ownerDocument.compareDocumentPosition(r)&r.DOCUMENT_POSITION_DISCONNECTED)return;var r;const{clientX:i,clientY:n}=function(e,t){const{top:r,left:i}=e.getBoundingClientRect();return{clientX:t.clientX-i,clientY:t.clientY-r}}(this.clickElement,t);this.emit("Event",{type:e,event:{clientX:i,clientY:n,preventDefault:ne}})},this.handleContextMenuMouseEvent=e=>{e.ctrlKey||e.altKey||(e.preventDefault(),this.handleMouseEvent("contextmenu",e))},this.handleLongTouch=e=>{const t=[{clientX:0,clientY:0}],r={touches:e&&"touches"in e?e.touches:t,changedTouches:e&&"changedTouches"in e?e.changedTouches:t,cancelable:!1,preventDefault:ne};this.handleTouchEvent("longtouch",r)},this.createTouchEventHandler=e=>t=>this.handleTouchEvent(e,t),this.handleTouchEvent=(e,t)=>{const{touches:r,changedTouches:i}=function(e,t){const{top:r,left:i}=e.getBoundingClientRect();return{touches:Array.from(t.touches).map(e=>{let{clientX:t,clientY:n}=e;return{clientX:t-i,clientY:n-r}}),changedTouches:Array.from(t.changedTouches).map(e=>{let{clientX:t,clientY:n}=e;return{clientX:t-i,clientY:n-r}})}}(this.clickElement,t);this.emit("Event",{type:e,event:{touches:"touchend"===e?[]:r,changedTouches:"touchstart"===e?[]:i,preventDefault:()=>{try{if(!t.cancelable)return;t.preventDefault()}catch(e){}}}})},this.setMaxListeners(11),md.forEach(t=>{"contextmenu"===t&&pd||this.once("Destroy",g(e,t,this.createMouseEventHandler(t)))}),Ed.forEach(t=>{"longtouch"!==t?this.once("Destroy",g(e,t,this.createTouchEventHandler(t),{capture:!0,passive:!1})):this.once("Destroy",se(e,this.handleLongTouch,{touchesCount:2,handleContextmenu:!1}))}),gd.forEach(t=>{this.once("Destroy",g(e,t,this.createKeyboardEventHandler(t)))})}}let Sd;!function(e){e.Click="click",e.DoubleClick="dblclick",e.MouseMove="mousemove",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.ContextMenu="contextmenu"}(Sd||(Sd={}));const Rd=Nl(300),_d=Bl(Rd,3/4);class Pd extends Ad{static calculateEventSlop(e,t){let{event:r}=e,{event:i}=t;const n=r.touches[0]||r.changedTouches[0],o=i.touches[0]||i.changedTouches[0],a=Math.abs(n.clientX-o.clientX),s=Math.abs(n.clientY-o.clientY);return a*a+s*s}constructor(e){super(),this.timeoutId=void 0,this.firstTouchStartEvent=void 0,this.firstTouchStopEvent=void 0,this.secondTouchStartEvent=void 0,this.skipNextClick=!1,this.handleClickerEvent=e=>{if(function(e){return md.includes(e.type)}(e)&&this.handleMouseEvent(e),function(e){return Ed.includes(e.type)}(e))switch(e.timeStamp=Nl(Date.now()),e.type){case"touchstart":this.handleTouchStart(e);break;case"touchend":this.handleTouchEnd(e);break;case"longtouch":this.dispatchEvent(de({},e,{type:Sd.ContextMenu,event:de({},e.event,ce(e))}))}},this.handleTouchEnd=e=>{this.firstTouchStartEvent&&(this.firstTouchStopEvent||(this.firstTouchStopEvent=e))},this.handleTouchStart=e=>{if(this.skipNextClick=!0,this.firstTouchStartEvent||this.timeoutId){if(this.secondTouchStartEvent)return;{this.secondTouchStartEvent=e;const t=this.isConsideredDoubleTap();this.reset(),t&&this.dispatchEvent(de({},e,{type:Sd.DoubleClick,event:de({},e.event,ce(e))}))}}else this.firstTouchStartEvent=e,this.timeoutId=window.setTimeout(this.handleTimeout,Rd)},this.handleTimeout=()=>{const e=Boolean(this.firstTouchStartEvent&&this.firstTouchStopEvent&&!this.secondTouchStartEvent),t=this.areFirstTapsInSameBox(),r=e&&this.firstTouchStopEvent.timeStamp-this.firstTouchStartEvent.timeStamp<=_d,i=e&&t&&r,n=this.firstTouchStopEvent;this.reset(),i&&this.dispatchEvent(de({},n,{type:Sd.Click,event:de({},n.event,ce(n))}))};const{eventListener:t}=e;this.once("Destroy",()=>this.reset()),t.on("Event",this.handleClickerEvent),this.once("Destroy",()=>t.off("Event",this.handleClickerEvent))}destroy(){this.emit("Destroy")}handleMouseEvent(e){this.skipNextClick?e.type===Sd.Click&&(this.skipNextClick=!1):this.dispatchEvent(e)}dispatchEvent(e){-1!==e.event.clientX&&-1!==e.event.clientY&&this.emit("Event",e)}areFirstTapsInSameBox(){if(!this.firstTouchStartEvent||!this.firstTouchStopEvent)return!1;return Pd.calculateEventSlop(this.firstTouchStartEvent,this.firstTouchStopEvent)<=32}isConsideredDoubleTap(){if(!this.firstTouchStartEvent||!this.firstTouchStopEvent||!this.secondTouchStartEvent)return!1;if(!this.areFirstTapsInSameBox())return!1;if(!(Pd.calculateEventSlop(this.firstTouchStartEvent,this.secondTouchStartEvent)<=300))return!1;return!(this.secondTouchStartEvent.timeStamp-this.firstTouchStartEvent.timeStamp>Rd)}reset(){window.clearTimeout(this.timeoutId),this.timeoutId=void 0,this.firstTouchStartEvent=void 0,this.firstTouchStopEvent=void 0,this.secondTouchStartEvent=void 0}}class Id extends _l{constructor(e){super(),this.clickElement=e;const t=new Td(this.clickElement);this.addDestroyHandler(()=>t.destroy());const r=new Pd({eventListener:t});this.addDestroyHandler(()=>r.destroy());const i=e=>{e.type===Sd.DoubleClick&&e.event.preventDefault()};r.on("Event",i),this.addDestroyHandler(()=>r.off("Event",i))}}class bd extends ll{constructor(e,t){super(e,t),this.category=void 0,this.toJSON=void 0,this.category=a(this.code),this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:r(()=>u(this.details)?this.details:JSON.stringify(this.details))||this.details,stack:this.stack,category:this.category})}}class Cd extends bd{constructor(e,t){super(e,t)}}let Od,wd,kd,Dd;!function(e){e.BroadcastAdReceived="BroadcastAdReceived",e.BroadcastAdInit="BroadcastAdInit",e.StreamPlayerReceivedMetadata="StreamPlayerReceivedMetadata",e.StreamPlayerChooseMetadata="StreamPlayerChooseMetadata",e.PlayWithoutRAAResults="PlayWithoutRAAResults",e.CanPlay="CanPlay",e.ContentImpression="ContentImpression",e.WaitForPlayCompleted="WaitForPlayCompleted",e.DrmSystemsSupportDetected="DrmSystemsSupportDetected",e.InrollAdStart="InrollAdStart",e.InrollAdPodStart="InrollAdPodStart",e.InrollAdPodEnd="InrollAdPodEnd",e.InrollAdEnd="InrollAdEnd",e.PlayAdViewers="PlayAdViewers",e.AdStart="AdStart",e.AdPodImpression="AdPodImpression",e.AdPodLoading="AdPodLoading",e.AdPodError="AdPodError",e.AdPodStart="AdPodStart",e.AdPodEnd="AdPodEnd",e.AdEnd="AdEnd",e.AdClickThru="AdClickThru",e.NoAdPodsToPlayAd="NoAdPodsToPlayAd",e.Stalled="Stalled",e.LoadSource="LoadSource",e.PrerollInit="PrerollInit",e.WaitForUserGesture="WaitForUserGesture",e.WaitForDocumentVisibility="WaitForDocumentVisibility",e.CallPublicApiAfterDestroy="CallPublicApiAfterDestroy",e.HiddenAutoplayPrevented="HiddenAutoplayPrevented",e.PlayVideoOnVisibilityChange="PlayVideoOnVisibilityChange",e.PauseVideoOnVisibilityChange="PauseVideoOnVisibilityChange",e.StreamStopWhileLoadingMultiroll="StreamStopWhileLoadingMultiroll",e.StreamStopWhileChoosingStream="StreamStopWhileChoosingStream",e.StreamStopWhileDestroyVideoController="StreamStopWhileDestroyVideoController",e.StreamStopDuringDefineAutoplaySettings="StreamStopDuringDefineAutoplaySettings",e.StreamStopWhileWaitingForPlay="StreamStopWhileWaitingForPlay",e.StreamStopWhileWaitingForDocumentVisibility="StreamStopWhileWaitingForDocumentVisibility",e.StreamStopWhileLoadingPreroll="StreamStopWhileLoadingPreroll",e.StreamStopWhilePreloadingPreroll="StreamStopWhilePreloadingPreroll",e.SkippableFragmentWidgetDrawn="SkippableFragmentWidgetDrawn",e.SkippableFragmentWidgetHidden="SkippableFragmentWidgetHidden",e.HlsJsLoadSourceCalledTwice="HlsJsLoadSourceCalledTwice",e.PreloadSource="PreloadSource",e.UsePreloadedHlsJs="UsePreloadedHlsJs",e.PlayAfterWaitingForDocumentVisibility="PlayAfterWaitingForDocumentVisibility",e.ResourcesIdle="ResourcesIdle",e.ClientInfo="ClientInfo",e.HlsJsForceCappingStart="HlsJsForceCappingStart",e.CanRenderSkinCalledBeforeSkinIsReady="CanRenderSkinCalledBeforeSkinIsReady",e.ExternalPlaybackOpenButtonClick="ExternalPlaybackOpenButtonClick",e.ExternalPlaybackCloseButtonClick="ExternalPlaybackCloseButtonClick",e.ExternalPlayerListVisibleStatusChange="ExternalPlayerListVisibleStatusChange",e.ExternalPlaybackPlayerCsrfFetching="ExternalPlaybackPlayerCsrfFetching",e.ExternalPlaybackPlayerCsrfFetchSuccess="ExternalPlaybackPlayerCsrfFetchSuccess",e.ExternalPlaybackPlayerCsrfFetchError="ExternalPlaybackPlayerCsrfFetchError",e.ExternalPlaybackPlayerListHasAnyDevice="ExternalPlaybackPlayerListHasAnyDevice",e.ExternalPlaybackPlayerListFetching="ExternalPlaybackPlayerListFetching",e.ExternalPlaybackPlayerListFetchSuccess="ExternalPlaybackPlayerListFetchSuccess",e.ExternalPlaybackPlayerListFetchError="ExternalPlaybackPlayerListFetchError",e.ExternalPlaybackPlayerListAboutInfoClick="ExternalPlaybackPlayerListAboutInfoClick",e.ExternalPlaybackPlayerListRefresh="ExternalPlaybackPlayerListRefresh",e.ExternalPlaybackPlayerActivate="ExternalPlaybackPlayerActivate",e.ExternalPlaybackPlayerActivateSucceed="ExternalPlaybackPlayerActivateSucceed",e.ExternalPlaybackPlayerActivateFailed="ExternalPlaybackPlayerActivateFailed",e.ExternalPlaybackCsrfTokenExpired="ExternalPlaybackCsrfTokenExpired",e.YandexRpcError="YandexRpcError",e.YandexAndroidVsidChanged="YandexAndroidVsidChanged",e.Seek="Seek",e.RecommendationsSetParams="RecommendationsSetParams",e.RecommendationSelect="RecommendationSelect",e.RecommendationsWidgetVisibilityChange="RecommendationsWidgetVisibilityChange",e.PlayInrollAd="PlayInrollAd",e.ShareButtonClick="ShareButtonClick",e.FPSControllerRestrictions="FPSControllerRestrictions"}(Od||(Od={})),function(e){e.preroll="preroll",e.midroll="midroll",e.postPauseroll="postPauseroll",e.postroll="postroll",e.inroll="inroll"}(wd||(wd={})),function(e){e.Init="Init",e.SetSource="SetSource",e.Seek="Seek",e.VideoTrackChange="VideoTrackChange",e.AudioTrackChange="AudioTrackChange",e.Recover="Recover",e.MediaError="MediaError",e.Offline="Offline",e.Other="Other",e.RepresentationsChange="RepresentationsChange",e.LiveEdge="LiveEdge",e.AdStart="AdStart",e.AdOther="AdOther",e.AdBetween="AdBetween",e.AdEnd="AdEnd"}(kd||(kd={})),function(e){e.AdCompleted="AdCompleted",e.LoadSource="LoadSource",e.PlayerDestroy="PlayerDestroy",e.CutOff="CutOff",e.PlayerError="PlayerError",e.AdTypeChange="AdTypeChange",e.InsertIntoCalled="InsertIntoCalled",e.AdSkipped="AdSkipped"}(Dd||(Dd={}));const Nd=[];class Ld{static enableConsole(){Ld.consoleEnabled=!0,Ld.log("YA PLAYER VERSION: 1.0-1025")}static log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ld.consoleEnabled&&console.log(pe(...t)),Ld.addToHistory("log",t)}static warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ld.consoleEnabled&&console.warn(pe(...t)),Ld.addToHistory("warn",t)}static error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ld.consoleEnabled&&console.error(pe(...t)),Ld.addToHistory("error",t)}static getHistory(){return[...Nd]}static addToHistory(e,t){Nd.length>=150&&Nd.shift(),Nd.push("["+e+"]["+Date.now()+"] "+t.map(e=>{try{return he(e)}catch(YE){return JSON.stringify(["stringify_error",YE.stack])}}).join())}}Ld.consoleEnabled=void 0;const Md=ve(window),Vd=ve(window),xd={web_adsdk_new_skin:"true",web_gogol_fetch_keepalive:"false",web_gogol_fetch_retry_once:"false",web_gogol_wait_for_online:"false",web_prefer_hd:"false",web_skip_all_adpods:"false"};Vd.flags||(Vd.flags={});const Fd=G(()=>Ee("web_adsdk_new_skin")),Ud=async(e,t)=>fetch(e,{method:"POST",body:JSON.stringify([t])}),Bd={play:Ql.PLAY,pause:Ql.PAUSE,end:Ql.END,idle:Ql.PAUSE};class Hd extends _l{constructor(e){super(),this.params=e,this.destroyPromise=new Promise(e=>{this.addDestroyHandler(()=>{e()})}),this.currentAdPlaybackController=void 0,this.playbackQueue=[],this.logAdStart=G(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length,{logEvent:r}=this.params;r({event:Od.AdStart,params:{adPodsCount:t,adType:e}}),e===wd.inroll&&r({event:Od.InrollAdStart,params:{adPodsCount:t}})}),this.logAdEnd=G(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length,{logEvent:r}=this.params;e===wd.inroll&&r({event:Od.InrollAdEnd,params:{adPodsCount:t}}),r({event:Od.AdEnd,params:{stopAdReason:this.destroyReason||Dd.AdCompleted,adPodsCount:t,adType:e}})}),this.adPodIndex=0,this.startPlayingAd=G(async()=>{let e=void 0,t=void 0;for(this.logAdStart();this.adPodIndex<this.playbackQueue.length&&!this.isDestroyed;)e=this.playbackQueue[this.adPodIndex],this.params.yaDirectPixel&&(t=e.adViewer.getYandexBidReqIdArray(),Ud(this.params.yaDirectPixel.url,ye({},this.params.yaDirectPixel.data,{eventUnixTime:Date.now(),eventType:"ads_rendered",inventory:"instream",count:e.adViewer.getAdPodsCount(),bidReqId:t&&t.length>0?t[0]:void 0}))),await this.playAdPod(e),this.adPodIndex++;this.logAdEnd();const i=this.playbackQueue[this.playbackQueue.length-1];this.isDestroyed||void 0===i||r(()=>{this.params.onLastAdPodStopped({adType:i.adViewer.getAdBreakType()})}),this.destroy(Dd.AdCompleted)}),this.dispatchOnFirstAdPodStarted=G(()=>{this.params.onFirstAdPodStarted()}),this.updateAdPodCloseState=e=>{this.params.onAdPodCloseStateChange(e.getAdPodCloseState())},this.updateAdVolumeAvailabilityStateChange=e=>{this.params.onAdVolumeAvailabilityStateChange(e.getAdVolumeAvailabilityState())},this.updateAdPodTimeToSkip=e=>{const t=e.getAdPodTimeToSkip();this.params.onAdPodTimeToSkipChange(W(t)?Ll(Math.ceil(t)):void 0)},this.playAdPod=async e=>{let{adType:t,adViewer:r,additionalData:i,adDisplayConfig:n,posterUrl:o,adElement:a}=e;if(0===r.getAdPodsCount())return void Ld.log("AdViewer is empty");const{logEvent:s}=this.params;if(s({event:Od.AdPodLoading,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}}),t===wd.inroll){const{cueId:e}=i;s({event:Od.InrollAdPodStart,params:{adPodsCount:this.playbackQueue.length,cueId:e}}),r.setStatsRootFields({cueid:e})}const l=r.createPlaybackController(this.params.video,a,ye({videoSlotCanAutoPlay:!0,controlsSettings:this.params.getControlsSettings(),visibilitySlot:this.params.playerContainer,lang:this.params.lang,contentAfterAd:this.getContentAfterAd(t,o),enableNewSkin:Fd(),adSequence:{index:this.adPodIndex,count:this.playbackQueue.length}},n));this.currentAdPlaybackController=l,this.updateAdPodDuration(l),this.params.onAdPodCurrentTimeChange(Ll(0)),this.params.onAdSkippableStateChange(l.getAdSkippableState()),this.updateAdPodCloseState(l),this.updateAdVolumeAvailabilityStateChange(l),l.subscribe("AdPlayingStateChange",()=>{this.updateAdPodPlayingStateChange()}),l.subscribe("AdMediaStateChange",()=>{this.updateAdPodPlayingStateChange()}),l.subscribe("AdRemainingTimeChange",()=>{const e=l.getAdPodRemainingTime(),t=this.updateAdPodDuration(l);this.params.onAdPodCurrentTimeChange(Ll(t-e)),this.updateAdPodTimeToSkip(l),this.updateAdPodPlayingStateChange()}),l.subscribe("AdPodError",()=>{this.params.onAdPodError()}),l.subscribe("AdInteraction",()=>{this.params.onAdInteraction()}),l.subscribe("AdSkippableStateChange",e=>{this.updateAdPodTimeToSkip(l),this.params.onAdSkippableStateChange(e.skippableState)}),l.subscribe("AdStartRejected",e=>{this.params.onAdStartRejected(new Error("AdStartRejected"))}),l.subscribe("AdPodDurationChange",()=>{this.updateAdPodDuration(l)}),l.subscribe("AdPodStartRequest",()=>{this.params.onBeforeAdPodStart({adPlaybackController:l})}),l.subscribe("AdPodStarted",()=>{var e;const t=null==(e=l.getCurrentViewerAssets())?void 0:e.isFullyClickable;s({event:Od.AdPodStart,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i,isFullyClickable:t}}),this.dispatchOnFirstAdPodStarted(),this.params.onAdPodStarted({isFullyClickable:t}),this.updateAdPodPlayingStateChange(),this.updateAdPodDuration(l)});const d=()=>{this.params.onAdPodDurationChange(void 0),this.params.onAdPodCurrentTimeChange(void 0),this.params.onAdSkippableStateChange(!1),this.params.onAdPodTimeToSkipChange(void 0),this.params.onAdPodCloseStateChange(void 0)};l.subscribe("AdPodStopped",()=>{d(),this.params.onAdPodStopped()}),l.subscribe("AdPodSkipped",()=>{d(),this.params.onAdPodSkipped()}),l.subscribe("AdContentSizeChange",()=>{const e=l.getAdContentSize();if(void 0===e)return;const{width:t,height:r}=e;this.params.onAdSizeChange({width:Vl(W(t)?t:NaN),height:Vl(W(r)?r:NaN)})}),l.subscribe("AdPodImpression",()=>{s({event:Od.AdPodImpression,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}})}),l.subscribe("AdPodError",e=>{s({event:"AdPodError",params:ye({},e,{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i})})}),l.subscribe("AdClickThru",()=>{this.params.onAdClickThru(),s({event:"AdClickThru",params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}})}),this.shouldSkipAllAdPods()&&l.subscribe("AdPodSkipped",()=>{this.destroy(Dd.AdSkipped)}),l.subscribe("AdPodCloseStateChange",()=>{this.updateAdPodCloseState(l)}),l.subscribe("AdVolumeAvailabilityStateChange",()=>{this.updateAdVolumeAvailabilityStateChange(l)}),await new Promise(e=>{l.subscribe("AdStopped",e),l.playAd(),this.params.onAdPodPlayingStateChange({adType:t,playingState:Ql.BUFFERING,expectedStalledReason:0===this.adPodIndex?kd.AdStart:kd.AdBetween})}),this.currentAdPlaybackController=void 0,s({event:Od.AdPodEnd,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}}),t===wd.inroll&&(s({event:Od.InrollAdPodEnd,params:{adPodsCount:this.playbackQueue.length,cueId:i.cueId}}),r.setStatsRootFields({cueid:void 0}))},this.addDestroyHandler(()=>{this.currentAdPlaybackController&&(this.currentAdPlaybackController.stopAd(),this.currentAdPlaybackController=void 0)})}playAdViewers(e){this.isDestroyed||(this.playbackQueue.push(e),this.addDestroyHandler(()=>{e.adViewer.destroy()}),Promise.resolve().then(()=>this.startPlayingAd()))}resumeAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.resumeAd(),this.updateAdPodPlayingStateChange())}pauseAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.pauseAd(),this.updateAdPodPlayingStateChange())}skipAdPod(){this.currentAdPlaybackController&&this.currentAdPlaybackController.skipAd()}setVolume(e){this.currentAdPlaybackController&&this.currentAdPlaybackController.setAdVolume(e)}getDestroyPromise(){return this.destroyPromise}getAdTypeForLogs(){const[e]=this.playbackQueue;return e?e.adType:(this.params.onError(new Cd({code:ps.AD_TYPE_IS_NOT_RECOGNIZED,isFatal:!1})),"unrecognized")}updateAdPodPlayingStateChange(){if(!this.currentAdPlaybackController)return;const e=this.currentAdPlaybackController.getAdMediaState(),t=this.currentAdPlaybackController.getAdPlayingState(),r=this.playbackQueue[this.adPodIndex].adPodType,i=this.params.video.src,n="stalled"===(null==e?void 0:e.name)&&i?{adType:r,playingState:Ql.BUFFERING,expectedStalledReason:kd.AdOther}:{adType:r,playingState:Bd[t],expectedStalledReason:void 0};this.params.onAdPodPlayingStateChange(n)}updateAdPodDuration(e){const t=Ll(e.getAdPodDuration());return this.params.onAdPodDurationChange(t),t}shouldSkipAllAdPods(){var e;return Boolean(null==(e=this.params.adConfig)?void 0:e.skipAllAdPods)||Ee("web_skip_all_adpods")||!1}getContentAfterAd(e,t){const r=this.playbackQueue.length-1===this.adPodIndex,i=this.shouldSkipAllAdPods(),n=t?[{url:t}]:[];switch(e){case wd.preroll:return r||i?{type:"startVideo",poster:n}:{type:"nextAd",poster:[]};case wd.postroll:return{poster:[]};case wd.midroll:case wd.postPauseroll:case wd.inroll:return r||i?{type:"continueVideo",poster:n}:{type:"nextAd",poster:[]};default:return{poster:[]}}}}var Gd={},Wd={checkExisting:!0},Yd=0,jd=function(e){return e},Kd=function(e){return e&&"function"===typeof e.dispatch?e.dispatch:e},qd=function(e){return Array.isArray(e)?e.map(Kd):Kd(e)};const Xd=Se("Batch",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 1===t.length&&Array.isArray(t[0])?t[0]:t}));var zd=Xd.getType(),Qd={},Jd=function(e){"function"===typeof console[e]&&(Qd[e]=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var n=r.pop();Array.isArray(n)&&n.type===zd?n.forEach((function(t){console[e].apply(console,[].concat(r,[t]))})):(r.push(n),console[e].apply(console,r))})};for(var Zd in console)Jd(Zd);const $d=Se("STORE_AD_CONFIG"),ec=Se("STORE_UPDATE_AD_INFO"),tc=Se("STORE_PUT_AD_INFO"),rc=Se("STORE_PUT_IS_ORIGINAL_BROADCAST_AD_CUE_ID"),ic=Se("STORE_PUT_ADBLOCK_DETECTED"),nc=Se("STORE_PUT_ORIGINAL_BROADCAST_AD_CUES"),oc=Se("STORE_REFRESH_CUE"),ac=Se("STORE_REMOVE_CUE"),sc=Se("STORE_PUT_HAS_PREROLL"),lc=Se("STORE_PUT_AD_SYNC_INIT"),dc=Se("STORE_UPDATE_ORIGINAL_AD_STATE"),cc=Se("STORE_PUT_NATIVE_AD_CONTROLS_VISIBILITY"),uc=Se("STORE_PUT_LAST_KNOWN_BANDWIDTH_ESTIMATE"),hc=Se("STORE_AD_PUT_IN_STREAM_PLAYING_STATE"),pc=Se("STORE_PUT_NEXT_AD_INFO"),fc=Se("STORE_PUT_ENGINE"),vc=Se("STORE_PUT_AUTOPLAY"),gc=Se("STORE_PUT_START_STAGE"),mc=Se("STORE_PUT_PRELOAD"),Ec=Se("STORE_PUT_ENCODER_STATE"),Ac=Se("STORE_ENCODER_ATTACHED"),yc=Se("STORE_PUT_VOLUME_INFO"),Tc=Se("STORE_PUT_AUTOPLAY_IMPOSSIBLE"),Sc=Se("STORE_PUT_USER_VOLUME"),Rc=Se("STORE_PUT_DURATION"),_c=Se("STORE_PUT_VIDEO_SIZES"),Pc=Se("STORE_PUT_VIDEO_TYPE"),Ic=Se("STORE_PUT_PLAYING_STATE"),bc=Se("STORE_PUT_CURRENT_TIME"),Cc=Se("STORE_PUT_CURRENT_TIME_LOW_QUALITY"),Oc=Se("STORE_PUT_FROM"),wc=Se("STORE_PUT_STREAM"),kc=Se("STORE_PUT_SOURCE_PARAMS"),Dc=Se("STORE_UPDATE_SOURCE_ID"),Nc=Se("STORE_PUT_STREAMS"),Lc=Se("STORE_PUT_STREAMS_WITH_SUPPORT_INFO"),Mc=Se("STORE_PUT_START_POSITION"),Vc=Se("STORE_PUT_IS_ONLINE"),xc=Se("STORE_PUT_FRAGMENT_DURATION"),Fc=Se("STORE_PUT_PROGRAM_DATE_TIME"),Uc=Se("STORE_PUT_DVR_START_TIME"),Bc=Se("STORE_PUT_DVR_DURATION"),Hc=Se("STORE_PUT_SKIN_DVR_START_TIME"),Gc=Se("STORE_PUT_SKIN_DVR_DURATION"),Wc=Se("STORE_PUT_PLAYBACK_RATE"),Yc=Se("STORE_PUT_BUFFERING_RANGES"),jc=Se("STORE_PUT_ERROR_INFO"),Kc=Se("STORE_PUT_LAST_RECOVER_POSITION"),qc=Se("STORE_PUT_IS_ABR_SUPPORTED"),Xc=Se("STORE_PUT_IS_ABR_ENABLED"),zc=Se("STORE_PUT_VIDEO_TRACK"),Qc=Se("STORE_PUT_VIDEO_TRACKS",e=>[...e].sort(be)),Jc=Se("STORE_PUT_USER_VIDEO_TRACK_PARAMS"),Zc=Se("STORE_PUT_AUDIO_TRACK_VALUE"),$c=Se("STORE_PUT_AUDIO_TRACKS"),eu=Se("STORE_PUT_USER_AUDIO_TRACK_PARAMS"),tu=Se("STORE_PUT_TEXT_TRACKS"),ru=Se("STORE_PUT_TEXT_TRACK_ENABLED"),iu=Se("STORE_PUT_NATIVE_TEXT_TRACK_VISIBILITY"),nu=Se("STORE_PUT_FEED"),ou=Se("STORE_PUT_TEXT_TRACK_VALUE"),au=Se("STORE_PUT_USER_TEXT_TRACK_PARAMS"),su=Se("ENABLE_TEXT_TRACK"),lu=Se("STORE_PUT_IS_FULLSCREEN"),du=Se("STORE_PUT_IS_PIP"),cu=Se("STORE_PUT_IS_VISIBLE"),uu=Se("STORE_PUT_IS_DOCUMENT_VISIBLE"),hu=Se("STORE_PUT_PREVIEW"),pu=Se("STORE_PUT_WATCHED_TIME"),fu=Se("STORE_PUT_RESOURCES_IDLE"),vu=Se("STORE_PUT_HIDDEN_CONTROLS"),gu=Se("STORE_PUT_NATIVE_CONTROLS_VISIBILITY"),mu=Se("STORE_PUT_VIDEO_ELEMENT_STYLE"),Eu=Se("STORE_ON_VIDEO_TAG_PLAYING_STATE_CHANGE"),Au=Se("STORE_PUT_PRELOAD_DETAILS"),yu=Ll(900);let Tu;!function(e){e.original="original"}(Tu||(Tu={}));class Su{constructor(e,t){this.parent=e,this.element=document.createElement("div");const{style:r}=this.element;r.backgroundColor=function(e){switch(e){case Tu.original:return"rgba(0, 255, 0, 0.5)";default:throw new Error("Unexpected BroadcastAdType ["+e+"]")}}(t),r.width="10px",r.height="10px",r.cssFloat="left",r.marginRight="1px"}setVisibility(e){e?this.show():this.hide()}show(){this.parent.appendChild(this.element)}hide(){b(this.element)}}class Ru{constructor(e){this.element=document.createElement("div"),e.appendChild(this.element);const{style:t}=this.element;t.position="absolute",t.bottom="1px",t.left="1px"}createIndicator(e){return new Su(this.element,e)}}const _u=Nl(1e3),Pu=Nl(6e5);let Iu;!function(e){e.INVALID_INROLL_FRAME="INVALID_INROLL_FRAME",e.INVALID_START="INVALID_START",e.CROSSED_BY_INVALID="CROSSED_BY_INVALID",e.MAX_DURATION="MAX_DURATION"}(Iu||(Iu={}));const bu=Nl(5e3),Cu=Nl(1e4),Ou=xl(Pu,Ul(Cu,3)),wu=Nl(-Pu);class ku extends Ad{constructor(){super(...arguments),this.adIntervals=[]}handleInrollFrame(e){if(!function(e){if(e.offset<wu||e.offset>Ou)return!1;if(void 0===e.cutoff)return!0;if(e.cutoff<wu||e.cutoff>Ou)return!1;const t=e.cutoff-e.offset;return t>=bu&&t<=Pu}(e))return Ld.warn("invalid inroll frame:",e),void this.handleInvalidInrollFrame(e,Iu.INVALID_INROLL_FRAME);const t=this.adIntervals.find(t=>{let{cueId:r}=t;return r===e.cue_id});if(!t)return this.addAdIntervalByFastFrame(e);this.updateAdIntervalByInrollFrame(t,e)}validateAdIntervalsByTimestamp(e){for(let t=0;t<this.adIntervals.length;t++){const r=this.adIntervals[t];if(r.start>e)return;if(!r.isValid||r.isEndReceived)continue;if(e-r.start>Pu){this.invalidateAdInterval(r,Iu.MAX_DURATION);continue}const i=this.adIntervals[t+1];if(!i)return;i.start<=e&&this.invalidateAdInterval(r,Iu.CROSSED_BY_INVALID)}}handleInvalidInrollFrame(e,t){const r=this.adIntervals.find(t=>{let{cueId:r}=t;return r===e.cue_id});if(r)return this.invalidateAdInterval(r,t),void this.updateAdIntervalByInrollFrame(r,e);const i=Ne(e);this.invalidateAdInterval(i,t),this.pushAdInterval(i)}addAdIntervalByFastFrame(e){const t=Ne(e);return this.pushAdInterval(t),t.isValid?t:void 0}updateAdIntervalByInrollFrame(e,t){const r=t.pts+t.offset;if(Math.abs(e.start-r)>_u)return void this.invalidateAdInterval(e,Iu.INVALID_START);if(e.isEndReceived)return;const i=void 0!==t.cutoff,n=i?xl(t.pts,t.cutoff):De(t.pts,e.start);e.isEndReceived=i,e.end=n,this.handleUpdatedAdInterval(e)}findCrossedAdIntervals(e){return this.adIntervals.filter(t=>e!==t&&(e.start<t.start?e.end>t.start:t.end>e.start))}pushAdInterval(e){const t=this.findCrossedAdIntervals(e);t.length&&this.invalidateAdInterval(e,Iu.CROSSED_BY_INVALID),this.adIntervals.push(e),this.adIntervals.sort((e,t)=>{let{start:r}=e,{start:i}=t;return r-i}),this.invalidate(t,Iu.CROSSED_BY_INVALID),e.isValid&&this.emit("AdIntervalUpdated",e)}handleUpdatedAdInterval(e){const t=this.findCrossedAdIntervals(e);if(t.length)return t.push(e),void this.invalidate(t,Iu.CROSSED_BY_INVALID);e.isValid&&this.emit("AdIntervalUpdated",e)}invalidate(e,t){e.forEach(e=>{this.invalidateAdInterval(e,t)})}invalidateAdInterval(e,t){e.isValid&&(e.isValid=!1,e.invalidateReason=t,this.emit("InvalidAdInterval",{reason:t,cueId:e.cueId}))}}const Du=Ll(15);class Nu{constructor(){this.ads=[],this.postAdsIds=[]}add(e){if(this.postAdsIds.indexOf(e.cueId)>-1)return;const t=this.findById(e.cueId);t?t.startTime=e.startTime:this.ads.push(Me({},e,{adViewers:e.adViewers.reduce((e,t)=>e.concat(t.separateAdPods()),[])}))}getAdViewers(e,t){const[r,i]=Le(this.ads,r=>{let{startTime:i,endTime:n,cueId:o,adViewers:a}=r;if(o!==t)return!1;if(e<i)return!1;if(n-1e3*Du<e)return!1;for(const t of a){if(e+1e3*t.getAdDuration()<n)return!0}return!1});if(0===r.length)return[];this.postAdsIds.push(...r.map(e=>{let{cueId:t}=e;return t})),this.ads=i,r.sort((e,t)=>e.startTime-t.startTime);let n=Ll(0);const o=[];for(const{adViewers:a,endTime:s,cueId:l}of r)for(const t of a){const r=xl(e,Ul(n,1e3));if(s-1e3*Du<r)break;s<xl(r,Ul(t.getAdDuration(),1e3))||(o.push({adViewer:t,additionalData:{cueId:l},adType:wd.inroll}),n=xl(n,Ll(t.getAdDuration())))}return o}findById(e){return this.ads.find(t=>{let{cueId:r}=t;return r===e})}}class Lu extends Ad{constructor(e,t,r,i,n){let o;super(),this.store=r,this.playerApi=i,this.onError=n,this.adIntervalStorage=new ku,this.isEnabled=!0,this.adIndicators=void 0,this.inrolls=new Nu,this.adIndicators=new Ru(t);const a=this.adIndicators.createIndicator(Tu.original);e.addEventListener("timeupdate",()=>{const t=this.store.getState(),r=we(t);if(o!==r){const e=void 0!==r;a.setVisibility(e),o=r}const i=ke(t);i&&(this.adIntervalStorage.validateAdIntervalsByTimestamp(i),this.isEnabled&&!e.paused&&(this.store.dispatch(dc()),this.handleInrolls()))}),this.adIntervalStorage.on("AdIntervalUpdated",e=>{this.emit("AdIntervalUpdated",{cueId:e.cueId,start:e.start,end:e.end})}),this.adIntervalStorage.on("InvalidAdInterval",e=>{let{cueId:t,reason:r}=e;Ld.warn("invalid ad interval: [cueId="+t+"] [reason="+r+"]"),this.onError(new Cd({code:ps.INVALID_METADATA,details:{cueId:t,reason:r},isFatal:!1})),this.emit("AdIntervalRemoved",t)})}handleInrollFrame(e){const t=this.adIntervalStorage.handleInrollFrame(e);if(!t)return Promise.resolve();const{cueId:r,start:i,end:n,isEndReceived:o}=t,a=o?n+1e3*Du:i+Pu;return this.addInroll(r,i,Nl(a),{inrollFrame:e})}setEnabled(e){this.isEnabled=e}async addInroll(e,t,r,i){let{inrollFrame:n}=i;this.playerApi.callbacks.logEvent({event:Od.BroadcastAdReceived,params:{cueId:e,podStart:t,adType:wd.inroll}});const o=this.playerApi.getMultiroll(),a=await o.inroll.loadViewers(xe({},n));if(0===a.length)return;const s=Ve(a);this.playerApi.callbacks.logEvent({event:Od.BroadcastAdInit,params:{cueId:e,podStart:t,duration:s,adPodsCount:a.length,adType:wd.inroll}}),this.inrolls.add({adViewers:a,cueId:e,startTime:t,endTime:r})}handleInrolls(){const e=this.store.getState(),t=ke(e);if(!t)return;const r=we(e);if(!r)return;const i=this.inrolls.getAdViewers(t,r);i.length&&this.emit("InrollAdPlayRequest",i)}}class Mu{constructor(){this.stopReasonInternal=void 0,this.stopDeferred=new ad}stop(e){this.stopReasonInternal=e,this.stopDeferred.resolve(e)}get stopReason(){return this.stopReasonInternal}get stopPromise(){return this.stopDeferred.promise}}const Vu="utf-8",xu=e=>!0,Fu=200;var Uu=e(4957),Bu=function(){return Math.random().toString(36).substring(7).split("").join(".")},Hu={INIT:"@@redux/INIT"+Bu(),REPLACE:"@@redux/REPLACE"+Bu(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Bu()}};var Gu=function(e){return"@@redux-saga/"+e},Wu=Gu("CANCEL_PROMISE"),Yu=Gu("CHANNEL_END"),ju=Gu("IO"),Ku=Gu("MATCH"),qu=Gu("MULTICAST"),Xu=Gu("SAGA_ACTION"),zu=Gu("SELF_CANCELLATION"),Qu=Gu("TASK"),Ju=Gu("TASK_CANCEL"),Zu=Gu("TERMINATE"),$u=Gu("LOCATION"),eh=function(e){return null===e||void 0===e},th=function(e){return null!==e&&void 0!==e},rh=function(e){return"function"===typeof e},ih=function(e){return"string"===typeof e},nh=Array.isArray,oh=function(e){return e&&rh(e.then)},ah=function(e){return e&&rh(e.next)&&rh(e.throw)},sh=function e(t){return t&&(ih(t)||ch(t)||rh(t)||nh(t)&&t.every(e))},lh=function(e){return e&&rh(e.take)&&rh(e.close)},dh=function(e){return rh(e)&&e.hasOwnProperty("toString")},ch=function(e){return Boolean(e)&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype};const uh=function(e,t){var r;void 0===t&&(t=!0);var i=new Promise((function(i){r=setTimeout(i,e,t)}));return i[Wu]=function(){clearTimeout(r)},i};var hh=function(e){return function(){return e}}(!0),ph=function(){};var fh=function(e){return e},vh=("function"===typeof Symbol&&Symbol.asyncIterator&&Symbol.asyncIterator,function(e,t){it(e,t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach((function(r){e[r]=t[r]}))}),gh=function(e){throw e},mh=function(e){return{value:e,done:!0}},Eh=function(e){return Array.apply(null,new Array(e))},Ah=function(e){return function(t){return e(Object.defineProperty(t,Xu,{value:!0}))}},yh=function(e){return e===Zu},Th=function(e){return e===Ju},Sh=function(e){return yh(e)||Th(e)},Rh=function(e){return ct(e,4)},_h=function(e,t){var r;return(r={})[ju]=!0,r.combinator=!1,r.type=e,r.payload=t,r},Ph=vt.bind(null,uh);const Ih=yt;var bh,Ch=[],Oh=0,wh=function(e){return function(t){return e.some((function(e){return bt(e)(t)}))}},kh=function(e){return function(t){return e(t)}},Dh=function(e){return function(t){return t.type===String(e)}},Nh=function(e){return function(t){return t.type===e}},Lh=function(){return hh},Mh={type:Yu},Vh=function(e){return e&&e.type===Yu},xh=0,Fh=function(){return++xh},Uh=((bh={}).TAKE=function(e,t,r){var i=t.channel,n=void 0===i?e.channel:i,o=t.pattern,a=t.maybe,s=function(e){e instanceof Error?r(e,!0):!Vh(e)||a?r(e):r(Zu)};try{n.take(s,th(o)?bt(o):null)}catch(l){return void r(l,!0)}r.cancel=s.cancel},bh.PUT=function(e,t,r){var i=t.channel,n=t.action,o=t.resolve;St((function(){var t;try{t=(i?i.put:e.dispatch)(n)}catch(YE){return void r(YE,!0)}o&&oh(t)?wt(t,r):r(t)}))},bh.ALL=function(e,t,r,i){var n=i.digestEffect,o=xh,a=Object.keys(t);if(0!==a.length){var s=st(t,r);a.forEach((function(e){n(t[e],o,s[e],e)}))}else r(nh(t)?[]:{})},bh.RACE=function(e,t,r,i){var n=i.digestEffect,o=xh,a=Object.keys(t),s=nh(t)?Eh(a.length):{},l={},d=!1;a.forEach((function(e){var t=function(t,i){d||(i||Sh(t)?(r.cancel(),r(t,i)):(r.cancel(),d=!0,s[e]=t,r(s)))};t.cancel=ph,l[e]=t})),r.cancel=function(){d||(d=!0,a.forEach((function(e){return l[e].cancel()})))},a.forEach((function(e){d||n(t[e],o,l[e],e)}))},bh.CALL=function(e,t,r,i){var n=t.context,o=t.fn,a=t.args,s=i.task;try{var l=o.apply(n,a);if(oh(l))return void wt(l,r);if(ah(l))return void Vt(e,l,s.context,xh,lt(o),!1,r);r(l)}catch(YE){r(YE,!0)}},bh.CPS=function(e,t,r){var i=t.context,n=t.fn,o=t.args;try{var a=function(e,t){eh(e)?r(t):r(e,!0)};n.apply(i,o.concat(a)),a.cancel&&(r.cancel=a.cancel)}catch(YE){r(YE,!0)}},bh.FORK=function(e,t,r,i){var n=t.context,o=t.fn,a=t.args,s=t.detached,l=i.task,d=function(e){var t=e.context,r=e.fn,i=e.args;try{var n=r.apply(t,i);if(ah(n))return n;var o=!1;return ot((function(e){return o?{value:e,done:!0}:(o=!0,{value:n,done:!oh(n)})}))}catch(a){return ot((function(){throw a}))}}({context:n,fn:o,args:a}),c=function(e,t){return e.isSagaIterator?{name:e.meta.name}:lt(t)}(d,o);Rt((function(){var t=Vt(e,d,l.context,xh,c,s,void 0);s?r(t):t.isRunning()?(l.queue.addTask(t),r(t)):t.isAborted()?l.queue.abort(t.error()):r(t)}))},bh.JOIN=function(e,t,r,i){var n=i.task,o=function(e,t){if(e.isRunning()){var r={task:n,cb:t};t.cancel=function(){e.isRunning()&&nt(e.joiners,r)},e.joiners.push(r)}else e.isAborted()?t(e.error(),!0):t(e.result())};if(nh(t)){if(0===t.length)return void r([]);var a=st(t,r);t.forEach((function(e,t){o(e,a[t])}))}else o(t,r)},bh.CANCEL=function(e,t,r,i){var n=i.task;t===zu?kt(n):nh(t)?t.forEach(kt):kt(t),r()},bh.SELECT=function(e,t,r){var i=t.selector,n=t.args;try{r(i.apply(void 0,[e.getState()].concat(n)))}catch(YE){r(YE,!0)}},bh.ACTION_CHANNEL=function(e,t,r){var i=t.pattern,n=Ct(t.buffer),o=bt(i),a=function t(r){Vh(r)||e.channel.take(t,o),n.put(r)},s=n.close;n.close=function(){a.cancel(),s()},e.channel.take(a,o),r(n)},bh.CANCELLED=function(e,t,r,i){r(i.task.isCancelled())},bh.FLUSH=function(e,t,r){t.flush(r)},bh.GET_CONTEXT=function(e,t,r,i){r(i.task.context[t])},bh.SET_CONTEXT=function(e,t,r,i){var n=i.task;vh(n.context,t),r()},bh),Bh=null,Hh=[],Gh=function(e){e.crashedEffect=Bh,Hh.push(e)},Wh=function(){Bh=null,Hh.length=0},Yh=function(){var e=Hh[0],t=Hh.slice(1),r=e.crashedEffect?function(e){var t=dt(e);return t?t.code+"  "+Dt(t.fileName,t.lineNumber):""}(e.crashedEffect):null;return["The above error occurred in task "+Nt(e.meta)+(r?" \n when executing effect "+r:"")].concat(t.map((function(e){return"    created by "+Nt(e.meta)})),[Lt(Hh)]).join("\n")};const jh=function(e){function t(e){var t=e.getState,i=e.dispatch;return r=xt.bind(null,it({},d,{context:o,channel:s,dispatch:i,getState:t,sagaMonitor:l})),function(e){return function(t){l&&l.actionDispatched&&l.actionDispatched(t);var r=e(t);return s.put(t),r}}}var r,i=void 0===e?{}:e,n=i.context,o=void 0===n?{}:n,a=i.channel,s=void 0===a?Ot():a,l=i.sagaMonitor,d=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(i,["context","channel","sagaMonitor"]);return t.run=function(){return r.apply(void 0,arguments)},t.setContext=function(e){vh(o,e)},t};var Kh=function(e){return{done:!0,value:e}},qh={};const Xh=Se("PING_STRM_AND_RECOVER_BY_ONLINE"),zh={inStreamPlayingState:void 0,adConfig:void 0,adInfo:void 0,originalBroadcastAdCueId:void 0,originalBroadcastAdCues:{},adblockDetected:!1,hasPreroll:!1,adSyncInit:!1,nextAdInfo:void 0,nativeAdControlsVisibility:!0},Qh=Ml(Ll(Math.max(0,0))),Jh=V(Ll(5)),Zh="0000000000000000000000000000000000000000000000000000000000000000";let $h,ep;!function(e){e.init="init",e.waitForUserPlay="waitForUserPlay",e.waitForDocumentVisibility="waitForDocumentVisibility",e.starting="starting",e.started="started",e.broken="broken",e.destroyed="destroyed"}($h||($h={})),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(ep||(ep={}));const tp={autoplay:!1,initialAutoplay:!1,allowMuted:!0,autoplayImpossible:!1,startStage:$h.init,preload:!0,from:void 0,encoderState:ep.Detached,vsid:Zh,streams:[],stream:void 0,sourceParams:void 0,sourceId:0,volume:1,muted:!1,userVolume:NaN,duration:Ll(NaN),currentTime:Qh,currentTimeLowGranularity:Qh,watchedTime:Ll(0),startPosition:{},programDateTime:void 0,fragmentDuration:Jh,dvrStartTime:Ll(0),dvrDuration:Ll(NaN),videoType:void 0,playingState:Ql.PAUSE,bufferingRanges:[],preview:od,isFullscreen:!1,isPip:!1,isVisible:void 0,togglePlaybackOnVisibilityChangeSetting:void 0,errorInfo:{},lastRecoverPosition:void 0,isOnline:!0,isDocumentVisible:!0,lastKnownBandwidthEstimate:{value:wl(NaN),source:"default"},isAbrSupported:!1,isAbrEnabled:!1,defaultQuality:void 0,feed:!1,videoTrackValue:void 0,videoTracks:[],userVideoTrackName:void 0,userVideoTrackHeight:void 0,audioTrackValue:void 0,audioTracks:[],userAudioTrackName:void 0,userAudioTrackLang:void 0,textTrackEnabled:!1,nativeTextTrackVisible:void 0,textTrackValue:void 0,textTracks:[],userTextTrackEnabled:void 0,userTextTrackLang:void 0,userTextTrackName:void 0,playbackRate:1,expectedStalled:qt(kd.Init,void 0),videoWidth:Vl(0),videoHeight:Vl(0),playerConfig:void 0,preloadDetails:void 0};let rp;!function(e){e.LIVE="LIVE",e.EVENT="EVENT",e.VOD="VOD"}(rp||(rp={}));const ip=function(e,t){let r=e[t];if(!p(r)){const n=r;try{delete e[t],r=e[t],e[t]=n}catch(i){}}return r}(Object,"create")?Object.create:function(e,t){function r(){}if(r.prototype=e,d(t))for(const i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return new r},np=e=>e instanceof Date||"Date"===ss(e),op=function e(t,r){void 0===r&&(r={preserveConstructors:!0});let i=t;if(cl(t)){return t.map(t=>e(t,r))}return np(t)?new Date(t.getTime()):(!n(t)&&d(t)&&(i=r.preserveConstructors?ip(t):{},y(t,(t,n)=>{i[n]=e(t,r)})),i)};let ap,sp;!function(e){e[e.PLAYING=1]="PLAYING",e[e.NOT_PLAYING=2]="NOT_PLAYING"}(ap||(ap={})),function(e){e.INIT="INIT",e.SET_SOURCE="SET_SOURCE"}(sp||(sp={}));const lp=Nl(5e3),{config:dp}=e(3012),cp=["strm.yandex.net","strm.yandex.ru","strm-ott.akamaized.net","media.strm.yandex.net","cdn.ngenix.net","streaming.tst.strm.yandex.net",dp.strmApi],up=Ll(300);let hp=Ll(0);const pp=Nl(2e3),fp=document.createElement("a"),vp={},{config:gp}=e(3012),mp=e=>e===gp.strmApi?"pingx":"ping",Ep=Nl(1e3),Ap={reason:"recoverStreamByReturnToOnline",delay:0,rawData:0},yp=Ll(10),Tp=id(),Sp=Tp?.25:.02,Rp=[wd.midroll,wd.postroll,wd.preroll];let _p,Pp;const Ip=["ewma","hlsjs","yabro"];let bp;!function(e){e.OK="OK",e.SLOW="SLOW",e.UNKNOWN="UNKNOWN"}(bp||(bp={}));const Cp=["ts","m4s","m4f"],Op=e=>{let{fragDuration:t,downloadTime:r}=e;return r>.9*t},wp=e=>{let{fragDuration:t,timings:r}=e;const i=r.filter(e=>{const{name:t,duration:r,encodedBodySize:i,decodedBodySize:n,transferSize:o}=e;if(void 0===t||void 0===r)return!1;const a=Number(i||n||o);return!(isNaN(a)||a<1024)&&-1!==Cp.indexOf($(t).toLowerCase())}).slice(-5).map(e=>{let{duration:t}=e;return Nl(t)});if(0===i.length)return bp.UNKNOWN;const n=(a=.33,0===(o=i).length?Nl(0):o.reduce((e,t)=>xl(Ul(e,a),Ul(t,1-a)),o[0]));var o,a;return Op({fragDuration:t,downloadTime:n})?bp.SLOW:bp.OK},{config:kp}=e(3012),Dp="."+kp.strmApi,Np=Ll(1);var Lp=e(6394),Mp=e(6048),Vp=e.n(Mp);const xp=Nl(15e3),Fp=Se("SKIN_PUT_USE_NATIVE_SUBTITLES");var Up=e(5264);const Bp={hiddenControls:[],useNativeSubtitles:!1,nativeControlsVisibility:!0,skinDVRStartTime:Ll(0),skinDVRDuration:Ll(0)},Hp={min:0,max:1/0},Gp={min:1,max:1/0},Wp={min:0,max:1};let Yp;!function(e){e.ApiPlay="ApiPlay",e.VolumeChange="VolumeChange",e.MuteChange="MuteChange"}(Yp||(Yp={}));const jp="other",Kp={from:jp,reqid:void 0,hash:void 0,vsid:Zh},qp={startPosition:{},additionalParams:Kp,adConfig:void 0,withCredentials:!1,loop:!1,preview:"",videoInfo:{}},Xp=Nl(500),zp=kl(-1),Qp={name:(Jp="TRACK_AUTO",{TRACK_AUTO:"\u0410\u0432\u0442\u043e"}[Jp]),value:"auto",bitrate:zp};var Jp;let Zp;!function(e){e.VideoIsNotPausedOnInit="VideoIsNotPausedOnInit",e.DetectByInterval="DetectByInterval",e.VideoPlayEvent="VideoPlayEvent",e.PlayCallback="PlayCallback"}(Zp||(Zp={}));let $p,ef,tf,rf,nf;!function(e){e.Internal="internal",e.Api="api",e.Cache="cache"}($p||($p={})),function(e){e.ON="ON",e.OFF="OFF"}(ef||(ef={})),function(e){e.setSource="setSource",e.destroy="destroy",e.end="end"}(tf||(tf={})),function(e){e.NATIVE="NATIVE",e.HLS="HLS",e.MPD="MPD",e.MP4="MP4"}(rf||(rf={})),function(e){e.SetMuted="SetMuted",e.SetVolume="SetVolume",e.RequestAutoplaySettings="RequestAutoplaySettings",e.VolumeChangeEvent="VolumeChangeEvent",e.RestoreSavedMuted="RestoreSavedMuted"}(nf||(nf={}));const of=(e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r],r,e))return!0;return!1},af=function(e){void 0===e&&(e=window);const t=e.navigator.userAgent,r=t.indexOf("Android");return-1===r?-1:parseFloat(t.slice(r+8))}(),sf=ns?function(e,t){return void 0===t&&(t=is),Boolean(t.canPlayType(e).replace(/no/,""))}:()=>!1,lf=sf("application/vnd.apple.mpegurl")||af>=4.4;let df;!function(e){e.NO_MSE="NO_MSE",e.NO_CODECS="NO_CODECS",e.NO_SUPPORTED_DRM="NO_SUPPORTED_DRM",e.NO_SUPPORTED_FORMAT="NO_SUPPORTED_FORMAT",e.INVALID_STREAM_URL="INVALID_STREAM_URL"}(df||(df={}));const cf={supported:!1,noSupportReason:df.NO_MSE},uf={supported:!1,noSupportReason:df.NO_CODECS},hf={supported:!1,noSupportReason:df.NO_SUPPORTED_DRM},pf={supported:!1,noSupportReason:df.NO_SUPPORTED_FORMAT},ff={supported:!1,noSupportReason:df.INVALID_STREAM_URL};const vf=["yandex.ru","yandex.net","yastatic.net","yandex-team.ru","kinopoisk.ru","strm-ott.akamaized.net",e(3012).config.strmApi],gf=function(e){void 0===e&&(e=window);const t=e.MediaSource||e.WebKitMediaSource;return t&&n(t.isTypeSupported)&&!function(e){void 0===e&&(e=window);const t=e.SourceBuffer||e.WebKitSourceBuffer;return!!t&&!(t.prototype&&n(t.prototype.appendBuffer)&&n(t.prototype.remove))}(e)?t:void 0}();var mf=e(2741);const Ef={getItem(e){try{return mf.ZP.getItem(e)}catch(t){return null}},setItem(e,t){try{mf.ZP.setItem(e,t)}catch(r){}},removeItem(e){try{mf.ZP.removeItem(e)}catch(t){}},clear(){try{mf.ZP.clear()}catch(e){}}},Af=function(e){return void 0===e&&(e=window),/YaBrowser/.test(o(e))},yf=Af(),Tf=Nl(2592e5),Sf=G(()=>{if(void 0===gf)return Promise.reject(new Error("MSE is not supported"));if(function(){if(!yf)return!1;try{return void 0!==window.top.WEB_NTP_VERSION}catch(e){return!1}}())return Promise.resolve(gf);if(function(){try{const e=Ef.getItem("videoplayer-supported-mse");if(null===e)return;const{value:t,time:r,version:i}=JSON.parse(e);if(Date.now()-r>Tf)return void Ef.removeItem("videoplayer-supported-mse");if("1"!==i)return;return t||void 0}catch(e){return}}())return Promise.resolve(gf);const e=document.createElement("video"),t=new gf,r=URL.createObjectURL(t);let i,n;const o=new Promise((o,a)=>{i=()=>{o(gf);try{Ef.setItem("videoplayer-supported-mse",JSON.stringify({value:!0,time:Date.now(),version:"1"}))}catch(e){}},n=()=>a(new Error("MSE is not supported")),t.addEventListener("sourceopen",i),e.addEventListener("error",n),e.addEventListener("durationchange",n),e.src=r});return o.then(()=>{URL.revokeObjectURL(r),t.removeEventListener("sourceopen",i),e.removeEventListener("error",n),e.removeEventListener("durationchange",n)}),o});t(Sf());const Rf=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase();return/yandexstation.*yandexio/.test(t)||/station.*crosswalk/.test(t)}(),_f={supported:!0,engine:rf.NATIVE},Pf={supported:!0,engine:rf.HLS};let If;const bf=(e,t)=>e===t,Cf=function(e){return void 0===e&&(e=window),/Chrome/.test(e.navigator.userAgent)&&/Google Inc/.test(e.navigator.vendor)&&!Af(e)}(),Of=function(e){return void 0===e&&(e=window),/firefox/.test(e.navigator.userAgent.toLowerCase())}(),wf=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase();return/linux/.test(t)&&!le(e)}();let kf;!function(e){e.fairplay="fairplay",e.playready="playready",e.widevine="widevine"}(kf||(kf={}));const Df="com.apple.fps.1_0",Nf="com.apple.fps.2_0",Lf=function(e){return[].concat.apply([],e)}(Ii({[kf.fairplay]:["com.apple.fairplay",Df,Nf],[kf.widevine]:["com.widevine.alpha"],[kf.playready]:["com.microsoft.playready"]}));let Mf,Vf;!function(e){e.YandexBrowserLinux="YandexBrowserLinux",e.OldYandexBrowser="OldYandexBrowser",e.WebKitMediaKeys="WebKitMediaKeys",e.requestMediaKeySystemAccess="requestMediaKeySystemAccess",e.MSMediaKeys="MSMediaKeys",e.GenerateKeyRequest="GenerateKeyRequest",e.Constant="Constant",e.NotAvailable="NotAvailable",e.LiteMode="LiteMode"}(Mf||(Mf={}));const xf=[],Ff=Nl(2592e5);let Uf;const Bf=G(async e=>{let{video:t}=e;const r=function(){try{const e=Ef.getItem("videoplayer-supported-drm-systems");if(null===e)return;const{value:t,time:r,version:i}=JSON.parse(e);if(Date.now()-r>Ff)return void Ef.removeItem("videoplayer-supported-drm-systems");if("32ab2d5ec83f96b6f1ff9eff27cab505"!==i)return void Ef.removeItem("videoplayer-supported-drm-systems");if(0===t.supportedDrmSystems.length)return;return t}catch(e){return}}(),i=r||await Li({video:t});return xf.forEach(e=>e(i)),xf.length=0,Uf=i,void 0===r&&function(e){if(0!==e.supportedDrmSystems.length)try{Ef.setItem("videoplayer-supported-drm-systems",JSON.stringify({value:e,time:Date.now(),version:"32ab2d5ec83f96b6f1ff9eff27cab505"}))}catch(t){}}(i),i.supportedDrmSystems}),Hf=document.createElement("video"),Gf={supported:!0,engine:rf.MPD};let Wf;const Yf=/Smart.?TV|PlayStation/i.test(navigator.userAgent);class jf{static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent)}static isSafariDesktop(){return Tp&&!ud}static setDeviceType(e){this.deviceType=e}static isSmartTV(){return"SMART_TV"===this.deviceType||Yf}static canPlayHlsOnNative(){return this.isSmartTV()||lf}}jf.deviceType=void 0;const Kf=function(e){if(void 0===e&&(e=window),Tp&&e.navigator&&e.navigator.userAgent){const t=e.navigator.userAgent.match(/version\/(\d+)/i);if(t){const e=Number(t[1]);if(e)return e}}return-1}(),qf=function(e){return void 0===e&&(e=window),ie(e)&&o(e).toLowerCase().indexOf("iphone")>-1}(),Xf=function(e){void 0===e&&(e=window);const t=e.navigator.userAgent.toLowerCase();return/ipad/.test(t)&&ie(e)}(),zf={destroy:ne,setStatsRootFields:ne,dispatchEvent:ne,getNextAdInfo:()=>{},preroll:{loadViewers:()=>Promise.resolve([])},midroll:{loadViewers:()=>Promise.resolve([])},inroll:{loadViewers:()=>Promise.resolve([]),schedule:ne},postroll:{loadViewers:()=>Promise.resolve([])},postPauseroll:{loadViewers:()=>Promise.resolve([])}};class Qf extends Ad{constructor(){super(),this.once("Destroy",g(window,"online",()=>{this.emit("Online")})),this.once("Destroy",g(window,"offline",()=>{this.emit("Offline")}))}destroy(){this.emit("Destroy")}}const Jf={setItem(e,t){try{sessionStorage.setItem(e,t)}catch(r){}},getItem(e){try{return sessionStorage.getItem(e)}catch(t){return null}},removeItem(e){try{sessionStorage.removeItem(e)}catch(t){}}};class Zf{constructor(){this.videoContentId=void 0,this.lastProgress=void 0}setVideoContentId(e){this.lastProgress=void 0,this.videoContentId=e}clearVideoContentId(){this.lastProgress=void 0,this.videoContentId=void 0}getProgress(){if(!this.videoContentId)return;const e=Ji(this.videoContentId);return W(e)?Ll(e):void 0}saveProgress(e){this.videoContentId&&("number"===typeof this.lastProgress&&Math.abs(this.lastProgress-e)<1||(this.lastProgress=e,Zi(this.videoContentId,e)))}}const $f=G(()=>{try{return"keepalive"in new Request("")}catch(e){return!1}}),ev=()=>Ee("web_gogol_fetch_keepalive")?async function(){if("boolean"===typeof navigator.onLine&&!navigator.onLine)return new Promise(e=>{const t=()=>{window.removeEventListener("online",t),e()};window.addEventListener("online",t)})}():void 0,tv=new RegExp("^https?:\\/\\/([^\\/]+\\.)?("+["strm-ott\\.akamaized\\.net","akamai\\.strm\\.yandex\\.net","(an|strm)\\.yandex\\.(ru|net)","cdn\\.ngenix\\.net","strm\\.yandex\\.cdnga\\.net","strm-yandex\\.gcdn\\.co","(widevine|playready|fairplay)-proxy\\.ott\\.yandex\\.ru","cdn\\.dzeninfra\\.ru ","cdn\\.dzen\\.ru "].join("|")+")\\/(?!log|perf|jstracer|ping)"),{config:rv}=e(3012),iv={perfLogUrl:"https://"+rv.gogolApi+"/perf",updateInterval:Nl(3e4),urlRegexp:tv};class nv{static clearResourceTimings(){"function"===typeof performance.clearResourceTimings?performance.clearResourceTimings():"function"===typeof performance.webkitClearResourceTimings&&performance.webkitClearResourceTimings()}constructor(e){let{perfLogUrl:t=iv.perfLogUrl,updateInterval:r=iv.updateInterval,urlRegexp:i=iv.urlRegexp}=void 0===e?{}:e;this.timeoutId=void 0,this.history=[],this.reportUrl=void 0,this.updateInterval=void 0,this.urlRegexp=void 0,this.reportUrl=t,this.updateInterval=r,this.urlRegexp="string"===typeof i?new RegExp(i):i,nv.isSupported&&this.loop()}destroy(){clearTimeout(this.timeoutId)}async updateInfo(){if(!nv.isSupported)return;const e=this.getCurrentResourcesTimings();if(nv.clearResourceTimings(),0===e.length)return;this.history.push(...e),this.history.length>200&&this.history.splice(0,this.history.length-200);$i({url:J(this.reportUrl,{perfnow:String(Date.now()),navstart:String(void 0!==performance.timeOrigin?performance.timeOrigin:performance.timing.navigationStart)},{saveOriginalPath:!0}),data:JSON.stringify(e)})}getCurrentResourcesTimings(){if(!nv.isSupported)return[];return performance.getEntriesByType("resource").filter(e=>{let{name:t}=e;return this.urlRegexp.test(t)&&t!==this.reportUrl})}getLastResourcesTimings(){return this.history}getAllResourcesTimings(){return[...this.getLastResourcesTimings(),...this.getCurrentResourcesTimings()]}loop(){this.updateInterval<=0||(this.timeoutId=window.setTimeout(async()=>{await this.updateInfo(),this.loop()},this.updateInterval))}}nv.isSupported=window.performance&&"function"===typeof window.performance.getEntriesByType&&("function"===typeof performance.clearResourceTimings||"function"===typeof performance.webkitClearResourceTimings);const ov=Ll(5),av=Nl(8e3),sv=Nl(1e4),lv=Nl(1e4),dv={timeout:5e3,baseDelay:100,backoffFactor:1,fuzzFactor:.5},cv={drm:{retryParameters:nn({},dv,{timeout:1e4,maxAttempts:3})},manifest:{availabilityWindowOverride:1/0,retryParameters:nn({},dv,{timeout:av,maxAttempts:5}),dash:{ignoreMinBufferTime:!0,autoCorrectDrift:!1,ignoreEmptyAdaptationSet:!0,targetLatency:5}},streaming:{rebufferingGoal:.3,jumpLargeGaps:!0,retryParameters:nn({},dv,{timeout:lv})}};var uv,hv;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ETHERNET=1]="ETHERNET",e[e.WIFI=2]="WIFI",e[e.CELL_2G=3]="CELL_2G",e[e.CELL_3G=4]="CELL_3G"}(uv||(uv={})),function(e){e.BLUETOOTH="bluetooth",e.CELLULAR="cellular",e.ETHERNET="ethernet",e.MIXED="mixed",e.NONE="none",e.OTHER="other",e.UNKNOWN="unknown",e.WIFI="wifi",e.WIMAX="wimax"}(hv||(hv={}));const pv=wl(1e6),fv=wl(1e5),vv=re()?9e5:864e5;var gv=e(6197);const mv=As(window);class Ev{constructor(e){this.alpha=void 0,this.estimate=0,this.totalWeight=0,this.setHalfLife(e)}sample(e,t){const r=Math.pow(this.alpha,e),i=t*(1-r)+r*this.estimate;isNaN(i)||(this.estimate=i,this.totalWeight+=e)}getEstimate(){const e=1-Math.pow(this.alpha,this.totalWeight);return this.estimate/e}setHalfLife(e){this.alpha=Math.exp(Math.log(.5)/e)}}const Av={fast:2,slow:5},yv={fast:1,slow:2};class Tv{constructor(){this.fast=void 0,this.slow=void 0,this.bytesSampled=0,this.fast=new Ev(Av.fast),this.slow=new Ev(Av.slow)}sample(e,t,r){if(void 0===r&&(r=!1),e<=0||t<(r?2e3:16e3))return;this.setHalfLife(r?yv:Av);let i=8e3*t/e;const n=e/1e3;this.bytesSampled+=t,this.fast.sample(n,i),this.slow.sample(n,i)}getBandwidthEstimate(e){return this.hasGoodEstimate()?{value:this.getCurrentEstimate(),source:"ewma"}:e}hasGoodEstimate(){return this.bytesSampled>=128e3}getCurrentEstimate(){return wl(Math.min(this.fast.getEstimate(),this.slow.getEstimate()))}setHalfLife(e){this.fast.setHalfLife(e.fast),this.slow.setHalfLife(e.slow)}}var Sv;!function(e){e.LOAD_SCRIPT_ERROR="LOAD_SCRIPT_ERROR",e.STATS_SENSOR_NAME_ERROR="STATS_SENSOR_NAME_ERROR",e.STATS_LABEL_KEY_ERROR="STATS_LABEL_KEY_ERROR",e.STATS_LABEL_VALUE_ERROR="STATS_LABEL_VALUE_ERROR"}(Sv||(Sv={}));const Rv=[...["sendReportLog","setSource","preloadSource","requestVideoElementFullscreen","requestDebugInfo","destroy","requestExternalPlay","requestExternalPlayerList","insertInto","play"],...["setVideoTrack","setAudioTrack","setTextTrack","changeAdditionalParams","exitVideoElementFullscreen","setPlaybackRate","setMuted","setVolume","setPictureInPictureAllowed","setVideoStyle","setNativeControlsVisibility","setNativeTextTrackVisibility","logEvent","logError","seek","openReportWindow","playInrollAd","skipAdPod","setNativeAdControlsVisibility","setFeed","pause","on","once","off","publicEmit"],"getState","getReadyState"],_v=window;_v.Ya||(_v.Ya={}),_v.Ya.playerApi||(_v.Ya.playerApi={}),_v.Ya.playerApi.METHODS||(_v.Ya.playerApi.METHODS=Rv);window.Ya.playerApi;const Pv=window.Ya.playerApi,Iv="https://static.dzeninfra.ru/yandex-video-player-iframe-api-bundles/hlsjs/0.12.2-1761-1846-1976_tmp-2080-2095-2146-2171-2-2172-2232_tmp-2427-2498/hls.min.js",bv="https://static.dzeninfra.ru/yandex-video-player-iframe-api-bundles/shaka/2.5.17-yandex-patched-fix-ttml-parsing/shaka-player.compiled.js",Cv=G(()=>shaka.polyfill.installAll());let Ov;const wv=[4320,2880,2160,1440,1080,720,480,360,240,144,0],kv=wv.reduce((e,t)=>(e[t]=t,e),Object.create(null)),Dv=Nl(1e4);class Nv{constructor(){this.previousVariantIndex=void 0,this.lastDowngradedVariantIndex=void 0,this.getTimeSinceDowngrade=()=>1/0}filter(e){if(0===e.length)return e;let t=e.length-1;return this.isDowngrading(t)&&(this.lastDowngradedVariantIndex=t+1,this.getTimeSinceDowngrade=Y()),void 0!==this.lastDowngradedVariantIndex&&this.getTimeSinceDowngrade()<Dv&&(t=this.lastDowngradedVariantIndex-1),this.previousVariantIndex=t,e.slice(0,t+1)}reset(){this.getTimeSinceDowngrade=()=>1/0,this.previousVariantIndex=void 0,this.lastDowngradedVariantIndex=void 0}isDowngrading(e){return void 0!==this.previousVariantIndex&&this.previousVariantIndex>e}}class Lv{constructor(e){this.bandwidthEstimator=new Tv,this.config=void 0,this.enabled=!1,this.originalShakaVariants=[],this.props=void 0,this.startupComplete=!1,this.switchCallback=ne,this.variants=[],this.switchHistoryRule=new Nv,this.props=e}init(e){this.switchCallback=e}configure(e){this.config=e}stop(){this.enabled=!1,this.switchCallback=ne,this.variants=[],this.switchHistoryRule.reset()}getBandwidthEstimate(){const e=this.bandwidthEstimator.getBandwidthEstimate({value:this.config.defaultBandwidthEstimate,source:this.config.defaultBandwidthEstimateSource});return{value:xl(e.value,this.props.bandwidthEstimateOffset),source:e.source}}getMaxCapAllowedVideoTrack(){const{restrictions:e}=this.props.getFilterParams(this.variants),t=this.variants.filter(An);if(0===t.length)return;const r=yn(t,e);return r[r.length-1].video}enable(){this.enabled=!0}disable(){this.enabled=!1}getVariants(){return this.variants}setVariants(e){Vp()(e,this.originalShakaVariants)||(this.originalShakaVariants=e,this.variants=Tn([...e].sort((e,t)=>e.bandwidth-t.bandwidth)),this.switchHistoryRule.reset())}chooseVariant(){const{preloadedVariant:e,restrictions:t}=this.props.getFilterParams(this.variants);if(e)return e;let r=function(e,t,r){if(e.length<=1)return e;let i=0;const n=Math.max(r,1);for(let o=1;o<e.length;o++){const r=e[o],a=e[o+1]||{bandwidth:1/0},s=r.bandwidth/.95*n,l=a.bandwidth/.85*n;t>=s&&t<=l&&(i=o)}return e.slice(0,i+1)}(this.variants,this.getBandwidthEstimate().value,this.props.getPlaybackRate());r=this.switchHistoryRule.filter(r),r=yn(r,t);return mn(r.slice().reverse(),e=>{var t;return(null==e||null==(t=e.audio)?void 0:t.bandwidth)||0})||null}segmentDownloaded(e,t){this.bandwidthEstimator.sample(e,t,this.props.isLowLatencyLive()),this.enabled&&this.suggestStreams()}suggestStreams(){if(!this.startupComplete){if(!this.bandwidthEstimator.hasGoodEstimate())return;this.startupComplete=!0}const e=this.chooseVariant();this.switchCallback(e)}}const Mv={maxWidth:Vl(1/0),maxHeight:Vl(1/0),width:Vl(1/0),height:Vl(1/0)};class Vv{constructor(e){this.props=e}getAbrRestrictions(){if(!this.props.getState().controller.isAbrEnabled)return Mv;const e=this.props.getCapSizes();if(void 0===e)return Mv;const{width:t,height:r,maxHeight:i,maxWidth:n}=e,o=function(e){if(void 0===e)return;const t=e.querySelector('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:capping:maxheight"]');if(!t)return;const r=Vl(parseInt(t.getAttribute("value")||"",10));return r>0?{maxHeight:r}:void 0}(this.props.getManifestXml()),a=null!=o&&o.maxHeight?(null==o?void 0:o.maxHeight)+1:1/0;return{maxWidth:n,maxHeight:Vl(Math.min(...[a,i].filter(W))),height:r,width:t}}}const xv=e=>e.active;class Fv{constructor(e){this.length=e,this.list=[]}push(e){this.list.length>=this.length&&this.list.shift(),this.list.push(e)}getAll(){return this.list}clear(){this.list.length=0}copy(){const e=new Fv(this.length);return e.list=this.list.slice(),e}}const Uv=Ll(30),Bv=Uv/Jh*2*2;class Hv{constructor(){this.initSegments=new Fv(10),this.segments=new Fv(Bv)}set(e,t){const{pathname:r}=K(e),i={pathname:r,response:t};Pn(e)?this.initSegments.push(i):this.segments.push(i)}get(e){const{pathname:t}=K(e),r=Pn(e)?_n(this.initSegments,t):_n(this.segments,t);return void 0===r?void 0:r.response}clear(){this.initSegments.clear(),this.segments.clear()}copy(){const e=new Hv;return e.initSegments=this.initSegments.copy(),e.segments=this.segments.copy(),e}hasCachedData(){return this.initSegments.getAll().length>0||this.segments.getAll().length>0}}class Gv{constructor(){this.serverTimestamp=void 0,this.getElapsedTimeFromServerDate=()=>0}parseServerTime(e,t){if(!e.date&&!e["x-server-time-ms"])return;let r=NaN;if(e["x-server-time-ms"]){r=new Date(parseInt(e["x-server-time-ms"],10)).getTime()}else if(e.date){r=new Date(e.date).getTime()}W(r)&&(this.serverTimestamp=r+t/2,this.getElapsedTimeFromServerDate=Y())}getServerTime(){if(void 0!==this.serverTimestamp)return this.serverTimestamp+this.getElapsedTimeFromServerDate()}}class Wv{constructor(e){let{segmentCache:t,loadedManifest:r}=void 0===e?{segmentCache:void 0,loadedManifest:void 0}:e;this.segmentCache=void 0,this.lastLoadedManifest=void 0,this.useLastLoadedManifest=!0,this.shakaPlayer=void 0,this.networkErrorHandler=void 0,this.networkSuccessHandler=void 0,this.serverTimeEstimator=void 0,this.requestFilters=[],this.strmSession=void 0,this.segmentCache=t||new Hv,this.lastLoadedManifest=r,this.serverTimeEstimator=new Gv}setup(e,t,r){this.shakaPlayer&&(In(this.shakaPlayer),this.useLastLoadedManifest=!0),this.shakaPlayer=e,this.networkSuccessHandler=t,this.networkErrorHandler=r;const i=this.customNetPluginFactory(window.shaka),n=e.getNetworkingEngine();null==n||n.registerScheme("http",i),null==n||n.registerScheme("https",i)}destroy(){this.requestFilters.length=0,this.segmentCache.clear(),this.shakaPlayer&&In(this.shakaPlayer)}hasCachedSegments(){return this.segmentCache.hasCachedData()}hasCachedData(){return this.useLastLoadedManifest&&void 0!==this.lastLoadedManifest||this.hasCachedSegments()}getCurrentVariantTrack(){return Rn(this.shakaPlayer)}copyCachedData(){return{segmentCache:this.segmentCache.copy(),loadedManifest:this.lastLoadedManifest}}getServerTime(){return this.serverTimeEstimator.getServerTime()}registerRequestFilter(e){this.requestFilters.indexOf(e)>-1||this.requestFilters.push(e)}unregisterRequestFilter(e){const t=this.requestFilters.indexOf(e);t<=-1||this.requestFilters.splice(t,1)}cacheResponse(e,t,r,i){switch(r){case e.net.NetworkingEngine.RequestType.MANIFEST:this.lastLoadedManifest=i,this.useLastLoadedManifest=!1;break;case e.net.NetworkingEngine.RequestType.SEGMENT:this.segmentCache.set(t,i)}}getCachedResponse(e,t,r){switch(r){case e.net.NetworkingEngine.RequestType.MANIFEST:const{useLastLoadedManifest:r,lastLoadedManifest:i}=this;return r&&void 0!==i?(this.useLastLoadedManifest=!1,i):void 0;case e.net.NetworkingEngine.RequestType.SEGMENT:const n=this.segmentCache.get(t);return void 0===n?void 0:n;default:return}}customNetPluginFactory(e){return(t,r,i,n)=>{const o=this.getCachedResponse(e,t,i);if(void 0!==o)return o.fromCache=!0,new e.util.AbortableOperation(Promise.resolve(o),ne);switch(this.requestFilters.forEach(e=>{try{e(i,r)}catch(t){}}),i){case e.net.NetworkingEngine.RequestType.MANIFEST:void 0===this.strmSession?t=Gi(t):(r.headers["x-strm-session"]=this.strmSession,r.headers["x-client-timestamp"]=String(Date.now()),t=dr(t,"t"));break;case e.net.NetworkingEngine.RequestType.SEGMENT:t=Gi(r.uris[0]||t)}const a=function(e){return e.net.HttpFetchPlugin.isSupported()?e.net.HttpFetchPlugin:e.net.HttpXHRPlugin}(e),s=pl(),l=a(t,r,i,n);return new e.util.AbortableOperation(l.promise.then(r=>(i===e.net.NetworkingEngine.RequestType.MANIFEST&&(this.strmSession=r.headers["x-strm-session"],this.serverTimeEstimator.parseServerTime(r.headers,pl()-s)),this.cacheResponse(e,t,i,r),this.networkSuccessHandler(i),r)).catch(t=>{throw t&&t.code!==e.util.Error.Code.OPERATION_ABORTED&&this.networkErrorHandler(i,t),t}),()=>l.abort())}}}const Yv=function(e){const t=o(e).match(/Firefox\/([0-9]+)\./);return t&&parseInt(t[1],10)||-1}(window),jv=Ll(.5);class Kv extends _l{constructor(e){super(),this.manifestXml=void 0,this.resolvePromise=ne,this.rejectPromise=ne,this.manifestXmlPromise=void 0;const t=e.getNetworkingEngine(),r=(e,t)=>{const r=Mn(e,t);void 0===this.manifestXml&&void 0!==r&&this.resolvePromise(r),void 0!==r&&(this.manifestXml=r)};null==t||t.registerResponseFilter(r),this.addDestroyHandler(()=>{null==t||t.unregisterResponseFilter(r),this.rejectPromise()}),e.addEventListener("unloading",this.rejectPromise)}getManifestXml(){if(!this.isDestroyed)return this.manifestXml}async waitForManifestXml(){return this.isDestroyed?Promise.reject():void 0!==this.manifestXml?Promise.resolve(this.manifestXml):(this.manifestXmlPromise||(this.manifestXmlPromise=new Promise((e,t)=>{this.resolvePromise=e,this.rejectPromise=t})),this.manifestXmlPromise)}}class qv extends _l{get preloaded(){if(this.isDestroyed)return"none";const e=this.getSource().sourceParams.startPosition.videoTime||Ll(0),{total:t}=Hi(this.getBufferedInfo(),e);return t>=Ll(2)?"full":this.hasCachedSegments()?"partial":this.hasManifest()?"manifest":"none"}}class Xv extends qv{constructor(e){super(),this.props=e,this.preload=G(async()=>{if(await vn(),this.isDestroyed)throw new Error("MpdPreloader was destroyed");const e=new shaka.Player(this.videoElement);this.shakaPlayer=e,this.manifestXmlSpy=new Kv(e);e.getNetworkingEngine().registerRequestFilter((t,r)=>{if(t===shaka.net.NetworkingEngine.RequestType.LICENSE)return new Promise((t,r)=>{e.addEventListener("unloading",r)});r.allowCrossSiteCredentials=this.props.source.sourceParams.withCredentials}),e.configure(this.getInitialShakaConfig()),e.addEventListener("manifestparsed",()=>{const{videoTime:t,utc:r}=this.props.source.sourceParams.startPosition,i=W(t)||W(r);e.isLive()&&!i&&this.destroy()});const r=new Wv;r.setup(e,ne,ne),this.customNetworkingEngine=r;const i=new Promise((t,r)=>{let i=ne;const n=()=>{i(),r(new Error("MpdPreloader: shakaPlayer unloading"))};e.addEventListener("unloading",n);const o=g(this.videoElement,"progress",()=>{const{total:r,audio:n,video:o}=e.getBufferedInfo();if(0===n.length||0===o.length)return;const{start:a,end:s}=r[0]||{},l=s-a,d=this.videoElement.duration;(ov<=xl(l,Ll(.2))||d<=xl(s,Ll(.2)))&&(i(),t())});i=G(()=>{o(),e.removeEventListener("unloading",n)})});return t(Vn({shakaPlayer:e,streamUrl:this.props.source.stream.url,startPosition:this.props.source.sourceParams.startPosition})),i}),this.shakaPlayer=void 0,this.customNetworkingEngine=void 0,this.manifestXmlSpy=void 0,this.abrRestrictionsHelper=void 0,this.videoElement=document.createElement("video"),t(vn()),this.abrRestrictionsHelper=new Vv({getManifestXml:()=>{var e;return null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml()},getState:this.props.getState,getCapSizes:this.props.getCapSizes}),this.addDestroyHandler(()=>{var e,t,r;null==(e=this.customNetworkingEngine)||e.destroy(),null==(t=this.manifestXmlSpy)||t.destroy(),null==(r=this.shakaPlayer)||r.destroy(),this.customNetworkingEngine=void 0,this.manifestXmlSpy=void 0,this.shakaPlayer=void 0})}getBandwidthEstimate(){var e;if(this.isDestroyed)return;const t=null==(e=this.shakaPlayer)?void 0:e.getStats();return null!=t&&t.estimatedBandwidth?{value:t.estimatedBandwidth,source:t.estimatedBandwidthSource}:void 0}getCachedVariantTrack(){return this.hasCachedSegments()?Rn(this.shakaPlayer):void 0}copyCachedData(){var e;const t=null==(e=this.customNetworkingEngine)?void 0:e.copyCachedData();return{segmentCache:null==t?void 0:t.segmentCache,loadedManifest:null==t?void 0:t.loadedManifest}}getVideoElement(){return this.videoElement}getType(){return this.props.type}getBufferedInfo(){return void 0===this.shakaPlayer?{total:[],audio:[],video:[]}:this.shakaPlayer.getBufferedInfo()}getSource(){return this.props.source}getManifestXml(){var e;return null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml()}hasManifest(){var e;return void 0!==(null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml())}hasCachedSegments(){var e;return Boolean(null==(e=this.customNetworkingEngine)?void 0:e.hasCachedSegments())}getInitialShakaConfig(){var e,t;const r=this.props.getState(),{stream:i}=this.props.source,n=ln(r),o=new Lv({getPlaybackRate:()=>1,bandwidthEstimateOffset:null!=(e=null==(t=r.controller.playerConfig)?void 0:t.bandwidthEstimateOffset)?e:wl(0),getSegmentDuration:()=>wn(this.shakaPlayer),getFilterParams:e=>({preloadedVariant:void 0,restrictions:this.abrRestrictionsHelper.getAbrRestrictions()}),isLowLatencyLive:()=>!1});return xn({},cv,{abr:xn({},cv.abr,{enabled:!1},null!=n&&n.value?{defaultBandwidthEstimate:n.value,defaultBandwidthEstimateSource:n.source}:{}),abrFactory:function(){return o},drm:xn({},cv.drm,i.drmConfig),streaming:xn({},cv.streaming,{bufferingGoal:ov})})}}var zv;!function(e){e[e.MEDIA_ERR_CUSTOM=0]="MEDIA_ERR_CUSTOM",e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED",e[e.MEDIA_ERR_ENCRYPTED=5]="MEDIA_ERR_ENCRYPTED"}(zv||(zv={}));class Qv{constructor(e){this.code=0,this.message="",this.details=void 0,"number"===typeof e?this.code=e:"string"===typeof e?this.message=e:d(e)&&("number"===typeof e.code&&(this.code=e.code),"string"===typeof e.message&&(this.message=e.message),this.details=e.details),this.message||(this.message=zv[this.code]||"")}}var Jv=e(6636);const{isSupported:Zv}=e(1673),$v=Zv(),eg=[401,403],{ErrorDetails:tg}=e(7179),rg=[tg.FRAG_LOAD_ERROR,tg.FRAG_LOAD_TIMEOUT,tg.FRAG_PARSING_ERROR,tg.BUFFER_APPEND_ERROR,tg.INTERNAL_EXCEPTION,tg.LEVEL_LOAD_TIMEOUT,tg.MANIFEST_LOAD_ERROR,tg.MANIFEST_LOAD_TIMEOUT],ig=[tg.FRAG_LOAD_ERROR,tg.FRAG_LOAD_TIMEOUT,tg.FRAG_PARSING_ERROR,tg.LEVEL_LOAD_TIMEOUT],ng=[tg.MANIFEST_LOAD_ERROR,tg.MANIFEST_LOAD_TIMEOUT],og=[tg.FRAG_DECRYPT_ERROR,tg.FRAG_PARSING_ERROR,tg.BUFFER_STALLED_ERROR,tg.BUFFER_NUDGE_ON_STALL];let ag;!function(e){e.LOWRES="lowres",e.HIGHRES="highres"}(ag||(ag={}));const sg={tiles:"com.yandex.video.thumbnail.lowres.tiles",duration:"com.yandex.video.thumbnail.lowres.duration",resolution:"com.yandex.video.thumbnail.lowres.resolution",uri:"com.yandex.video.thumbnail.lowres.uri"},lg={tiles:"com.yandex.video.thumbnail.tiles",duration:"com.yandex.video.thumbnail.duration",resolution:"com.yandex.video.thumbnail.resolution",uri:"com.yandex.video.thumbnail.uri"},dg=[Vl(4320),Vl(2880),Vl(2160),Vl(1440),Vl(1080),Vl(720),Vl(576),Vl(480),Vl(360),Vl(240),Vl(144)],cg=Math.min(...dg.slice(1).map((e,t)=>dg[t]/e));let ug;!function(e){e.WAS_WORKER_INTERNAL_ERROR="YANDEX_PLAYER_HLS_WAS_WORKER_INTERNAL_ERROR"}(ug||(ug={}));let hg;!function(e){e.HasAd="HasAd",e.NoAd="NoAd",e.NoData="NoData"}(hg||(hg={}));const pg=/^(\d+)x(\d+)@(\d+)$/,fg=function(){const{volume:e}=is;is.volume=0===e?1:0;const t=is.volume!==e;return is.volume=e,t}(),vg=Vl(720);let gg;!function(e){e.VideoTagPaused="VideoTagPaused",e.VideoTagPausedAfterDurationChange="VideoTagPausedAfterDurationChange",e.VideoTagPausedAfterError="VideoTagPausedAfterError",e.PauseEvent="PauseEvent",e.ProgressEvent="ProgressEvent",e.PromiseResolve="PromiseResolve",e.PromiseReject="PromiseReject",e.PlayingEvent="PlayingEvent",e.Timeout="Timeout"}(gg||(gg={}));const mg={once:!0,passive:!0};class Eg{constructor(e){this.props=e,this.currentAttempt=0,this.recovering=!1,this.plannedTaskPromise=void 0,this.resetTimeoutId=0}get allowed(){return this.currentAttempt<this.props.maxAttempts}get started(){return this.currentAttempt>0}get attempt(){return this.currentAttempt}getState(){return this.started?ef.ON:ef.OFF}planTask(e,r){let i,{reason:n,delay:o,force:a,rawData:s}=r;if(this.recovering&&!a)return this.log("Can't plan task cause is in process of recover"),void this.props.onConcurrentRecover({reason:n,rawData:s});this.clearPlannedTask("new task planned"),this.clearResetTimeout("new task planned"),"number"===typeof o?(i=Yl(o).promise.then(ne),this.log("#"+this.currentAttempt+", PLAN task, "+o+"ms, ["+n+"]",s)):(i=o,this.log("#"+this.currentAttempt+", PLAN async task, ["+n+"]",s)),t(i),i.then(()=>{if(i===this.plannedTaskPromise)return this.recovering=!0,this.currentAttempt++,this.props.onRunTask({reason:n,delay:o,rawData:s,attempt:this.currentAttempt}),this.log("#"+this.currentAttempt+", RUN task, ["+n+"]",s),this.clearPlannedTask(),e()}).catch(e=>{this.log("Error while recover",e),this.props.onRecoverError({reason:n,rawData:s},e)}).then(()=>{this.recovering=!1}),this.plannedTaskPromise=i}isRecovering(){return this.recovering}planReset(e){let{reason:t,delay:r}=e;this.log("plan RESET, "+r+"ms, if ["+t+"]"),this.clearResetTimeout("new reset planned"),this.resetTimeoutId=window.setTimeout(()=>{this.reset(t)},r)}destroy(){this.reset("destroy")}reset(e){this.props.onReset(),this.log("RESET because of ["+e+"]"),this.clearPlannedTask(),this.clearResetTimeout(),this.currentAttempt=0}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ld.log("RecoverHelper:",...t)}clearPlannedTask(e){e&&this.log("CLEAR planned TASKS because of ["+e+"]"),this.plannedTaskPromise=void 0}clearResetTimeout(e){e&&this.log("CLEAR planned RESET because of ["+e+"]"),0!==this.resetTimeoutId&&(clearTimeout(this.resetTimeoutId),this.resetTimeoutId=0)}}class Ag extends Ad{destroy(){this.emit("Destroy"),this.off("Destroy"),Object.keys(this.handlers).forEach(e=>{this.off(e)}),Object.keys(this.onceHandlers).forEach(e=>{this.off(e)})}}class yg extends Ag{constructor(e,t){super();let r={videoWidth:e.videoWidth,videoHeight:e.videoHeight};const i=()=>{const{videoWidth:i,videoHeight:n}=e;isNaN(i)||isNaN(n)||i<1||n<1||r.videoWidth===i&&r.videoHeight===n||(r={videoWidth:i,videoHeight:n},t({videoWidth:i,videoHeight:n}))};if("onresize"in e)e.addEventListener("resize",i),this.once("Destroy",()=>e.removeEventListener("resize",i));else{e.addEventListener("timeupdate",i),this.once("Destroy",()=>e.removeEventListener("timeupdate",i));const t=setInterval(i,Nl(1e3));this.once("Destroy",()=>clearInterval(t))}}}const Tg=Vl(360);var Sg=e(8024),Rg=e.n(Sg);const _g={droppedVideoFrames:0,corruptedVideoFrames:0,totalVideoFrames:0},Pg=Vl(360);class Ig{constructor(e){void 0===e&&(e={}),this.timeMeasurer=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.totalDecodedFrames=0,this.totalDroppedFrames=0,this.lastVideoWidth=void 0,this.lastVideoHeight=void 0,this.maxWidth=1/0,this.maxHeight=1/0,this.props=void 0,this.props=e}setRestrictions(e,t){var r,i;e>=this.maxWidth&&t>=this.maxHeight||t<Pg||(this.maxWidth=e,this.maxHeight=t,Ld.warn("FPSController changed restrictions: "+e+"\xd7"+t+"."),null==(r=(i=this.props).onRestrictionsChange)||r.call(i,{decodedFrames:this.totalDecodedFrames,droppedFrames:this.totalDroppedFrames,maxWidth:e,maxHeight:t}))}getRestrictions(){return{maxWidth:this.maxWidth,maxHeight:this.maxHeight}}update(e){if(!e.videoWidth||!e.videoHeight)return;const t=No(e);this.checkFPS(Vl(e.videoWidth),Vl(e.videoHeight),t.totalVideoFrames,t.droppedVideoFrames)}checkFPS(e,t,r,i){!this.timeMeasurer||!r||this.lastVideoWidth!==e||this.lastVideoHeight!==t||r<this.lastDecodedFrames?(this.timeMeasurer=Y(),this.totalDecodedFrames=0,this.totalDroppedFrames=0):(this.totalDroppedFrames+=i-this.lastDroppedFrames,this.totalDecodedFrames+=r-this.lastDecodedFrames,this.timeMeasurer()>5e3&&this.totalDroppedFrames>.25*this.totalDecodedFrames&&this.setRestrictions(e,t)),this.lastDecodedFrames=r,this.lastDroppedFrames=i,this.lastVideoWidth=e,this.lastVideoHeight=t}}const bg=G(()=>Ee("web_prefer_hd"));let Cg=function(){try{return JSON.parse(Ef.getItem("videoplayer-prefer-hd")||"{}")}catch(YE){return{}}}();const Og=Nl(100);class wg{constructor(e,t){this.win=e,this.callback=t,this.started=!1,this.intervalId=0,this.getDiff=Y()}start(){this.started||(this.started=!0,this.getDiff=Y(),this.intervalId=this.win.setInterval(()=>{const e=Nl(this.getDiff());this.getDiff=Y(),this.callback(e)},Og))}stop(){this.started&&(this.started=!1,this.win.clearInterval(this.intervalId))}}const kg=null===is.onwaiting,Dg=!kg||Ns||nd?(e,t)=>{let r=0,i=!1;return L(()=>{const n=e.currentTime,o=e.duration;if(!e.paused){const e=r+.004;i?n>e&&(t(!1),i=!1):n<e&&n!==o&&(t(!0),i=!0)}r=n})}:(e,t)=>{let r=!1;const i=g(e,"pause",()=>{r&&(r=!1,t(!1))},{passive:!0}),n=g(e,"waiting",()=>{r||(r=!0,t(!0))},{passive:!0}),o=g(e,"playing",()=>{r&&(r=!1,t(!1))},{passive:!0}),a=g(e,"canplay",()=>{r&&(r=!1,t(!1))},{passive:!0});return()=>{i(),n(),o(),a()}},Ng=Ll(0),Lg=Ll(15),Mg=Ll(15);class Vg extends Ad{get state(){return this.playerStore.getState()}get fragDuration(){return this.getFragmentsData().fragmentDuration}get isDestroyed(){return this.destroyed}async requestDebugInfo(){return{notImplemented:!0}}constructor(e){var t;super(),this.props=e,this.engine=void 0,this.recoverHelper=void 0,this.video=void 0,this.wasPausedAfterQualityChanged=!1,this.currentTextTrack=void 0,this.withCredentials=!1,this.playerStore=void 0,this.currentState=void 0,this.videoTrackLabels=new Map,this.previousScreenshotBlobUrl=void 0,this.destroy=G(()=>(this.destroyed=!0,this.destroyUnsafe())),this.destroyed=!1,this.tickController=void 0,this.fpsController=new Ig({onRestrictionsChange:e=>{this.props.logEvent({event:"FPSControllerRestrictions",params:e})}}),this.currentSubtitles=[],this.bandwidthEstimateUpdateInterval=null,this.preventPauseState=void 0,this.playDeferred=void 0,this.isPauseHandlerCalled=void 0,this.restoreUserTracks=()=>{this.restoreUserTextTrack(),this.restoreUserAudioTrack(),this.restoreUserVideoTrack()},this.refreshSubtitles=()=>{try{if(!this.video)return;const e=this.getCurrentTextTrack(),t=e?oe(e.activeCues).filter(e=>e&&e.text).map(e=>{let{text:t}=e;return t}):[];Vp()(this.currentSubtitles,t)||(this.currentSubtitles=t,this.props.onSubtitlesChange(t))}catch(YE){this.props.onError(new Cd(YE,{code:ps.REFRESH_SUBTITLES_ERROR,isFatal:!1}))}},this.disableSubtitlesNative=()=>{this.video&&Oo(this.video.textTracks).forEach(e=>{e&&(e.mode="disabled")})},this.emptySubtitles=()=>{this.currentSubtitles.length>0&&(this.currentSubtitles=[],this.props.onSubtitlesChange([]))},this.handleConcurrentRecover=e=>{this.props.logEvent({event:"ConcurrentRecoverCalled",params:e})},this.handleRecoverError=(e,t)=>{this.props.onError(new Cd({code:ps.RECOVER_TASK_ERROR,isFatal:!1,details:e,stack:null==t?void 0:t.stack}))},this.setMaxListeners(42),this.isPauseHandlerCalled=this.props.video.paused,this.recoverHelper=new Eg({maxAttempts:null!=(t=e.maxRecoverAttempts)?t:10,onRunTask:this.props.onRecover,onReset:()=>this.playerStore.dispatch(Kc(void 0)),onConcurrentRecover:this.handleConcurrentRecover,onRecoverError:this.handleRecoverError}),this.on("Destroy",()=>this.recoverHelper.destroy());const{video:r,playerStore:i,sourceParams:n}=this.props;this.video=r,this.playerStore=i,this.setLoop(Boolean(e.sourceParams.loop)),this.withCredentials=Boolean(e.sourceParams.withCredentials),this.setPoster(n.preview),this.updateNativeControlsVisibility();const o=this.playerStore.getState().controller.preload||ud;r.setAttribute("preload",o?"auto":"none");const a=g(r,"loadstart",()=>this.video.style.opacity="1");this.on("Destroy",a),this.tickController=new wg(window,e=>{try{this.onTick(Nl(e))}catch(YE){this.props.onError(new Cd(YE,{code:ps.ON_TICK_ERROR,isFatal:!1}))}}),this.on("Destroy",()=>this.tickController.stop()),this.on("InternalPlayingStateChange",this.updateBufferGoal),Promise.resolve().then(()=>{this.initInternalSubscribe()})}initInternalSubscribe(){this.on("VideoPlayingStateChange",e=>{if(e!==Ql.END||Er(this.state)){if(e===Ql.PLAY&&!Er(this.state)){const e=this.fragDuration<=2*Jh?1e3*this.fragDuration:1e3*Jh;this.recoverHelper.planReset({delay:e,reason:"no new errors for "+e+"ms"})}}else this.recoverHelper.reset("onPlayingStateChange ["+Ql.END+"]")}),this.on("InternalPlayingStateChange",e=>{const{encoderState:t}=this.state.controller;(t===ep.Attaching||t===ep.Attached)&&this.currentState!==e&&(this.isBufferingOnPreload(e)||this.currentState===Ql.END&&this.video.paused||(this.currentState=e,this.emit("VideoPlayingStateChange",e)))}),this.on("CurrentTimeChange",e=>{const t=this.getDuration(),{videoType:r}=this.state.controller;e>=t&&t>0&&r===rp.VOD&&!this.props.sourceParams.loop&&this.emit("InternalPlayingStateChange",Ql.END)}),this.on("InternalVideoTrackValueChange",_o(e=>{this.emit("VideoTrackValueChange",e)})),this.on("InternalAudioTrackValueChange",_o(e=>{this.emit("AudioTrackValueChange",e)})),this.on("InternalTextTrackValueChange",_o(e=>{this.emit("TextTrackValueChange",e)})),this.addVideoEventListener(null===this.video.onplaying?"playing":"play",()=>this.handleVideoElementPlayEvent()),this.addVideoEventListener("loadedmetadata",()=>{this.emit("DurationChange",this.getDuration())}),this.addVideoEventListener("play",()=>{this.isPauseHandlerCalled=!1}),this.addVideoEventListener("seeked",()=>{this.emit("Seeked")});let e=this.video.playbackRate;this.addVideoEventListener("ratechange",()=>{const t=this.video.playbackRate,r=this.state.controller.playbackRate;if(e===t)return;const i=e;e=t,Er(this.state)||this.recoverHelper.isRecovering()||0===t||t===r||(0===i&&t!==r?this.setPlaybackRate(r):t!==this.state.controller.playbackRate&&this.playerStore.dispatch(Wc(t)))}),this.addVideoEventListener("pause",()=>this.onPause()),this.addVideoEventListener("progress",()=>{Er(this.state)||this.emit("BufferingRangesChange",function(e){const t=[];for(let r=0;r<e.buffered.length;r++)t.push({start:Ll(e.buffered.start(r)),end:Ll(e.buffered.end(r))});return function(e){const t=e.map(e=>{let{start:t,end:r}=e;return{start:t,end:r}}).sort((e,t)=>e.start-t.start);if(t.length<=1)return t;const r=[t[0]];return t.slice(1).forEach((e,t)=>{const i=r[r.length-1];i.end<e.start?r.push(e):i.end<e.end&&(i.end=e.end)}),r}(t)}(this.props.video))}),this.addVideoEventListener("canplay",()=>{this.emit("CanPlay",void 0)}),this.addVideoEventListener("ended",()=>{const{videoType:e}=this.playerStore.getState().controller;e===rp.VOD||void 0===e?this.emit("InternalPlayingStateChange",Ql.END):this.video.paused&&Ld.warn('Pause stream after "ended" event on LIVE stream')}),this.addVideoEventListener("loadeddata",()=>{this.emit("LoadedData",void 0)}),this.addVideoEventListener("error",e=>this.onVideoTagError(e)),this.handleSubtitles(),this.addVideoEventListener("timeupdate",()=>{Er(this.state)||this.state.controller.playingState===Ql.PAUSE||this.fpsController.update(this.video)}),this.addVideoEventListener("durationchange",()=>{Er(this.state)||this.dispatchOnDurationChange()}),this.on("DvrChange",()=>this.updateDVRParams())}async play(){if(this.preventPauseState)return this.preventPauseState=Lo({},this.preventPauseState,{shouldPlayAfterEnd:!0}),Ld.log("play method call during preventPauseAsync operation"),this.playDeferred||(this.playDeferred=new ad,this.playDeferred.promise.catch(ne).then(()=>this.playDeferred=void 0)),this.playDeferred.promise;await this.playInternal()}getFragmentsData(){return{totalDuration:this.getDuration(),fragmentDuration:Jh,startTime:Ll(0)}}getUtcStartTime(){return Ng}getUtcPosition(){return Ng}async attachEncoder(){this.tickController.start(),this.bandwidthEstimateUpdateInterval=window.setInterval(()=>{this.playerStore.dispatch(uc(this.getBandwidthEstimate())),on(this.getBandwidthEstimate())},5e3),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=this.state.controller.playbackRate);const e=new yg(this.video,()=>{this.onVideoResize()});this.once("Detach",()=>e.destroy())}onVideoTagError(e){!this.video.src&&!Er(this.state)&&(this.video.style.opacity="0")}captureScreenshot(e){return Promise.resolve(void 0)}clearScreenshot(){this.previousScreenshotBlobUrl&&(URL.revokeObjectURL(this.previousScreenshotBlobUrl),this.previousScreenshotBlobUrl=void 0)}seek(e){if(!this.canSeek())return void this.playerStore.dispatch(Mc({videoTime:e}));this.playerStore.dispatch(Kc(void 0));const{start:t,end:r}=this.getSeekableRange(),{currentTime:i,bufferingRanges:n}=this.state.controller,o=c(e,t,r);void 0===Gr(n,o)&&this.props.onExpectedStalledChange(qt(kd.Seek,{oldPosition:i,newPosition:o})),kn(this.video,Ll(o)),this.emit("CurrentTimeChange",this.getCurrentTime())}setPlaybackRate(e){const t=this.video.playbackRate;if(t===e)return;this.video.playbackRate=e;const r=this.video.playbackRate;r!==t&&this.playerStore.dispatch(Wc(r))}getUtcEndTime(){return Ll(0)}static isLiveStreamUrl(e){return e.startsWith("https://strm.yandex.ru/live/")||e.startsWith("https://streaming.tst.strm.yandex.net/live/")}updateNativeControlsVisibility(){const e=!$l(this.state.skin.hiddenControls)&&(this.state,!0);this.playerStore.dispatch(gu(e)),Ro(this.video,{controls:e?"controls":null}),this.video.classList.toggle(Rg().video_hiddenControls,!e),this.setNativeTimeControlVisibility(Po(this.state)),this.setNativeTimelineControlVisibility(Po(this.state))}detachEncoder(){if(this.tickController.stop(),this.state.controller.encoderState===ep.Attached){const e=this.getBandwidthEstimate();this.playerStore.dispatch(uc(e)),on(e)}return null!==this.bandwidthEstimateUpdateInterval&&clearInterval(this.bandwidthEstimateUpdateInterval),this.emit("BufferingRangesChange",[]),this.emit("InternalVideoTrackValueChange",void 0),this.emit("InternalAudioTrackValueChange",void 0),this.emit("InternalTextTrackValueChange",void 0),this.emit("Detach",void 0),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=1),Promise.resolve()}async preloadSource(){Ld.log("preloadSource() is not implemented for "+this.engine)}createCachePreloader(){}setLoop(e){const{video:t}=this.props,{loop:r}=this.video;e!==r&&(t.loop=e)}isPaused(){return this.props.video.paused}pause(){var e;this.recoverHelper.reset("pause"),this.props.video.pause(),this.onPause(),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()"))}getDuration(){return Ll(this.video.duration)}getCurrentTime(){return Ml(Bl(Math.floor(Ul(this.props.video.currentTime,1e3)),1e3))}getVideoWidth(){return this.video.videoWidth}getVideoHeight(){return this.video.videoHeight}setVolume(e){!function(e){return"number"===typeof e&&0<=e&&e<=1}(e)?Ld.warn("setVolume wrong value"):fg?this.video.volume=e:Ld.warn("cannot change video volume")}getVolume(){return this.video.volume}setMuted(e){this.video.muted=e}getMuted(){return this.video.muted}setPoster(e){this.state.skin.nativeControlsVisibility&&(this.removePoster(),this.props.video.setAttribute("poster",e||od))}removePoster(){this.props.video.removeAttribute("poster")}getConnectionQuality(){return wp({fragDuration:Ul(this.fragDuration,1e3),timings:this.props.resourceTimingsMonitor.getAllResourcesTimings()})}isDvrEnabled(){return!0}toggleNativeSubtitles(e){const t=this.state.skin.useNativeSubtitles;if(t===e)return;const r=wo(t),i=wo(e);this.playerStore.dispatch(Fp(e)),Oo(this.video.textTracks).forEach((e,t)=>{e&&(e.mode=r===e.mode?i:"disabled")})}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getRecoverHelperState(){return this.recoverHelper.getState()}getContainerSize(){const e=this.getVideoElementSize();return{width:Ul(e.width,devicePixelRatio),height:Ul(e.height,devicePixelRatio)}}getCapSizes(){var e,t;const r=null!=(e=this.props.getPipWindowSize())?e:function(e,t,r){let{videoWidth:i,videoHeight:n}=e;const{width:o,height:a}=r;if(!i||!n)return{width:o,height:a};switch(t){case"none":return{width:Vl(i),height:Vl(n)};case"cover":{const e=Vl(Math.floor(n*o/i));return e>=a?{width:o,height:e}:{height:a,width:Vl(Math.floor(i*a/n))}}case"contain":case"scale-down":{const e=Vl(Math.floor(n*o/i));return e<=a?{width:o,height:e}:{height:a,width:Vl(Math.floor(i*a/n))}}case"fill":default:return{width:o,height:a}}}(this.video,(null==(t=this.state.controller.videoElementStyle)?void 0:t.objectFit)||"contain",this.props.videoSizeSensor.getSize()),i=this.fpsController.getRestrictions(),n=r.height>r.width,o=(void 0===(a=this.state.controller.from)&&(a=jp),!!bg()||a in Cg&&Cg[a].preferHd);var a;const s=Io(),l=null!==this.props.defaultQuality,d=null===(c=this.props.defaultQuality)?Vl(1/0):void 0===c?vg:Vl(c);var c;const u=Ul(o&&l?Vl(Math.max(screen.height,r.height)):r.height,devicePixelRatio),h=Ul(o&&l?Vl(Math.max(screen.width,r.width)):r.width,devicePixelRatio),p=Vl(n||o?u:Math.min(u,d)),f=Vl(n&&!o?Math.min(h,d):h),v=Vl(!n&&s?Math.min(i.maxHeight,Tg):i.maxHeight);return{width:f,height:p,maxWidth:Vl(n&&s?Math.min(i.maxWidth,Tg):i.maxWidth),maxHeight:v}}getMaxCapAllowedVideoTrack(){}getRemainingBufferedTime(){return{total:Yr(this.state)||Ll(0)}}getSegmentSize(){}getBandwidthEstimate(){return ln(this.playerStore.getState())}async recoverStream(){const e=this.getPositionToRecover();this.playerStore.dispatch(Mc(e)),await this.detachEncoder(),await this.attachEncoder()}getLiveLatency(){if(!this.isLiveStreaming())return;const e=this.getUtcPosition(),t=this.getServerTime();return e>0&&void 0!==t?Ll(Math.max(t/1e3-e,0)):void 0}getServerTime(){}getPlayingState(){return this.currentState}isLiveStreaming(){const{state:e}=this;if(!br(e)||Er(e))return!1;const{controller:{playingState:t,currentTime:r,duration:i}}=e;return!(t!==Ql.PLAY&&t!==Ql.BUFFERING)&&!(0===r||!i)}subscribeVideoBuffering(){const{video:e}=this,t=Dg(e,t=>{const r=ko(e,t);if(this.isStalledLiveEdge(r)){const e=qt(kd.LiveEdge,void 0);this.props.onExpectedStalledChange(e)}this.emit("InternalPlayingStateChange",r)});this.once("Destroy",t)}updateVideoSize(){const{videoWidth:e,videoHeight:t}=this.video;this.state.controller.videoWidth===e&&this.state.controller.videoHeight===t||this.playerStore.dispatch(_c({videoWidth:Vl(e),videoHeight:Vl(t)}))}isStalledLiveEdge(e){const{video:t}=this,{controller:{videoType:r}}=this.state,i=e===Ql.BUFFERING,n=r===rp.EVENT||r===rp.LIVE,o=t.seekable.length>0&&t.seekable.end(0)-t.currentTime<2.5;return i&&n&&o}getPositionToRecover(){const{programDateTime:e,currentTime:t,startPosition:r}=this.state.controller,i={utc:void 0===e?void 0:xl(Bl(e,1e3),t),videoTime:t};return t?i:r}subscribeContentImpression(){this.once("Detach",function(e,t){const r=g(e,"timeupdate",()=>{e.currentTime>0&&!e.paused&&(n(),t())}),i=g(e,"playing",()=>{e.duration>0&&(n(),t())}),n=()=>{r(),i()};return n}(this.video,()=>{this.emit("ContentImpression",void 0)}))}onTick(e){const t=this.getCurrentTime();t===this.state.controller.currentTime&&0!==t||this.emit("CurrentTimeChange",t),this.video.paused&&this.currentState===Ql.PLAY&&!this.wasPausedAfterQualityChanged&&this.state.controller.encoderState!==ep.Attaching&&this.state.controller.playingState!==Ql.PAUSE&&this.emit("InternalPlayingStateChange",Ql.PAUSE),this.setPlaybackRateCatchup()}addVideoEventListener(e,t,r){let{once:i}=void 0===r?{}:r,n=t;const{video:o}=this,a=()=>{o.removeEventListener(e,n)};return i&&(n=e=>{this.off("Destroy",a),a(),t.call(o,e)}),this.on("Destroy",a),this.video.addEventListener(e,n),a}addEventListener(e,t,r,i){const n=g(e,t,r,i);this.once("Destroy",n)}getSeekableRange(){return{start:Ll(0),end:this.getDuration()||Ll(0)}}setNativeTimeControlVisibility(e){this.video.classList.toggle(Rg().video_hiddenTime,!e)}setNativeTimelineControlVisibility(e){this.video.classList.toggle(Rg().video_hiddenTimeline,!e)}getVisibleTextTrackMode(){return wo(this.state.skin.useNativeSubtitles)}getHiddenTextTrackMode(){return"disabled"}getCurrentTextTrack(){if(!this.video)return;const e=this.getVisibleTextTrackMode();return Oo(this.video.textTracks).find(t=>void 0!==t&&t.mode===e)}restoreUserTextTrack(){const{userTextTrackEnabled:e}=this.state.controller;if(void 0!==e)if(e){const e=function(e){const{userTextTrackName:t,userTextTrackLang:r,textTracks:i}=e.controller;return gr(i,{name:t,lang:r})}(this.state);e&&this.setTextTrack(e)}else this.disableTextTrack()}restoreUserAudioTrack(){const e=function(e){const{userAudioTrackName:t,userAudioTrackLang:r,audioTracks:i}=e.controller;return vo(i,{name:t,lang:r})}(this.playerStore.getState());e&&(Ld.log("Set audio track by user params audioTrack=["+JSON.stringify(e)+"]"),this.setAudioTrack(e))}restoreUserVideoTrack(){const e=function(e){const{videoTracks:t,userVideoTrackName:r,userVideoTrackHeight:i}=e.controller;return go(t,{name:r,height:i})}(this.playerStore.getState());e&&(Ld.log("Set video track by user params videoTrack=["+JSON.stringify(e)+"]"),this.setVideoTrack(e))}updateSkinDvrParameters(e){const t=Bl(e,1e3),{skin:{skinDVRStartTime:r,skinDVRDuration:i},controller:{videoType:n,dvrDuration:o,duration:a}}=this.state;if(n===rp.LIVE){const e=Ll(Math.min(xl(r,t),a||Ll(0)));this.playerStore.dispatch(Hc(e)),this.emit("DVRStartTimeChange",e)}else if(n===rp.EVENT){const e=Ll(Math.min(xl(i,t),o));this.playerStore.dispatch(Gc(e)),this.emit("DVRDurationChange",e)}}async destroyUnsafe(){this.emit("Destroy",void 0),await this.detachEncoder();const{error:e}=this.state.controller.errorInfo;e&&e.isFatal&&this.video.src&&this.video.removeAttribute("src")}async preventPauseAsync(e,r){const{paused:i}=e,n=r();this.preventPauseState||(this.preventPauseState={promises:[],shouldPlayAfterEnd:!i}),this.preventPauseState.promises.push(n);const o=await n;if(this.preventPauseState){const e=this.preventPauseState.promises.length;Promise.all(this.preventPauseState.promises).catch(ne).then(()=>{this.preventPauseState&&e===this.preventPauseState.promises.length&&(this.preventPauseState.shouldPlayAfterEnd&&t(this.playInternal()),this.preventPauseState=void 0)})}return o}getVideoOwnerDocument(){return this.video.ownerDocument||document}getStreamUrl(){return this.props.stream.url}shouldUseLowBuffer(){const{startStage:e,autoplay:t,preload:r,feed:i}=this.state.controller;return!(!this.video.paused||!i)||e!==$h.started&&!t&&r}isBufferingOnPreload(e){return e===Ql.BUFFERING&&(!!this.state.controller.preload&&(this.state.controller.startStage!==$h.started&&this.state.controller.startStage!==$h.starting))}getMaxBufferLength(){if(this.shouldUseLowBuffer())return ov;if(this.state.controller.feed&&this.getCurrentTime()<Lg)return Mg;const{maxBufferLength:e=Uv}=this.props;return e}handleVideoElementPlayEvent(){this.wasPausedAfterQualityChanged=!1,this.emit("InternalPlayingStateChange",Ql.PLAY)}updateBufferGoal(){}isLowLatencyLive(){return!1}onVideoResize(){this.updateVideoSize()}onPause(){this.video.paused&&(this.isPauseHandlerCalled||(this.isPauseHandlerCalled=!0,this.wasPausedAfterQualityChanged||this.video.ended||this.getCurrentTime()>=this.getDuration()||this.emit("InternalPlayingStateChange",Ql.PAUSE)))}calculateDVRParams(){const{fragmentDuration:e,startTime:t,totalDuration:r}=this.getFragmentsData();return{fragmentDuration:e,dvrDuration:r,dvrStartTime:t,skinDVRDuration:r,skinDVRStartTime:t}}updateDVRParams(){const{fragmentDuration:e,dvrStartTime:t,dvrDuration:r,skinDVRStartTime:i,skinDVRDuration:n}=this.calculateDVRParams();this.playerStore.dispatch(xc(e));const{dvrDuration:o,dvrStartTime:a}=this.state.controller;Vp()(o,r)||(this.playerStore.dispatch(Bc(r)),this.playerStore.dispatch(Gc(n)),this.emit("DVRDurationChange",n)),Vp()(a,t)||(this.playerStore.dispatch(Uc(t)),this.playerStore.dispatch(Hc(i)),this.emit("DVRStartTimeChange",i))}setPlaybackRateCatchup(){const e=function(e,t,r){if(!br(e)||Er(e)||!r)return;const{controller:{playingState:i,playbackRate:n}}=e;if(i!==Ql.PLAY)return;const o=t.total;let a;if(o<2){const e=5*(o-2);a=.97+.06/(1+Math.pow(Math.E,-e))}else{const e=.02;if(Math.abs(r-7)<=7*e)a=1;else{const e=5*(r-7);a=.97+.06/(1+Math.pow(Math.E,-e))}}return Math.abs(n-a)<=Sp&&(a=void 0),a}(this.state,this.getRemainingBufferedTime(),this.getLiveLatency());void 0!==e&&this.isLowLatencyLive()&&this.setPlaybackRate(e)}getVideoElementSize(){var e;const t=this.props.videoSizeSensor.getSize();return null!=(e=this.props.getPipWindowSize())?e:{width:Vl(t.width),height:Vl(t.height)}}handleSubtitles(){const{textTracks:e}=this.video;e&&"function"===typeof e.addEventListener&&(this.on("Destroy",g(e,"addtrack",e=>{const t=e.track;t&&"subtitles"===t.kind&&this.on("Destroy",g(t,"cuechange",this.refreshSubtitles))})),this.on("TextTrackValueChange",e=>{void 0===e?this.emptySubtitles():this.refreshSubtitles()}),this.on("Destroy",L(this.refreshSubtitles)),this.on("Detach",this.disableSubtitlesNative))}dispatchOnDurationChange(){const e=this.getDuration();isNaN(e)||this.state.controller.duration!==e&&this.emit("DurationChange",e)}playInternal(){const e=bo(this.video);return e.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()}).catch(e=>{var t;-1!==String(e).indexOf("no supported sources")&&this.props.onError(new Cd({code:ps.UNSUPPORTED_MEDIA_TYPE,isFatal:!0})),null==(t=this.playDeferred)||t.reject(e)}),e.then(ne)}shouldLogStalledDebugInfo(){return!1}}const xg=Vl(1/0);class Fg extends Vg{initInternalSubscribe(){super.initInternalSubscribe(),this.on("VideoPlayingStateChange",e=>{e===Ql.PLAY?this.recoverHelper.reset("play"):e===Ql.END?this.stopLoad():e===Ql.BUFFERING&&this.tryRecoverOnBuffering()}),this.subscribeVideoBuffering()}constructor(e){super(e),this.props=e,this.engine=rf.HLS,this.preloadSourceHLSEncoder=void 0,this.preloadSourceHandlers=[],this.preloadPosition={},this.HLSEncoder=void 0,this.lastKnownLevelDetails=void 0,this.HLSEncoderAttachTime=1/0,this.loadStarted=!1,this.recoverOnBufferingReason=null,this.initHlsEncoderPromise=void 0,this.maxHeightCapping=void 0,this.levelForcingInterval=void 0,this.lastFragRequest=void 0,this.restoreUserTracksWhenPossible=()=>{const{HLSEncoder:e}=this;if(!e)return;if(!e.levels||0===e.levels.length)return void e.once(Hls.Events.MANIFEST_LOADED,this.restoreUserTracksWhenPossible);W(this.HLSEncoderAttachTime)?this.restoreUserTracks():e.once(Hls.Events.MEDIA_ATTACHED,this.restoreUserTracks)},this.onLevelUpdated=()=>{this.emit("VideoTypeChange",this.getVideoType());const e=this.getHlsEncoderLevelDetails();if(e&&e.fragments&&e.fragments.length>0){const[t]=e.fragments;t.programDateTime&&this.emit("ProgramDateTimeChange",Ul(this.getUtcStartTime(),1e3))}},this.onSubtitleTracksUpdated=()=>{this.HLSEncoder&&this.emit("TextTracksChange",function(e){const t=[];return Array.isArray(e)&&e.forEach(e=>{const r=so(e);r&&t.push(r)}),t}(this.HLSEncoder.subtitleTracks))},this.onAudioTracksUpdated=()=>{const{HLSEncoder:e}=this;if(!e)return;const{audioTracks:t}=e;e.config.maxBufferSize=t.length>0?12e6:Hls.DefaultConfig.maxBufferSize,this.emit("AudioTracksChange",function(e){const t=[];return Array.isArray(e)?(e.forEach(e=>{const r=ao(e);r&&t.push(r)}),t):[]}(t))},t(fn()),this.playerStore.dispatch(qc(!0))}getEngine(){return rf.HLS}getFragmentsData(){const e=this.getHlsEncoderLevelDetails();if(!e)return super.getFragmentsData();const{totalduration:t,targetduration:r,fragments:i}=e,[n]=i;return n?{totalDuration:Ll(Math.min(t,this.getDuration())),fragmentDuration:Ll(r),startTime:Ll(n.start)}:super.getFragmentsData()}onOnline(){this.startLoadOnce(this.video.currentTime)}onOffline(){this.stopLoad()}play(){return this.startLoadOnce(),super.play()}getUtcStartTime(){const e=this.getHlsEncoderLevelDetails();if(!e||!e.hasProgramDateTime)return Ll(0);const[t]=e.fragments;return t&&t.programDateTime?Fl(Bl(Nl(t.programDateTime),1e3),Ll(t.start)):Ll(0)}getUtcPosition(){const e=this.getUtcStartTime();return e>0?xl(e,this.getCurrentTime()):super.getUtcPosition()}setVideoTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const{levels:r}=t;if(void 0===r)return;const i=e.value===Qp.value?-1:r.findIndex(t=>t.url.some(t=>t===e.value));-1===i?this.startLevelForcingWithSizeCap():this.stopLevelForcingWithSizeCap();const n=this.isPaused();t.currentLevel=i,!n&&this.isPaused()&&(this.wasPausedAfterQualityChanged=!0,this.emit("InternalPlayingStateChange",Ql.BUFFERING))}setAudioTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const r=t.audioTracks.find(t=>e.value===String(t.id));r&&(t.audioTrack=Number(r.id))}setTextTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const r=this.getHlsTextTrack(e);r&&(this.emit("InternalTextTrackValueChange",e&&e.value),t.subtitleTrack=r.id)}disableTextTrack(){this.emit("InternalTextTrackValueChange",void 0)}toggleNativeSubtitles(e){super.toggleNativeSubtitles(e);const{HLSEncoder:t}=this;void 0!==t&&(t.subtitleDisplay=e)}async preloadSource(){let e=!1;const t=()=>{e=!0};this.once("Destroy",t),this.once("Detach",t);try{await fn()}catch(a){return void this.props.onError(new Cd(a,{code:ps.SCRIPT_INIT_ERROR,isFatal:!1}))}if(e||this.HLSEncoder||this.initHlsEncoderPromise||this.preloadSourceHLSEncoder)return;const r=Mo({},this.getHlsJsConfig(),{liveSyncDuration:Jh}),i=window.hls=this.preloadSourceHLSEncoder=new Hls(r),n=(e,t)=>{this.preloadSourceHandlers.push([e,t]),i.once(e,t)};((e,t)=>{this.preloadSourceHandlers.push([e,t]),i.on(e,t)})(Hls.Events.ERROR,(e,t)=>{if(!t)return;const r=Qn(t),n=Zn(t);void 0!==n&&(this.props.onError(new Cd(n,{isFatal:!1})),r&&(this.props.onError(new Cd({code:ps.PRELOAD_SOURCE_FAILED,isFatal:!1,details:{reason:n}})),this.unsubscribePreloadSourceHandlers(),i.destroy(),this.clearPreloadSourceHlsEncoder()))});const o=()=>{this.preloadPosition=this.state.controller.startPosition,i.config.startFragPrefetch=!0,this.loadStarted=!0};n(Hls.Events.MANIFEST_PARSED,(e,t)=>{let{levels:r=[],audioTracks:a=[]}=t;const s=this.getStartVideoLevelIndex(r);i.startLevel=s,this.state.controller.isAbrEnabled||(i.loadLevel=s);this.getStartAudioTrackIndex(a)>-1&&(i.audioTrack=this.getStartAudioTrackIndex(a));const l=this.getStartLoadPosition();n(Hls.Events.LEVEL_UPDATED,(e,t)=>{let{details:r}=t;const n=this.getStartLoadPosition(r);l!==n&&void 0!==n&&i.streamController.startLoad(n),o()}),i.startLoad(l)}),i.loadSource(this.getStreamUrl())}async attachEncoder(){if(await super.attachEncoder(),!$v){const e=ps.HLS_JS_NOT_SUPPORTED_ERROR;return this.props.onError(new Cd({code:e})),Promise.reject(s(e,this.state.ad.adblockDetected))}return this.initHlsEncoderPromise=this.initHlsEncoder(),await this.initHlsEncoderPromise,this.initHlsEncoderPromise=void 0,this.subscribeContentImpression(),this.startLevelForcingWithSizeCap(),this.attachMedia()}async destroyUnsafe(){await super.destroyUnsafe(),this.preloadSourceHLSEncoder&&this.preloadSourceHLSEncoder.destroy(),this.HLSEncoder&&this.HLSEncoder.destroy()}canSeek(){return void 0!==this.HLSEncoder&&Boolean(this.HLSEncoder.media)&&super.canSeek()}async detachEncoder(){if(oe(this.video.textTracks).forEach(Eo),this.stopLevelForcingWithSizeCap(),await super.detachEncoder(),this.loadStarted=!1,this.preloadSourceHLSEncoder&&(this.preloadSourceHLSEncoder.destroy(),this.clearPreloadSourceHlsEncoder()),!this.HLSEncoder){if(!this.initHlsEncoderPromise)return;await this.initHlsEncoderPromise}const{video:e,HLSEncoder:t}=this;if(void 0!==t)return this.recoverOnBufferingReason=null,new Promise(r=>{t.media?t.once(Hls.Events.MEDIA_DETACHED,()=>{this.HLSEncoderAttachTime=1/0,r()}):r(),this.lastKnownLevelDetails=void 0,mo(e,()=>{t.destroy(),this.HLSEncoder=void 0})})}getConnectionQuality(){if(void 0===this.lastFragRequest)return super.getConnectionQuality();const{fragDuration:e,getElapsedTime:t}=this.lastFragRequest,r={fragDuration:e,downloadTime:t()};return Op(r)?bp.SLOW:super.getConnectionQuality()}getMaxCapAllowedVideoTrack(){const{HLSEncoder:e}=this;if(!e||!e.levels||!e.autoLevelEnabled)return;const t=e.levels[e.autoLevelCapping];return t?this.state.controller.videoTracks.find(e=>{let{value:r}=e;return r===t.url[0]}):void 0}onVideoTagError(e){if(super.onVideoTagError(e),!this.video.error||Er(this.state))return;const t=Fn(this.video);if(t.code!==zv.MEDIA_ERR_DECODE&&t.code!==zv.MEDIA_ERR_SRC_NOT_SUPPORTED)return;const r=t.code===zv.MEDIA_ERR_SRC_NOT_SUPPORTED,i=new Cd({code:zv[t.code],details:t,isFatal:r});if(this.props.onError(i),r)return;const n="VideoTagError MEDIA_ERR_DECODE";Ld.log(n),this.props.onExpectedStalledChange(qt(kd.MediaError,void 0)),this.isPaused()&&this.recoverHelper.planTask(()=>this.recoverCurrentFrag(),{reason:n,delay:1e3})}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e===rp.VOD||void 0===e)return super.calculateDVRParams();const{fragmentDuration:t,startTime:r,totalDuration:i}=this.getFragmentsData(),{liveOffset:n}=this.props,o=Ul(t,1),a=e===rp.EVENT?n:xl(o,n);return{fragmentDuration:t,dvrStartTime:r,dvrDuration:i,skinDVRStartTime:e===rp.EVENT?r:xl(o,r),skinDVRDuration:Fl(i,a)}}onTick(e){super.onTick(e),this.updateSkinDvrParameters(e)}getStreamUrl(){const e=super.getStreamUrl(),t={session_data:"1"};return Un(e)||(t.preview="1"),J(e,t,{saveOriginalPath:!0})}getBandwidthEstimate(){if(!this.HLSEncoder)return super.getBandwidthEstimate();const e=r(()=>this.HLSEncoder.abrController._bwEstimator.getEstimate());return W(e)?{value:e,source:"hlsjs"}:super.getBandwidthEstimate()}getUtcEndTime(){const e=this.getUtcStartTime();return e?xl(e,this.getDuration()):Ll(0)}stopLoad(){this.HLSEncoder&&(this.HLSEncoder.stopLoad(),this.loadStarted=!1)}tryRecoverOnBuffering(){if(!this.recoverOnBufferingReason)return;const{type:e,url:t,details:r,frag:i}=this.recoverOnBufferingReason,{controller:{bufferingRanges:n,fragmentDuration:o}}=this.state,a=this.getCurrentTime();if(n.some(e=>{let{start:t,end:r}=e;return t+o<a&&r-o>a}))return void Ld.log("skip recover",{currentTime:a,bufferingRanges:n});const{recoverHelper:s}=this;s.planTask(()=>this.recoverCurrentFrag(),{reason:"HlsJs "+e,rawData:{details:r,type:e,url:t,isFatal:!0,frag:Gn(i)},delay:100})}getHlsJsConfig(){const e="true"!==Ef.getItem(ug.WAS_WORKER_INTERNAL_ERROR);return{manifestLoadingTimeOut:av,levelLoadingTimeOut:sv,fragLoadingTimeOut:lv,fragLoadingMaxRetry:5,debug:this.props.debug,enableWorker:e,autoStartLoad:!1,capLevelToPlayerSize:!1,liveSyncDuration:this.props.liveOffset,levelLoadingMaxRetry:25,levelLoadingMaxRetryTimeout:100,enableCEA708Captions:!1,xhrSetup:(e,t)=>{this.withCredentials&&(e.withCredentials=!0);const r=$(t);("m3u8"===r||"ts"===r)&&e.open("GET",Gi(t),!0)},fetchSetup:(e,t)=>(this.withCredentials&&(t.credentials="include"),new Request(e.url,t)),maxMaxBufferLength:this.getMaxBufferLength()}}preparePreloadSourceHlsEncoderToAttach(){const e=this.preloadSourceHLSEncoder;if(!e)return;this.HLSEncoder=e;const{preloadPosition:t}=this;if(this.unsubscribePreloadSourceHandlers(),this.clearPreloadSourceHlsEncoder(),e.config.liveSyncDuration=this.props.liveOffset,!e.levels||0===e.levels.length)return e;this.onLevelsUpdated(),this.onLevelUpdated(),this.updateThumbnailTileMeta(),this.onAudioTracksUpdated(),this.onAudioTrackUpdated(e.audioTrack),this.onSubtitleTracksUpdated();const{videoTime:r,utc:i}=this.state.controller.startPosition;if(!(t.utc!==i||t.videoTime!==r))return e;const n=this.getStartLoadPosition(this.getHlsEncoderLevelDetails());return void 0!==n&&e.streamController.startLoad(n),e}async initHlsEncoder(){if(this.HLSEncoder)return;if(this.HLSEncoder=this.preparePreloadSourceHlsEncoderToAttach(),this.HLSEncoder)this.props.logEvent({event:Od.UsePreloadedHlsJs,params:{}});else{try{await fn()}catch(r){const e=new Cd(r,{code:ps.SCRIPT_INIT_ERROR});throw this.props.onError(e),e}this.HLSEncoder=new Hls(this.getHlsJsConfig())}const{HLSEncoder:e}=this;window.hls=e,this.subscribeHlsEncoderEvents(e),this.restoreUserTracksWhenPossible();const t=r=>{r!==Ql.BUFFERING&&r!==Ql.PLAY||(e.config.maxMaxBufferLength=this.getMaxBufferLength(),this.off("VideoPlayingStateChange",t))};this.on("VideoPlayingStateChange",t)}subscribeHlsEncoderEvents(e){e.subtitleDisplay=this.state.skin.useNativeSubtitles;const t=t=>{if(!e.levels)return;const r=e.levels[t];if(!r)return;const i=po(r,this.videoTrackLabels);i&&this.emit("InternalVideoTrackValueChange",i.value)};e.on(Hls.Events.LEVEL_SWITCHING,(e,r)=>{t(r.level)}),e.on(Hls.Events.LEVEL_SWITCHED,(e,r)=>{t(r.level)}),e.on(Hls.Events.STREAM_STATE_TRANSITION,(e,t)=>{let{nextState:r}=t;"FRAG_LOADING"!==r&&(this.lastFragRequest=void 0)}),e.on(Hls.Events.FRAG_LOADING,(e,t)=>{let{frag:{duration:r}}=t;this.lastFragRequest={fragDuration:Nl(1e3*r),getElapsedTime:Y()}}),e.levels&&0!==e.levels.length||e.on(Hls.Events.MANIFEST_PARSED,(r,i)=>{let{levels:n=[],audioTracks:o=[]}=i;this.onLevelsUpdated(),this.updateThumbnailTileMeta();const a=this.getStartVideoLevelIndex(n);e.startLevel=a,this.state.controller.isAbrEnabled||(e.loadLevel=a);this.getStartAudioTrackIndex(o)>-1&&(e.audioTrack=this.getStartAudioTrackIndex(o)),e.once(Hls.Events.LEVEL_LOADED,(e,r)=>{let{level:i}=r;t(i)})}),e.on(Hls.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated),e.on(Hls.Events.AUDIO_TRACK_SWITCHING,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.AUDIO_TRACK_SWITCHED,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated),e.on(Hls.Events.SUBTITLE_TRACK_SWITCH,(t,r)=>{const{subtitleTrack:i}=e;if(i>-1){const t=so(e.subtitleTracks.find(e=>e.id===r.id));if(!t)return;this.emit("InternalTextTrackValueChange",t.value)}else this.emit("InternalTextTrackValueChange",void 0)}),e.on(Hls.Events.FRAG_PARSING_METADATA,async(e,t)=>{const{samples:r,frag:i}=t;if(!r||0===r.length)return;const n=r.map(e=>{let{data:t}=e;return(0,Jv.parseV2Tag)(t)}).filter(e=>!1!==e&&void 0!==e.writer).map(e=>e.writer).filter(e=>void 0!==e),{data:o,index:a,reason:s}=function(e){const[t,r]=e.reduce((e,t)=>{let[r,i]=e;try{return!function(e){return"object"===typeof e&&e.id&&"number"===typeof e.offset&&(void 0===e.cutoff||"number"===typeof e.cutoff)}(JSON.parse(t))?i.push(t):r.push(t),[r,i]}catch(n){return[r,i]}},[[],[]]);if(t.length>0){const r=t[t.length-1];return{data:r,index:e.indexOf(r),reason:hg.HasAd}}if(r.length>0){const t=r[r.length-1];return{data:t,index:e.indexOf(t),reason:hg.NoAd}}return{data:"",index:-1,reason:hg.NoData}}(n);Ld.log("choose metadata: ",o,a,s);Math.random()<.01&&this.props.logEvent({event:Od.StreamPlayerChooseMetadata,params:{fragmentMetadataArray:o,chosenIndex:a,chosenReason:s}}),this.emit("MetadataChange",{fragmentMetadataArray:[o],fragmentStart:Ll(i.start),fragmentDuration:Ll(i.duration),src:i?i.url:this.getStreamUrl()})}),e.on(Hls.Events.MANIFEST_LOADED,()=>{this.onLevelsUpdated(),this.forceLevel(),this.onAudioTracksUpdated(),this.onSubtitleTracksUpdated()}),e.on(Hls.Events.LEVEL_UPDATED,this.onLevelUpdated),e.on(Hls.Events.ERROR,(e,t)=>{t&&this.onEncoderError(t)}),e.on(Hls.Events.FRAG_PARSED,(e,t)=>this.handleFragParsed(e,t)),this.on("VideoPlayingStateChange",e=>{"play"!==e&&"buffering"!==e||this.startLoadOnce()})}getStartVideoLevelIndex(e){const{userVideoTrackHeight:t,userVideoTrackName:r}=this.playerStore.getState().controller,i=go(e,{name:r,height:t});if(i){const t=e.indexOf(i);return Ld.log("User level found, start loading by index=["+t+"]"),t}return function(e){let{video:t,maxHeightCapping:r,levels:i=[],bandwidth:n}=e;const o=i.slice().filter(Boolean).sort((e,t)=>t.bitrate-e.bitrate);if(0===o.length)return-1;const{width:a,height:s}=To(t),[l]=o.filter(e=>!(n&&e.bitrate>n)&&(!(r&&e.height>r)&&(e.width<=a||e.height<=s)));return void 0===l?i.indexOf(o.pop()):i.indexOf(l)}({levels:e,maxHeightCapping:this.maxHeightCapping,video:this.video,bandwidth:this.state.controller.isAbrEnabled?this.getBandwidthEstimate().value:1/0})}getStartAudioTrackIndex(e){const{userAudioTrackName:t,userAudioTrackLang:r}=this.playerStore.getState().controller,i=vo(e,{name:t,lang:r});if(!i)return-1;const n=e.indexOf(i);return Ld.log("User audio track found, start loading by index=["+n+"]"),n}handleFragParsed(e,t){let{frag:r}=t;const{duration:i}=r;if(0===i&&this.state.controller.videoType===rp.VOD){const e=this.getHlsEncoderLevelDetails(),t=e?e.fragments:[];if(t[t.length-1]===r)return}(i<=0||i>=2*this.fragDuration)&&this.props.logEvent({event:"InvalidFragDuration",params:Gn(r)})}startLoadOnce(e){const{HLSEncoder:t}=this;!this.loadStarted&&void 0!==t&&this.state.controller.isOnline&&(t.levels&&t.levels.length>0?(t.startLoad(e),this.loadStarted=!0):t.once(Hls.Events.MANIFEST_PARSED,()=>{this.startLoadOnce(e)}))}getHlsEncoderLevelDetails(){const{HLSEncoder:e}=this;if(void 0===e)return;const{currentLevel:t,levels:r}=e;if(!r)return;const i=r[t];if(i&&i.details)return this.lastKnownLevelDetails=i.details,this.lastKnownLevelDetails;const n=r.find(e=>{let{details:t}=e;return Boolean(t)});if(n){const{details:e}=n;this.lastKnownLevelDetails=e}return this.lastKnownLevelDetails}computeRecoverJumpGap(){const{controller:{bufferingRanges:e}}=this.state,t=this.getCurrentTime();return Math.max(...e.map(e=>{let{end:t}=e;return t}))+1.1*this.fragDuration<t?(Ld.log("use 0 as recoverJumpGap",{currentTime:t,bufferingRanges:e}),Ll(0)):Ul(this.fragDuration,1.1)}computeRecoverPositionFromStartPosition(){const{startPosition:e}=this.state.controller,t={},r=this.computeRecoverJumpGap();return void 0!==e.utc&&e.utc>0&&(t.utc=xl(e.utc,r)),t.videoTime=xl(e.videoTime||Ll(0),r),t}computeRecoverPositionFromCurrentTime(){const e={},{lastRecoverPosition:t}=this.state.controller,r=this.getCurrentTime(),i=this.getUtcPosition(),n=this.computeRecoverJumpGap(),{utc:o=0,videoTime:a=0}=t||{};return(i>0||o>0)&&(e.utc=xl(Ll(Math.max(i,o)),n)),e.videoTime=xl(Ll(Math.max(r,a)),n),e}async recoverCurrentFrag(){const{lastRecoverPosition:e}=this.state.controller,t=this.getDuration()>0||void 0!==e?this.computeRecoverPositionFromCurrentTime():this.computeRecoverPositionFromStartPosition();this.playerStore.dispatch(Kc(t)),this.playerStore.dispatch(Mc(t)),await this.detachEncoder(),await this.attachEncoder()}attachMedia(){Ld.log("attachMedia");const{video:e,HLSEncoder:t}=this;if(void 0===t){const e=new Cd({code:ps.NO_HLS_JS_INSTANCE,isFatal:!1});return this.props.onError(e),Promise.reject(e)}const r=new Promise(e=>{t.once(Hls.Events.MEDIA_ATTACHED,()=>{window.performance&&n(performance.now)&&(this.HLSEncoderAttachTime=performance.now()),t.url||t.loadSource(this.getStreamUrl()),e()})});t.once(Hls.Events.MANIFEST_PARSED,()=>{if(this.loadStarted)return;const e=this.getStartLoadPosition();t.startLoad(e),this.loadStarted=!0,t.once(Hls.Events.LEVEL_UPDATED,(r,i)=>{let{details:n}=i;const o=this.getStartLoadPosition(n);o!==e&&void 0!==o&&t.streamController.startLoad(o)})});const i=t.levels&&t.levels.length>0?Promise.resolve():new Promise(e=>{t.once(Hls.Events.MANIFEST_PARSED,()=>{e()})});return mo(this.video,()=>{t.attachMedia(e)}),Promise.all([r,i]).then(()=>{})}onAudioTrackUpdated(e){const{HLSEncoder:t}=this;if(!t)return;const r=ao(t.audioTracks.find(t=>t.id===e));r&&this.emit("InternalAudioTrackValueChange",r.value)}getVideoType(){const e=this.getHlsEncoderLevelDetails();if(e)return yo(e);return(this.HLSEncoder&&this.HLSEncoder.levels||[]).some(e=>{let{details:t}=e;return Boolean(t&&t.live)})||this.getDuration()===1/0?rp.LIVE:rp.VOD}onLevelsUpdated(){const{sessionData:e={},levels:t=[]}=this.HLSEncoder||{};this.videoTrackLabels=function(e){const{VALUE:t=""}=e["com.yandex.video.labels.quality"]||{};return t.split(",").filter(Boolean).reduce((e,t)=>{const[r,i]=t.split(":");return void 0!==So(r)&&i&&e.set(r,i),e},new Map)}(e),this.maxHeightCapping=function(e){const{VALUE:t=""}=e["com.yandex.video.capping.maxheight"]||{},r=parseInt(t,10);return r>0?r:void 0}(e),this.emit("VideoTracksChange",fo(t,this.videoTrackLabels))}updateThumbnailTileMeta(){const{sessionData:e={}}=this.HLSEncoder||{},t=e=>{this.props.logEvent({event:e,params:void 0})},r=oo(e,ag.LOWRES,t),i=oo(e,ag.HIGHRES,t);if(void 0===i)return;const n=r?no(r,t):void 0,o=no(i,t),a=function(e){const{VALUE:t=""}=e["com.yandex.video.thumbnail.version"]||{};return parseFloat(t)||0}(e);this.props.onThumbnailTileGeneralMetaInfoChange({version:a,lowRes:n,highRes:o})}onEncoderError(e){const{details:t,type:r,url:i,frag:n}=e;if(!t)return;if((o=e).networkDetails&&423===o.networkDetails.status&&o.details===Hls.ErrorDetails.LEVEL_LOAD_ERROR){this.props.logEvent({event:Od.HlsJsForceCappingStart,params:{}});const{recoverHelper:n}=this;return void n.planTask(()=>this.recoverCurrentFrag(),{force:eo(e),reason:"HlsJs "+r,rawData:{details:t,type:r,url:i,isFatal:!1},delay:0})}var o;const a=Qn(e),s=Zn(e);if(void 0!==s&&(a||r===Hls.ErrorTypes.MEDIA_ERROR))if(this.recoverHelper.allowed&&!s.isFatal){if(this.props.onError(s),$n(e)){if(this.currentState!==Ql.BUFFERING&&function(e){const{details:t}=e;return!!t&&ig.includes(t)}(e))return void(this.recoverOnBufferingReason=e);let o;e.details===Hls.ErrorDetails.INTERNAL_EXCEPTION&&"demuxerWorker"===e.event?(Ef.setItem(ug.WAS_WORKER_INTERNAL_ERROR,"true"),o=()=>this.recoverStream()):o=()=>this.recoverCurrentFrag(),this.recoverHelper.planTask(o,{force:eo(e),reason:"HlsJs "+r,rawData:{details:t,type:r,url:i,isFatal:a,frag:Gn(n)},delay:1e3})}}else this.props.onError(new Cd(s,{isFatal:!0}))}getHlsTextTrack(e){if(this.HLSEncoder)return this.HLSEncoder.subtitleTracks.find(t=>e.value===String(t.id))}unsubscribePreloadSourceHandlers(){const{preloadSourceHLSEncoder:e}=this;e&&(this.preloadSourceHandlers.forEach(t=>{let[r,i]=t;e.off(r,i)}),this.preloadSourceHandlers.length=0)}clearPreloadSourceHlsEncoder(){this.preloadSourceHLSEncoder=void 0,this.preloadPosition={}}getStartLoadPosition(e){const{startPosition:t}=this.state.controller,{liveOffset:r}=this.props;return function(e){let{details:t,startPosition:r,liveOffset:i}=e,{videoTime:n}=r;if(void 0===t)return n;if(t.hasProgramDateTime&&Ao(r.utc)){const e=Bl(Nl(t.fragments[0].programDateTime),1e3);n=Fl(r.utc,e)}if(!Ao(n))return;const o=yo(t)===rp.VOD?0:i,[a]=t.fragments,s=void 0===a?0:a.start,l=t.totalduration-o;return Ll(c(n,s,l))}({details:e,startPosition:t,liveOffset:r})}startLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval),this.levelForcingInterval=window.setInterval(()=>{this.forceLevel()},1e3)}stopLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval)}forceLevel(){if(!this.HLSEncoder||!this.HLSEncoder.autoLevelEnabled||!this.HLSEncoder.levels||!this.HLSEncoder.levels.length)return;const{width:e,height:t,maxWidth:r,maxHeight:i}=this.getCapSizes(),n=Math.min(e,r||xg),o=Math.min(t,i||xg),a=Vl(Math.min(...[this.maxHeightCapping,o].filter(W))),{levels:s}=this.HLSEncoder,l=s.reduce((e,t,r)=>{if((t.height<e.smallestLevel.height||t.width<e.smallestLevel.width)&&(e.smallestLevel=t,e.smallestLevelIndex=r),t.height>a||t.width>n)return e;const i=(s[e.index]||{}).height||0;return t.height>i?Mo({},e,{index:r}):e},{index:-1,smallestLevel:s[0],smallestLevelIndex:0});this.HLSEncoder.autoLevelCapping=-1===l.index?l.smallestLevelIndex:l.index}}class Ug{static fromXHR(e){return new Ug(e)}constructor(e){this.status=void 0,this.status=e.status}isFatalError(){return this.isRegionLimitationError()||this.isSignatureExpiredError()}toPlayerError(){return new Cd({code:this.getErrorCode(),isFatal:this.isFatalError(),details:JSON.parse(he(this))})}isRegionLimitationError(){return 451===this.status}isSignatureExpiredError(){return eg.includes(this.status)}getErrorCode(){return this.isRegionLimitationError()?ps.REGIONAL_LIMITATION_MANIFEST:this.isSignatureExpiredError()?ps.SIGNATURE_EXPIRED_MANIFEST:ps.DEFAULT_ERROR}}const Bg=e=>u(e)&&m(ps,e),Hg=Nl(3e3);class Gg extends Vg{initInternalSubscribe(){super.initInternalSubscribe(),this.subscribeVideoBuffering();const e=G(()=>{this.emit("VideoTracksChange",jo(this.video.videoTracks)),this.emit("AudioTracksChange",Go(this.video.audioTracks)),this.emit("TextTracksChange",Wo(this.video.textTracks));const{videoHeight:e,videoWidth:t,videoTracks:r}=this.video,i=Yo(Ko({videoTracks:r,videoHeight:e,videoWidth:t}));i&&this.emit("InternalVideoTrackValueChange",i.value),this.setFirstAudioTrack()});this.initTextTracks(),this.once("CanPlay",e),this.once("Destroy",()=>{this.off("CanPlay",e)}),this.video.videoTracks&&(this.addEventListener(this.video.videoTracks,"addtrack",()=>{this.emit("VideoTracksChange",jo(this.video.videoTracks)),this.restoreUserVideoTrack()}),this.addEventListener(this.video.videoTracks,"removetrack",()=>{this.emit("VideoTracksChange",jo(this.video.videoTracks))}),this.addEventListener(this.video.videoTracks,"change",()=>{const{videoHeight:e,videoWidth:t,videoTracks:r}=this.video,i=Yo(Ko({videoTracks:r,videoHeight:e,videoWidth:t}));this.emit("InternalVideoTrackValueChange",i&&i.value)})),this.video.audioTracks&&(this.addEventListener(this.video.audioTracks,"addtrack",e=>{this.emit("AudioTracksChange",Go(this.video.audioTracks)),this.actualizeNativeAudioTrack(),this.restoreUserAudioTrack()}),this.addEventListener(this.video.audioTracks,"removetrack",()=>{this.emit("AudioTracksChange",Go(this.video.audioTracks)),this.actualizeNativeAudioTrack()}),this.addEventListener(this.video.audioTracks,"change",e=>{this.actualizeNativeAudioTrack(),this.saveUserAudioTrack(e)})),this.video.textTracks&&this.addEventListener(this.video.textTracks,"addtrack",()=>{this.emit("TextTracksChange",Wo(this.video.textTracks))}),this.addVideoEventListener("progress",()=>{const{videoType:e}=this.state.controller;e!==rp.LIVE&&e!==rp.EVENT||this.emit("DvrChange")}),this.subscribeCueChange()}constructor(e){super(e),this.props=e,this.serverTimeEstimator=void 0,this.estimatorPollingInterval=void 0,this.isRecoverablePlaylistHTTPStatus=!0,this.checkPlaylistHTTPStatusPromise=void 0,this.applyStartPosition=()=>{if(!this.canSeek())return;const e=this.getCurrentTime(),t=this.getStartPosition();W(t)&&e!==t&&this.seekInternal(t)},this.saveUserAudioTrack=e=>{if(!e.isTrusted)return;const t=Uo(this.video);t&&this.playerStore.dispatch(eu({name:t.name||void 0,lang:t.lang||void 0}))},this.actualizeNativeAudioTrack=()=>{const e=Uo(this.video);this.emit("InternalAudioTrackValueChange",e&&e.value)},this.notifyTextTracksChanged=()=>{const e=function(e,t){const{textTracks:r=[]}=e;for(let i=0;i<r.length;i++){const e=r[i];if(e&&Bo(e)&&e.mode===t)return Ho(e,i)}}(this.video,this.getVisibleTextTrackMode());this.emit("InternalTextTrackValueChange",e&&e.value)},this.playerStore.dispatch(qc(!0)),this.playerStore.dispatch(Xc(!0)),this.serverTimeEstimator=new Gv,this.estimateLatency(),this.on("VideoTypeChange",e=>{this.startLatencyPolling(e)}),this.on("Detach",()=>this.stopLatencyPolling()),this.once("Destroy",()=>this.stopLatencyPolling())}getServerTime(){const e=this.serverTimeEstimator.getServerTime();return e?Ll(e):void 0}setAudioTrack(e){if(""===e.value)return;const t=oe(this.props.video.audioTracks),r=t.find(t=>t.id===e.value);r&&t.forEach(e=>e.enabled=e.id===r.id)}setTextTrack(e){""!==e.value&&this.renderTextTrack(e.value)}disableTextTrack(){this.renderTextTrack(void 0)}renderTextTrack(e){Oo(this.video.textTracks).forEach((t,r)=>{t&&(Ho(t,r).value===e?t.mode=this.getVisibleTextTrackMode():t.mode=this.getHiddenTextTrackMode())})}seekInternal(e){kn(this.video,Ll(c(e,0,this.getDuration()||0)))}getSeekableRange(){const e=this.video.seekable;return{start:Ll(e.start(0)),end:Ll(e.end(e.length-1))}}getFragmentsData(){if(!this.isDvrEnabled()||!this.video||!this.video.seekable.length)return super.getFragmentsData();const{start:e,end:t}=this.getSeekableRange();return{totalDuration:Fl(t,e),fragmentDuration:Jh,startTime:e}}shouldSkipVideoTagError(e){return e.code!==zv.MEDIA_ERR_DECODE&&e.code!==zv.MEDIA_ERR_ENCRYPTED&&e.code!==zv.MEDIA_ERR_SRC_NOT_SUPPORTED||Er(this.state)}async onVideoTagError(){const e=Fn(this.video);if(this.shouldSkipVideoTagError(e))return;this.video.poster=od,this.checkPlaylistHTTPStatus();const t=!this.recoverHelper.allowed||!this.isRecoverablePlaylistHTTPStatus,r=new Cd({code:xo(e),details:e,isFatal:t});if(!t)return this.props.onError(r),void this.recoverHelper.planTask(()=>this.recoverStream(),{delay:500,reason:"VideoTagError ["+e.code+"]["+e.message+"]"});const i=await this.checkPlaylistHTTPStatusPromise;i&&i.isFatalError()?this.props.onError(i.toPlayerError()):this.props.onError(r)}onTick(e){super.onTick(e),this.isDvrEnabled()&&this.updateSkinDvrParameters(e)}async attachEncoder(){await super.attachEncoder();const e=e=>(this.props.onError(e),Promise.reject(s(e.code,this.state.ad.adblockDetected)));if(!("mp4"===$(Z(this.getStreamUrl().toLowerCase())))&&!jf.canPlayHlsOnNative())return e(new Cd({code:ps.NATIVE_HLS_NOT_SUPPORTED_ERROR}));const{video:t}=this;this.subscribeContentImpression();try{await this.initDrm(this.props.stream.drmConfig)}catch(i){return e(i)}const r=W(this.getStartPosition())?this.waitForStartPositionEstablished():void 0;this.initVideoTypeQualifier(),mo(t,()=>t.src=this.getStreamUrl()),void 0!==r&&await r,this.startLatencyPolling(this.state.controller.videoType)}getStreamUrl(){const e=this.getStartPosition();return Vo(super.getStreamUrl(),e)}onOnline(){}onOffline(){}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if(!W(e)&&!W(t))return;const r=this.getUtcStartTime();return r>0&&W(t)&&t>0?t-r:W(e)?e:void 0}checkPlaylistHTTPStatus(){this.checkPlaylistHTTPStatusPromise||(this.checkPlaylistHTTPStatusPromise=this.loadPlaylistInfo().then(Ug.fromXHR).then(e=>(this.isRecoverablePlaylistHTTPStatus=!e.isFatalError(),e)).catch(()=>{}))}estimateLatency(){const e=pl();Xe({url:this.getStreamUrl(),method:"HEAD",timeout:5e3}).then(t=>{this.serverTimeEstimator.parseServerTime({"x-server-time-ms":t.getResponseHeader("x-server-time-ms"),date:t.getResponseHeader("date")},pl()-e)},()=>{})}startLatencyPolling(e){this.estimatorPollingInterval||e!==rp.EVENT&&e!==rp.LIVE||(this.estimatorPollingInterval=window.setInterval(()=>this.estimateLatency(),1e4))}stopLatencyPolling(){clearInterval(this.estimatorPollingInterval),this.estimatorPollingInterval=void 0}initTextTracks(){let e=!1,t=!1;const{textTracks:r}=this.video;if(!r)return;const i=G(()=>{this.castTextTracksModeOnInit(),this.addEventListener(r,"change",this.notifyTextTracksChanged),this.notifyTextTracksChanged()}),n=()=>{e&&t&&i()};this.addEventListener(this.video,"loadedmetadata",()=>{e=!0,n()}),this.addEventListener(r,"addtrack",function(e,t,r,i){function n(){null!==o&&clearTimeout(o),o=null}3===arguments.length&&"boolean"!==typeof r&&(i=r,r=!1);let o=null;const a=function(){const a=arguments;i=i||this,r&&null===o&&e.apply(i,a),n(),o=window.setTimeout((function(){r||e.apply(i,a),o=null}),t)};return a.cancel=n,a}(()=>{t=!0,n()},0))}setFirstAudioTrack(){this.restoreUserAudioTrack();const e=Uo(this.video);e&&this.emit("InternalAudioTrackValueChange",e.value)}loadPlaylistInfo(){return Xe({method:"HEAD",url:this.getStreamUrl(),timeout:Hg,checkStatus:()=>!0})}subscribeCueChange(){const{textTracks:e}=this.video;if(!e||"function"!==typeof e.addEventListener)return;const t=e=>{const t=e.track;t&&"metadata"===t.kind&&(t.mode="hidden",this.addEventListener(t,"cuechange",e=>{const{activeCues:t}=e.target,{length:r}=t;if(!r)return;const i=t[r-1];if(!i)return;const{value:n,startTime:o,endTime:a}=i;if(!n)return;const s="number"===typeof a&&isFinite(a)?Fl(a,o):Jh,l=oe(t).map(e=>{if(e&&e.value){const{data:t}=e.value;if("string"===typeof t)return t}return""});this.emit("MetadataChange",{fragmentMetadataArray:l,fragmentStart:o,fragmentDuration:s,src:this.video.src})}))};e.addEventListener("addtrack",t),this.on("Destroy",()=>e.removeEventListener("addtrack",t))}castTextTracksModeOnInit(){if(this.state.skin.useNativeSubtitles)return;void 0!==Oo(this.video.textTracks).find(e=>Boolean(e&&"disabled"===e.mode))||Oo(this.video.textTracks).forEach(e=>{e&&(e.mode="showing"===e.mode?this.getVisibleTextTrackMode():this.getHiddenTextTrackMode())})}}class Wg extends Gg{constructor(e){super(e),this.props=e,this.engine=rf.MP4;const t=G(()=>{this.emit("VideoTracksChange",function(e){const{videoWidth:t,videoHeight:r}=e;return[{name:uo({width:Vl(t),height:Vl(r)}),value:"0",bitrate:zp,width:t,height:r}]}(e.video))});this.once("CanPlay",t),this.once("Destroy",()=>this.off("CanPlay",t))}async attachEncoder(){await super.attachEncoder(),Ld.log("mp4 native mode")}waitForStartPositionEstablished(){return new Promise((e,t)=>{const r=this.addVideoEventListener("durationchange",()=>{this.canSeek()&&(this.applyStartPosition(),r(),e())});this.once("Detach",()=>{r(),t()})})}initVideoTypeQualifier(){this.emit("VideoTypeChange",rp.VOD)}initDrm(){return Promise.resolve()}setVideoTrack(){}}const Yg=Ll(5*Math.random());let jg;!function(e){e.EXPIRED_SIGNATURE="EXPIRED_SIGNATURE"}(jg||(jg={}));const Kg={error:"",isFatal:!1};class qg{static convertToTextTrackCue(e){return shaka&&VTTCue?e.startTime>=e.endTime?null:new VTTCue(e.startTime,e.endTime,e.payload):null}static removeWhere(e,t){const r=e.mode;e.mode="hidden";const i=e.cues||[];for(let n=i.length-1;n>=0;n--){const r=i[n];r&&t(r)&&e.removeCue(r)}e.mode=r}constructor(e,t){this.useNativeSubtitles=t,this.textTrack=void 0,oe(e.textTracks).forEach(e=>{e.mode="disabled","StreamPlayerJs TextTrack"===e.label&&(this.textTrack=e)}),this.textTrack||(this.textTrack=e.addTextTrack("subtitles","StreamPlayerJs TextTrack")),this.textTrack.mode=this.hiddenMode()}remove(e,t){if(!this.textTrack||!shaka)return!1;return qg.removeWhere(this.textTrack,r=>r.startTime<t&&r.endTime>e),!0}append(e){if(!shaka||!this.isTextVisible()||!this.textTrack)return;const t=e.map(e=>{if(e.nestedCues.length){const t=e.nestedCues.map(e=>e.spacer?"\n":e.payload+" ").join("").replace(/ $/m,""),r=e.clone();return r.nestedCues=[],r.payload=t,r}return e}),r=[],i=this.textTrack.cues?Array.from(this.textTrack.cues):[];for(const n of t){if(!i.some(e=>e.startTime===n.startTime&&e.endTime===n.endTime&&e.text===n.payload)){const e=qg.convertToTextTrackCue(n);e&&r.push(e)}}r.slice().sort((e,t)=>e.startTime!==t.startTime?e.startTime-t.startTime:e.endTime!==t.endTime?e.endTime-t.startTime:r.indexOf(t)-r.indexOf(e)).forEach(e=>{this.textTrack.addCue(e)})}destroy(){if(this.textTrack){const e=e=>!0;qg.removeWhere(this.textTrack,e)}return this.textTrack=void 0,Promise.resolve()}isTextVisible(){return!!this.textTrack&&this.textTrack.mode!==this.hiddenMode()}setTextVisibility(e){this.textTrack&&(this.textTrack.mode=e?this.showingMode():this.hiddenMode())}hiddenMode(){return"disabled"}showingMode(){return wo(this.useNativeSubtitles())}}let Xg=!1;const zg={version:'Period>SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:version"]',uriTemplate:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:uri"]',tiles:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:tiles"]',spriteDuration:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:duration"]',resolution:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:resolution"]'},Qg={version:zg.version,uriTemplate:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:uri"]',tiles:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:tiles"]',spriteDuration:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:duration"]',resolution:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:resolution"]'},Jg=document.createElement("canvas"),Zg=Jg.getContext("2d"),$g=Nl(3e4);class em extends Ag{constructor(){super(),this.blacklist=new Set,this.destroyed=!1,this.checkLoopTimeoutId=void 0,this.startLoop(),this.once("Destroy",()=>{this.destroyed=!0})}destroy(){this.stopLoop(),super.destroy()}getBlacklist(){return Array.from(this.blacklist)}addHostname(e){cp.indexOf(e)>-1||this.blacklist.has(e)||this.blacklist.add(e)}isBlacklisted(e){return this.blacklist.has(e)}async checkBlacklistedHosts(){await Promise.all([...this.blacklist].map(async e=>{try{await ir(Ur(e)),this.blacklist.delete(e)}catch(t){}}))}startLoop(){this.destroyed||(this.checkLoopTimeoutId=setTimeout(async()=>{this.stopLoop(),await this.checkBlacklistedHosts(),this.startLoop()},$g))}stopLoop(){clearTimeout(this.checkLoopTimeoutId)}}const tm=Number.EPSILON||Math.pow(2,-52),rm=G(()=>{const e=bi("Chrome");if(void 0===e)return!0;const[t]=e;return t>70}),im=/^(ext-)?strm[^\.]+\.strm\.yandex\.net$/;class nm extends qv{constructor(e,t){super(),this.source=e,this.cacheData=t,this.addDestroyHandler(()=>{var e;null==(e=this.cacheData.segmentCache)||e.clear(),this.cacheData.loadedManifest=void 0,this.cacheData.cachedVariantTrack=void 0})}preload(){return Promise.resolve()}getBandwidthEstimate(){}copyCachedData(){var e;return{segmentCache:null==(e=this.cacheData.segmentCache)?void 0:e.copy(),loadedManifest:this.cacheData.loadedManifest}}getCachedVariantTrack(){return this.hasCachedSegments()?this.cacheData.cachedVariantTrack:void 0}getBufferedInfo(){return this.cacheData.bufferedInfo}getSource(){return this.source}getType(){return $p.Cache}getManifestXml(){return this.cacheData.manifestXml}hasManifest(){return void 0!==this.cacheData.loadedManifest}hasCachedSegments(){var e;return Boolean(null==(e=this.cacheData.segmentCache)?void 0:e.hasCachedData())}}const om=[429,500,502,503,504],am=Nl(1e3),sm=Ll(.001);class lm extends Vg{static fuzz(e,t){void 0===t&&(t=.5);return(e<10?2**e*100:6e4)*(1+(2*Math.random()-1)*t)}initInternalSubscribe(){super.initInternalSubscribe(),this.once("Destroy",()=>this.chunkHostnameBlacklist.destroy()),this.once("Destroy",()=>this.stopShakaConfigAutoUpdate()),this.once("Destroy",()=>{var e;return null==(e=this.customNetworkingEngine)?void 0:e.destroy()}),this.once("Destroy",()=>{var e;return null==(e=this.preloader)?void 0:e.destroy()});const e=e=>{Sn(this.shakaPlayer)&&this.shakaPlayer.setTextTrackVisibility(Boolean(e))};this.on("InternalTextTrackValueChange",e),this.once("Destroy",()=>this.off("InternalTextTrackValueChange",e)),this.addEventListener(this.video,"play",this.updateBufferingState),this.on("VideoTypeChange",e=>{if(void 0===e)return;this.shakaPlayer&&this.setShakaAvailabilityWindowOverride(this.shakaPlayer);const t=e===rp.VOD;this.setNativeTimeControlVisibility(t),this.setNativeTimelineControlVisibility(t)})}constructor(e,i){super(e),this.preloader=i,this.engine=rf.MPD,this.shakaPlayer=void 0,this.chunkHostnameBlacklist=new em,this.shakaConfigAutoUpdateInterval=void 0,this.manifestXML=void 0,this.initMpdEncoderPromise=void 0,this.detachMpdEncoderCalled=!1,this.useNativeSubtitles=!1,this.customNetworkingEngine=void 0,this.lastTrackBeforeDetach=void 0,this.preloadedTrack=void 0,this.isPauseCalled=!1,this.attempt=0,this.playingStateBeforeLoadShakaSource=void 0,this.abrManager=void 0,this.abrRestrictionsHelper=new Vv({getManifestXml:()=>this.manifestXML,getState:()=>this.state,getCapSizes:()=>this.getCapSizes()}),this.updateBufferGoal=()=>{this.updateShakaConfig()},this.shakaFailureCallback=e=>{const t=lm.fuzz(this.attempt++),{clear:r,promise:i}=Yl(t);this.once("Detach",r),i.then(()=>{var e;null==(e=this.shakaPlayer)||e.retryStreaming(),this.off("Detach",r)})},this.shakaHTTPRequestFilter=(e,t)=>r(()=>this.shakaHTTPRequestFilterInternal(e,t),this.onShakaFilterError),this.shakaHTTPRequestFilterInternal=(e,t)=>{if("undefined"!==typeof shaka)switch(t.allowCrossSiteCredentials=this.withCredentials,e){case shaka.net.NetworkingEngine.RequestType.SEGMENT:ea(t,this.getRemainingBufferedTime());const{uris:e}=t,r=e.filter(e=>{const{hostname:t}=K(e);return!this.chunkHostnameBlacklist.isBlacklisted(t)});if(0===r.length)break;t.uris=r}},this.shakaPreviewsHTTPResponseFilter=(e,t)=>r(()=>this.shakaPreviewsHTTPResponseFilterInternal(e,t),this.onShakaFilterError),this.shakaPreviewsHTTPResponseFilterInternal=(e,t)=>{if(void 0===shaka)return;if(e!==shaka.net.NetworkingEngine.RequestType.MANIFEST)return;if(!t.data)return;const r=t.fromCache&&this.manifestXML||Mn(e,t);if(!r)return;this.manifestXML&&this.checkRepresentationChange(this.manifestXML,r),this.manifestXML=r,this.videoTrackLabels=function(e){const t=new Map;return oe(e.querySelectorAll('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:labels:quality"]')).forEach(e=>{const r=e.getAttribute("value");if(!r)return;r.split(",").filter(Boolean).forEach(e=>{const[r,i]=e.split(":");void 0!==So(r)&&i&&t.set(r,i)})}),t}(r);const i=Zo(r,ag.LOWRES),n=Zo(r,ag.HIGHRES),o={version:function(e){const t=e.querySelector('AdaptationSet[mimeType="image/jpeg"] SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:version"]');return t?parseFloat(t.getAttribute("value")||""):0}(r),lowRes:i,highRes:n};o.highRes&&this.props.onThumbnailTileGeneralMetaInfoChange(o)},this.updateBufferingState=()=>{if(Er(this.state))return;const{shakaPlayer:e}=this;if(void 0===e)return;if(function(e){if(!e.isBuffering())return!1;const t=Dn(e);if(!(t===rp.LIVE||t===rp.EVENT))return!1;const r=e.getMediaElement();if(!r)return!1;const{currentTime:i}=r,n=wn(e);if(0===n)return!1;const o=i+n/2,a=On(e,Ll(i)),s=On(e,Ll(o));return Boolean(a&&!s)}(e)){const e=qt(kd.LiveEdge,void 0);this.props.onExpectedStalledChange(e)}const t=this.computeVideoPlayingState(e);this.emit("InternalPlayingStateChange",t)},this.onShakaAdaptationEvent=()=>{this.actualizeAvailableVariantTracks(),this.actualizeActiveVariantTrack()},this.onShakaEmsgEvent=e=>{if(Ld.log("-> Shaka EmsgEvent",e),!d(e)||!d(e.detail)||!d(e.detail.messageData))return;const{startTime:t,messageData:r}=e.detail,i=(0,Jv.parseV2Tag)(r);i&&i.writer&&this.emit("MetadataChange",{fragmentMetadataArray:[i.writer],fragmentStart:t,fragmentDuration:wn(this.shakaPlayer,t),src:this.getStreamUrl()})},this.reportLargeGap=e=>{Ld.log("-> Shaka LargeGapEvent",e),this.props.logEvent({event:"MpdLargeGap",params:{currentTime:e.currentTime,gapSize:e.gapSize}})},this.actualizeTracks=()=>{Sn(this.shakaPlayer)&&(this.actualizeAvailableTracks(),this.actualizeActiveTracks())},this.onShakaErrorEvent=e=>{if(!shaka||!e)return;const{detail:t}=e;this.onShakaError(t);const r=Qo(shaka,t);r&&r.isFatal&&this.shakaPlayer&&(this.shakaPlayer.destroy(),this.shakaPlayer=void 0)},this.onShakaError=e=>{if(!shaka)return;Ld.error("-> onShakaError",e);const t=function(e,t,r){let{code:i}=t;return i===e.util.Error.Code.VIDEO_ERROR&&r.controller.watchedTime>0}(shaka,e,this.state)&&this.recoverHelper.allowed,r=function(e,t,r){let{code:i,data:n}=t;return i===e.util.Error.Code.BAD_HTTP_STATUS?om.indexOf(n[1])>-1:n[2]===e.net.NetworkingEngine.RequestType.MANIFEST||i!==e.util.Error.Code.HTTP_ERROR?i===e.util.Error.Code.TIMEOUT:r<=10}(shaka,e,this.attempt);(t||r)&&(e.severity=shaka.util.Error.Severity.RECOVERABLE);const i=Qo(shaka,e);i&&(t&&this.recoverHelper.planTask(()=>this.recoverStream(),{delay:0,reason:i.code}),this.checkDeadChunkServer(e),this.props.onError(i))},this.onShakaFilterError=e=>{if(shaka){if(Ld.error("-> onShakaFilterError",e),Jo(e))return this.onShakaError(e);this.props.onError(new Cd({code:ps.SHAKA_FILTER_ERROR,message:e.message,isFatal:!1,stack:e.stack}))}},this.onShakaNetworkSuccess=e=>{if(this.attempt=0,shaka&&e===shaka.net.NetworkingEngine.RequestType.MANIFEST){const{videoType:e}=this.state.controller;e!==rp.LIVE&&e!==rp.EVENT||this.emit("DvrChange")}},this.onShakaNetworkError=(e,t)=>{if("undefined"===typeof shaka||void 0===this.shakaPlayer)return;const r=qo(shaka,t);451===r||eg.includes(r)?t.severity=shaka.util.Error.Severity.CRITICAL:this.onShakaError(t)},this.parseTextTrack=e=>{let{label:t,language:r,originalTextId:i}=e;const n=na(this.manifestXML,i)||r;return{name:t||n||i,value:i,lang:n}},function(e){try{if(!navigator.requestMediaKeySystemAccess)return;const t=sa(e);if(t===window)return;if(!t.navigator.requestMediaKeySystemAccess)return;navigator.requestMediaKeySystemAccess=function(){return t.navigator.requestMediaKeySystemAccess(...arguments)}}catch(t){}}(this.video),t(vn()),i&&i.isDestroyed&&(this.preloader=void 0),this.video.classList.add(Rg().video_hiddenSubtitlesBtn),this.playerStore.dispatch(qc(!0)),function(){if(!Xg&&(Xg=!0,window.MediaKeySession)){const{prototype:e}=window.MediaKeySession,{close:t}=e;e.close=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return Promise.race([t.call(this,r),Yl(200).promise])}}}(),this.useNativeSubtitles=this.state.skin.useNativeSubtitles}getMaxCapAllowedVideoTrack(){var e;const t=null==(e=this.abrManager)?void 0:e.getMaxCapAllowedVideoTrack();if(void 0!==t)return this.state.controller.videoTracks.find(e=>{let{value:r}=e;return r===t.originalId})}getFragmentsData(){const{start:e=Ll(0),end:t=Ll(0)}=void 0===this.shakaPlayer?{}:this.shakaPlayer.seekRange();return{totalDuration:Fl(t,e),fragmentDuration:wn(this.shakaPlayer),startTime:e}}onOnline(){}onOffline(){}getUtcStartTime(){const e=Nn(this.shakaPlayer,this.manifestXML);return void 0===e?super.getUtcStartTime():e}getUtcPosition(){const e=function(e,t){if(void 0===e)return;const r=Nn(e,t);if(void 0===r)return;const i=e.getMediaElement();return i?xl(r,Ll(i.currentTime)):void 0}(this.shakaPlayer,this.manifestXML);return void 0===e?super.getUtcPosition():e}setVideoTrack(e){var t;let{value:r}=e;if(void 0===this.shakaPlayer)return;if("auto"===r)return void this.setAbrEnabled(!0);const i=Rn(this.shakaPlayer);if(void 0===i)return;const n=ia(null==(t=this.abrManager)?void 0:t.getVariants(),r,i.originalAudioId),o=this.shakaPlayer.getVariantTracks().find(e=>e.id===n);void 0!==o&&(this.setAbrEnabled(!1),this.setVariantTrack(o))}setAudioTrack(e){let{lang:t,value:r}=e;if(void 0===this.shakaPlayer)return;const i=Rn(this.shakaPlayer);if(void 0===i)return;const n=this.shakaPlayer.getVariantTracks().find(e=>{const t=e.originalAudioId===r,n=e.originalVideoId===i.originalVideoId;return t&&n});if(!i||!n)return void this.shakaPlayer.selectAudioLanguage(t);const{height:o,videoBandwidth:a}=i,{language:s}=n;this.setVariantTrack(this.shakaPlayer.getVariantTracks().find(e=>e.height===o&&e.videoBandwidth===a&&e.language===s))}setTextTrack(e){let{value:t}=e;if(!this.shakaPlayer)return;const r=this.shakaPlayer.getTextTracks().find(e=>{let{originalTextId:r}=e;return r===t});r&&(this.shakaPlayer.selectTextTrack(r),this.emit("InternalTextTrackValueChange",t))}disableTextTrack(){this.shakaPlayer&&this.emit("InternalTextTrackValueChange",void 0)}toggleNativeSubtitles(e){super.toggleNativeSubtitles(e),this.useNativeSubtitles=e}captureScreenshot(e){return(e=>{if(!Zg)return Promise.reject();Jg.width=e.videoWidth,Jg.height=e.videoHeight;try{Zg.drawImage(e,0,0,e.videoWidth,e.videoHeight)}catch(t){return Promise.reject(t)}return new Promise((e,r)=>{try{Jg.toBlob(t=>{e(t)},"image/jpeg")}catch(t){r(t)}})})(e).then(e=>{this.previousScreenshotBlobUrl=URL.createObjectURL(e)}).catch(()=>{this.previousScreenshotBlobUrl=void 0}).then(()=>this.previousScreenshotBlobUrl)}onVideoTagError(e){super.onVideoTagError(e),Ld.log("-> onVideoTagError",e)}getDuration(){return Sn(this.shakaPlayer)?this.shakaPlayer.seekRange().end:Ll(NaN)}async requestDebugInfo(){var e;return this.shakaPlayer?{manifest:null!=(e=r(()=>{var e;return null==(e=this.manifestXML)?void 0:e.documentElement.outerHTML}))?e:null,shakaPlayerStats:this.shakaPlayer.getStats()}:{noShakaPlayer:!0}}async preloadSource(){var e;await vn();if(this.isDestroyed||this.preloader&&!this.preloader.isDestroyed||void 0!==this.initMpdEncoderPromise||void 0!==this.shakaPlayer||!shaka.Player.isBrowserSupported()||(null==(e=this.customNetworkingEngine)?void 0:e.hasCachedData()))return;const t=new Xv({source:this.props,getState:()=>this.state,getCapSizes:()=>this.getCapSizes(),type:$p.Internal});this.preloader=t,t.addDestroyHandler(()=>this.preloader=void 0);const r=t.getVideoElement(),i=g(r,"canplay",()=>{this.captureScreenshot(r).then(()=>{this.props.setPlayerBackgroundImage(this.previousScreenshotBlobUrl),this.props.setPlayerBackgroundVisibility(!1)})},{once:!0});this.once("ContentImpression",i),this.once("Destroy",i),await t.preload()}createCachePreloader(){if(this.customNetworkingEngine)return new nm({stream:this.props.stream,sourceParams:this.props.sourceParams},la({},this.customNetworkingEngine.copyCachedData(),{cachedVariantTrack:this.customNetworkingEngine.getCurrentVariantTrack(),manifestXml:this.manifestXML,bufferedInfo:void 0===this.shakaPlayer?{total:[],audio:[],video:[]}:this.shakaPlayer.getBufferedInfo()}))}getSeekableRange(){const{start:e,end:t}=Sn(this.shakaPlayer)?this.shakaPlayer.seekRange():{start:Ll(0),end:Ll(0)};return{start:e,end:Ll(Math.min(t,Fl(this.getDuration(),sm)||0))}}canSeek(){return Sn(this.shakaPlayer)&&super.canSeek()}onTick(e){void 0!==this.shakaPlayer&&Sn(this.shakaPlayer)&&!1===this.shakaPlayer.isLive()&&void 0!==this.state.controller.videoType&&this.state.controller.videoType!==rp.VOD&&this.emit("VideoTypeChange",rp.VOD),super.onTick(e)}getStreamUrl(){const e=super.getStreamUrl(),t={audio_mbr:"1",mburl:"1"};return Un(e)||(t.preview="1"),Vg.isLiveStreamUrl(e)&&(t.packager="1",t.lowlatency="1"),J(e,t,{saveOriginalPath:!0})}getMaxBufferLength(){const e=Dn(this.shakaPlayer);return!(e===rp.LIVE||e===rp.EVENT)||this.shouldUseLowBuffer()||this.isLowLatencyLive()?super.getMaxBufferLength():this.props.liveOffset}async detachEncoder(){this.detachMpdEncoderCalled=!0;const e=Rn(this.shakaPlayer);this.lastTrackBeforeDetach=e||void 0,await super.detachEncoder(),this.manifestXML=void 0;const{video:t,shakaPlayer:r}=this;t.classList.remove(Rg().video_hiddenSubtitlesBtn),this.stopShakaConfigAutoUpdate(),void 0!==r&&await this.preventPauseAsync(t,()=>(this.shakaPlayer=void 0,r.destroy())),p(window.VTTCue)||delete window.VTTCue}async attachEncoder(){this.detachMpdEncoderCalled=!1,await super.attachEncoder(),this.initMpdEncoderPromise=this.initMpdEncoder(),await this.initMpdEncoderPromise,this.initMpdEncoderPromise=void 0}getBandwidthEstimate(){var e,t;const r=null==(e=this.preloader)?void 0:e.getBandwidthEstimate();if(r&&W(r.value))return r;const i=null==(t=this.shakaPlayer)?void 0:t.getStats(),{estimatedBandwidth:n,estimatedBandwidthSource:o}=i||{};return n?{value:n,source:o}:super.getBandwidthEstimate()}getServerTime(){var e;const t=null==(e=this.customNetworkingEngine)?void 0:e.getServerTime();return t?Ll(t):void 0}getRemainingBufferedTime(){if(!Sn(this.shakaPlayer))return super.getRemainingBufferedTime();const{currentTime:e}=this.state.controller,{audio:t,video:r,total:i}=this.shakaPlayer.getBufferedInfo();return{total:Wr(i,e)||Ll(0),video:Wr(r,e)||Ll(0),audio:Wr(t,e)||Ll(0)}}getSegmentSize(){if(!Sn(this.shakaPlayer))return;const e=this.shakaPlayer.getStreamForTime(this.getCurrentTime());if(!e)return;const{stream:{width:t,height:r}}=e;return t&&r?{width:t,height:r}:void 0}getUtcEndTime(){if(Dn(this.shakaPlayer)===rp.LIVE)return this.getSeekableRange().end;const e=this.getUtcStartTime();return e?xl(e,this.getDuration()):Ll(0)}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e!==rp.LIVE)return super.calculateDVRParams();const{fragmentDuration:t,startTime:r,totalDuration:i}=this.getFragmentsData(),n=Ul(t,1);return{fragmentDuration:t,dvrStartTime:r,dvrDuration:i,skinDVRStartTime:xl(n,r),skinDVRDuration:Fl(i,n)}}handleVideoElementPlayEvent(){var e;null!=(e=this.shakaPlayer)&&e.isBuffering()||super.handleVideoElementPlayEvent()}onVideoResize(){super.onVideoResize(),this.actualizeActiveVariantTrack()}async recoverStream(){return 1===this.recoverHelper.attempt&&this.captureScreenshot(this.props.video).then(()=>{this.handleBackgroundBeforeRecover()}),super.recoverStream()}async play(){if(this.isPauseCalled=!1,this.initMpdEncoderPromise&&await this.initMpdEncoderPromise,this.isPauseCalled)throw new Error("Pause called during play");await super.play()}pause(){this.isPauseCalled=!0,super.pause()}handleBackgroundBeforeRecover(){this.props.setPlayerBackgroundImage(this.previousScreenshotBlobUrl),this.once("CanPlay",()=>{this.props.setPlayerBackgroundImage(),this.clearScreenshot()})}async initMpdEncoder(){var e,t,r,i;try{await vn()}catch(l){const e=new Cd(l,{code:ps.MPD_SHAKA_INIT_ERROR});throw this.props.onError(e),e}if(this.detachMpdEncoderCalled)return;const n=mo(this.video,()=>new shaka.Player(this.video));this.shakaPlayer=n,this.customNetworkingEngine=this.customNetworkingEngine||new Wv(null==(e=this.preloader)?void 0:e.copyCachedData()),this.customNetworkingEngine.setup(n,this.onShakaNetworkSuccess,this.onShakaNetworkError),this.playerStore.dispatch(Au(void 0===this.preloader?void 0:{preloadingMethod:this.preloader.getType(),preloaded:this.preloader.preloaded})),this.manifestXML=null==(t=this.preloader)?void 0:t.getManifestXml(),this.preloadedTrack=null==(r=this.preloader)?void 0:r.getCachedVariantTrack(),null==(i=this.preloader)||i.destroy(),this.preloader=void 0,this.subscribeContentImpression(),this.attachShakaEventListeners(n);const o=n.getNetworkingEngine();this.customNetworkingEngine.registerRequestFilter(this.shakaHTTPRequestFilter),o.registerResponseFilter(this.shakaPreviewsHTTPResponseFilter);const{video:a}=this,s=()=>this.useNativeSubtitles;this.configureShaka(n,la({},this.getInitialShakaConfig(),{textDisplayFactory:function(){return new qg(a,s)}}));try{if(await this.preventPauseAsync(this.video,async()=>{this.playingStateBeforeLoadShakaSource=this.state.controller.playingState,await Vn({shakaPlayer:n,streamUrl:this.getStreamUrl(),startPosition:this.state.controller.startPosition}),this.playingStateBeforeLoadShakaSource=void 0}),this.preloadedTrack=void 0,this.detachMpdEncoderCalled)return;this.initShakaConfigAutoUpdate(),this.lastTrackBeforeDetach=void 0}catch(l){if(this.playingStateBeforeLoadShakaSource=void 0,this.detachMpdEncoderCalled)return;if(Jo(l))return void this.onShakaError(l);this.props.onError(new Cd(l,{code:ps.SHAKA_LOAD_SOURCE_ERROR,isFatal:!0}))}}findPreloadedVariant(e){var t;const r=this.preloadedTrack||this.lastTrackBeforeDetach;if(void 0!==r&&null!=(t=this.customNetworkingEngine)&&t.hasCachedSegments())return e.find(e=>{let{video:t,audio:i}=e;const n=!t||t.originalId===r.originalVideoId,o=!i||i.originalId===r.originalAudioId;return n&&o})}getPlaybackRate(){return this.state.controller.playbackRate}getInitialShakaConfig(){var e;const t=this.getBandwidthEstimate(),r=this.abrManager=new Lv({getPlaybackRate:this.getPlaybackRate.bind(this),bandwidthEstimateOffset:null!=(e=this.props.bandwidthEstimateOffset)?e:wl(0),getSegmentDuration:()=>wn(this.shakaPlayer),getFilterParams:e=>({preloadedVariant:this.findPreloadedVariant(e),restrictions:this.abrRestrictionsHelper.getAbrRestrictions()}),isLowLatencyLive:()=>this.isLowLatencyLive()});return la({},cv,{abr:la({},cv.abr,null!=t&&t.value?{defaultBandwidthEstimate:t.value,defaultBandwidthEstimateSource:t.source}:{}),abrFactory:function(){return r},streaming:la({},cv.streaming,{bufferingGoal:this.getMaxBufferLength(),failureCallback:this.shakaFailureCallback})})}attachShakaEventListeners(e){e.addEventListener("buffering",this.updateBufferingState),e.addEventListener("error",this.onShakaErrorEvent),e.addEventListener("adaptation",this.onShakaAdaptationEvent),e.addEventListener("trackschanged",this.actualizeTracks),e.addEventListener("emsg",this.onShakaEmsgEvent),e.addEventListener("largegap",this.reportLargeGap),e.addEventListener("variantchanged",()=>{this.tryToUpdateStreamingParameters()}),e.addEventListener("trackschanged",()=>{this.tryToUpdateStreamingParameters()}),e.addEventListener("manifestparsed",()=>{this.onManifestParsed(e),this.updateShakaConfig();const t=this.getBandwidthEstimate();W(t.value)&&this.configureShaka(e,{abr:{defaultBandwidthEstimate:t.value,defaultBandwidthEstimateSource:t.source}})}),e.addEventListener("trackschanged",G(this.restoreUserTracks))}tryToUpdateVideoType(){const e=Dn(this.shakaPlayer);e&&e!==this.state.controller.videoType&&this.emit("VideoTypeChange",e)}tryToUpdateProgramDateTime(){const e=Nn(this.shakaPlayer,this.manifestXML),t=void 0===e?void 0:Ul(e,1e3);void 0!==t&&t!==this.state.controller.programDateTime&&this.emit("ProgramDateTimeChange",t)}tryToUpdateStreamingParameters(){this.tryToUpdateVideoType(),this.tryToUpdateProgramDateTime()}onManifestParsed(e){this.tryToUpdateStreamingParameters(),this.setShakaAvailabilityWindowOverride(e),this.setPresentationTimelineDelay(e)}isLowLatencyLive(){var e,t;return Boolean(null==(e=this.shakaPlayer)?void 0:e.isLive())&&Boolean(null==(t=this.manifestXML)?void 0:t.querySelector("[availabilityTimeOffset]"))}setPresentationTimelineDelay(e){var t;const r=e.getManifest();if(!r)return;const i=null==(t=this.customNetworkingEngine)?void 0:t.getServerTime();void 0!==i&&r.presentationTimeline.setClockOffset(i-Date.now());const n=this.isLowLatencyLive()?0:this.props.liveOffset+Yg;r.presentationTimeline.setDelay(n)}setShakaAvailabilityWindowOverride(e){const t=Dn(e);if(void 0===t)return;const r=t===rp.EVENT?1/0:NaN,{manifest:{availabilityWindowOverride:i}}=e.getConfiguration();r===i||isNaN(r)&&isNaN(i)||this.configureShaka(e,{manifest:{availabilityWindowOverride:r}})}setVariantTrack(e){void 0!==this.shakaPlayer&&void 0!==e&&(this.shakaPlayer.selectVariantTrack(e,!0),this.actualizeTracks())}setAbrEnabled(e){var t;void 0!==this.shakaPlayer&&(null==(t=this.shakaPlayer.getConfiguration().abr)?void 0:t.enabled)!==e&&(this.configureShaka(this.shakaPlayer,{abr:{enabled:e}}),this.updateShakaConfig())}actualizeActiveTracks(){this.actualizeActiveVariantTrack(),this.actualizeActiveTextTrack()}actualizeActiveVariantTrack(){const e=Rn(this.shakaPlayer);if(void 0===e)return;const{originalAudioId:t,originalVideoId:r}=e;this.emit("InternalVideoTrackValueChange",r),this.emit("InternalAudioTrackValueChange",t)}actualizeActiveTextTrack(){if(void 0===this.shakaPlayer)return;const{controller:{textTrackEnabled:e}}=this.state,t=this.getCurrentInternalTextTrack();this.emit("InternalTextTrackValueChange",void 0!==t&&e?this.parseTextTrack(t).value:void 0)}actualizeAvailableTracks(){this.actualizeAvailableTextTracks(),this.actualizeAvailableVariantTracks()}actualizeAvailableTextTracks(){const e=this.getAvailableTextTracks();this.video.classList.toggle(Rg().video_hiddenSubtitlesBtn,0===e.length),this.emit("TextTracksChange",e)}getAvailableTextTracks(){return this.shakaPlayer?this.shakaPlayer.getTextTracks().map(this.parseTextTrack):[]}actualizeAvailableVariantTracks(){const e=Rn(this.shakaPlayer);if(!e)return;const t=bn(this.shakaPlayer);if(!t)return;const r=t.variants;if(!Array.isArray(r))return;const i={},n={};r.forEach(t=>{const r=t.video,o=t.audio;if(!o||o.originalId===e.originalAudioId){const t=((e,t)=>{const{bandwidth:r,width:i,height:n,originalId:o}=e;return{name:oa(e,t),value:o,width:i,height:n,bitrate:r?Bl(wl(r),1e3):zp}})(r,this.videoTrackLabels),{name:n=String(t.height)||""}=t;(void 0===i[n]||t.value===e.originalVideoId||i[n].value!==e.originalAudioId&&i[n].bitrate<t.bitrate)&&(i[n]=t)}if(o&&r.originalId===e.originalVideoId){const t=function(e){let{manifestXml:t,audioStream:{label:r,language:i,originalId:n,bandwidth:o}}=e;const a=na(t,n)||i;return{name:r||a||n,value:n,lang:a,bitrate:kl(o?o/1e3:zp)}}({manifestXml:this.manifestXML,audioStream:o}),{name:r}=t;(void 0===n[r]||t.value===e.originalAudioId||n[r].value!==e.originalAudioId&&n[r].bitrate<t.bitrate)&&(n[r]=t)}}),this.emit("VideoTracksChange",Ii(i)),this.emit("AudioTracksChange",Ii(n))}getCurrentInternalTextTrack(){return void 0===this.shakaPlayer?void 0:this.shakaPlayer.getTextTracks().find(xv)}checkDeadChunkServer(e){if(!shaka)return;if(!Jt(this.getStreamUrl()))return;const{code:t,data:r}=e;if(!(t===shaka.util.Error.Code.BAD_HTTP_STATUS||t===shaka.util.Error.Code.HTTP_ERROR||t===shaka.util.Error.Code.TIMEOUT))return;const[i]=r,n=r[r.length-1];if("string"===typeof i&&n===shaka.net.NetworkingEngine.RequestType.SEGMENT){const{hostname:e}=K(i);this.chunkHostnameBlacklist.addHostname(e)}}initShakaConfigAutoUpdate(){this.stopShakaConfigAutoUpdate(),this.shakaConfigAutoUpdateInterval=window.setInterval(()=>{this.updateShakaConfig()},am)}updateShakaConfig(){const{shakaPlayer:e}=this;if(void 0!==e)try{const t=this.getMaxBufferLength();if(e.getConfiguration().streaming.bufferingGoal===t)return;this.configureShaka(e,{streaming:{bufferingGoal:t}})}catch(t){}}stopShakaConfigAutoUpdate(){clearInterval(this.shakaConfigAutoUpdateInterval)}configureShaka(e,t){try{e.configure(t)}catch(r){this.props.onError(new Cd(r,{isFatal:!1,code:ps.SHAKA_CONFIGURE_ERROR}))}}checkRepresentationChange(e,t){if(function(e,t){const r=ra(e),i=ra(t);return Vp()(r,i)}(e,t))return;this.props.onExpectedStalledChange(qt(kd.RepresentationsChange,void 0));const r=new Cd({isFatal:!1,code:ps.REPRESENTATION_CHANGE});this.props.onError(r),this.recoverStream()}computeVideoPlayingState(e){const t=e.isBuffering();return void 0===this.playingStateBeforeLoadShakaSource?ko(this.video,t):this.playingStateBeforeLoadShakaSource===Ql.PAUSE?Ql.PAUSE:t?Ql.BUFFERING:Ql.PLAY}}const dm=function(e){if(void 0===e&&(e=window),ie(e)&&e.navigator){const{platform:t}=e.navigator;if(t&&/iP(hone|od|ad)/.test(t)){const t=e.navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if(t)return parseInt(t[1],10)}}return-1}();class cm extends Ad{constructor(e){super(),this.video=void 0,this.unsubscribers=[],this.isStrmCatchUpStream=void 0,this.seekableEndFifo=new Fv(2),this.destroy=()=>{w(this.unsubscribers)},this.handleProgressEvent=()=>{if(!this.video||!this.video.seekable.length)return;const e=this.video.seekable,t=Ll(e.end(e.length-1)),r=this.seekableEndFifo.getAll();t!==r[r.length-1]&&(this.seekableEndFifo.push(t),this.updateVideoType())},this.updateVideoType=()=>{this.emit("VideoTypeChange",this.getVideoType())},this.isStrmCatchUpStream=function(e){if(!Jt(e))return!1;const t=X(K(e).search);return Boolean(t.start)}(e)}setHTMLVideoElement(e){this.destroy(),this.video=e,this.unsubscribers.push(g(e,"timeupdate",this.updateVideoType)),this.unsubscribers.push(g(e,"durationchange",this.updateVideoType)),this.unsubscribers.push(g(e,"progress",this.handleProgressEvent))}getVideoType(){if(!this.video||isFinite(this.video.duration))return rp.VOD;if(this.isStrmCatchUpStream)return rp.EVENT;const e=this.seekableEndFifo.getAll();if(!this.video.seekable.length||e.length<2)return rp.LIVE;const t=this.video.seekable.start(0);return e[1]>e[0]&&t?rp.LIVE:rp.EVENT}}const um=["loadstart","progress","durationchange","loadedmetadata","loadeddata","canplay","playing"];class hm extends Gg{initInternalSubscribe(){super.initInternalSubscribe(),this.recoverIosSleepMode(),this.activateVideoTagIosWorkaround()}constructor(e){super(e),this.props=e,this.engine=rf.NATIVE,this.isLowLatencyLiveStream=!1}getUtcStartTime(){const e=this.video;if(!this.video.src||0===e.readyState||"function"!==typeof e.getStartDate)return super.getUtcPosition();const t=e.getStartDate();if(!t||"function"!==typeof t.getTime)return super.getUtcPosition();const r=Nl(t.getTime());return isNaN(r)?super.getUtcPosition():Bl(r,1e3)}getUtcPosition(){const e=this.getUtcStartTime();return e>0?xl(e,this.getCurrentTime()):super.getUtcPosition()}async attachEncoder(){this.emit("BufferingRangesChange",[]),await super.attachEncoder(),Ld.log("hls native mode")}async detachEncoder(){await super.detachEncoder(),this.video.src&&this.video.removeAttribute("src")}shouldSkipVideoTagError(e){return super.shouldSkipVideoTagError(e)}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if(W(e)||W(t)){if(this.state.controller.videoType===rp.LIVE){const e=this.getUtcStartTime();if(e>0&&W(t)&&t>0)return t-e}return W(e)?e:void 0}}waitForStartPositionEstablished(){return new Promise((e,t)=>{const r=[];um.forEach(t=>{r.push(this.addVideoEventListener(t,()=>{this.canSeek()&&(this.applyStartPosition(),w(r),e())},{once:!0}))}),this.once("Detach",()=>{w(r),t()})})}isDvrEnabled(){if(jf.isSmartTV())return!1;if(jf.isSafariDesktop())return!0;const{controller:{isFullscreen:e},skin:{nativeControlsVisibility:t}}=this.state;return!e&&!t}setVideoTrack(){Ld.log("Unable to set video track on native encoder")}getBandwidthEstimate(){return{value:wl(NaN),source:"default"}}async initDrm(){}getStreamUrl(){const e={audio_mbr:"1"},t=super.getStreamUrl(),r=Vg.isLiveStreamUrl(t),i=dm>=14||Kf>=15;return this.isLowLatencyLiveStream=r&&i,this.isLowLatencyLiveStream&&(e.lowlatency="1"),e.force_m4s="1",J(t,e,{saveOriginalPath:!0})}isLowLatencyLive(){return this.isLowLatencyLiveStream}initVideoTypeQualifier(){const e=new cm(this.getStreamUrl());this.once("Detach",e.destroy),e.on("VideoTypeChange",e=>{e&&this.emit("VideoTypeChange",e)}),e.setHTMLVideoElement(this.video)}onTick(e){super.onTick(e),this.updateProgramDateTime()}recoverIosSleepMode(){if(!ud)return;const e=P(this.getVideoOwnerDocument(),e=>{e&&(Er(this.state)||this.canSeek()&&(this.video.currentTime-=.001))});this.once("Destroy",e)}updateProgramDateTime(){const{videoType:e}=this.state.controller,t=this.getUtcStartTime(),r=(e===rp.LIVE||e===rp.EVENT)&&t?Ul(t,1e3):void 0;this.emit("ProgramDateTimeChange",r)}activateVideoTagIosWorkaround(){ud&&this.once("Destroy",g(this.video,"touchstart",()=>{this.video.paused?this.video.pause():Promise.resolve(this.video.play()).catch(ne)},{once:!0}))}}const pm=i(window),fm={};var vm=e(4661),gm=e.n(vm);class mm extends _l{constructor(e){super(),this.video=void 0,this.playbackQuality=_g,this.persistedPlaybackQuality=_g,this.accumulatedPlaybackQuality=_g,this.video=e,this.addDestroyHandler(()=>{this.reset(),this.video=void 0})}update(){if(!this.video)return;const e=No(this.video);this.playbackQuality=e,0!==this.persistedPlaybackQuality.totalVideoFrames&&(this.persistedPlaybackQuality.totalVideoFrames>e.totalVideoFrames&&(this.accumulatedPlaybackQuality={droppedVideoFrames:this.accumulatedPlaybackQuality.droppedVideoFrames+this.persistedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.accumulatedPlaybackQuality.corruptedVideoFrames+this.persistedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.accumulatedPlaybackQuality.totalVideoFrames+this.persistedPlaybackQuality.totalVideoFrames}),this.persistedPlaybackQuality=_g)}persist(){0!==this.playbackQuality.totalVideoFrames&&(this.persistedPlaybackQuality=this.playbackQuality,this.playbackQuality=_g)}reset(){this.playbackQuality=_g,this.persistedPlaybackQuality=_g,this.accumulatedPlaybackQuality=_g}getPlaybackQuality(){return this.persistedPlaybackQuality.totalVideoFrames>0?_g:{droppedVideoFrames:this.playbackQuality.droppedVideoFrames+this.accumulatedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.playbackQuality.corruptedVideoFrames+this.accumulatedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.playbackQuality.totalVideoFrames+this.accumulatedPlaybackQuality.totalVideoFrames}}}const Em=["time","cacheVersion"],Am=Nl(2592e5),ym=e(8139),Tm=["object"===typeof document&&document&&"onfreeze"in document?"pagehide":"beforeunload","unload"],Sm=!nd&&sf("video/webm")?"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAByhFNm3RAHU27i1OrhBVJqWZTrIHlTbuMU6uEFlSua1OsggEj7AEAAAAAAAC5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAADIq17GDD0JATYCNTGF2ZjU3Ljc2LjEwMFdBjUxhdmY1Ny43Ni4xMDBEiYhASwAAAAAAABZUrmsBAAAAAAAAYq4BAAAAAAAAWdeBAXPFgQGcgQAitZyDdW5khoZBX09QVVNWqoNjLqBWu4QExLQAg4EC4QEAAAAAAAARn4ECtYhA53AAAAAAAGJkgSBjopNPcHVzSGVhZAECOAGAuwAAAAAAH0O2dQEAAAAAAAAt54EAo4eBAACA/P/+o4eBABWA/P/+oAEAAAAAAAAPoYeBACkA/P/+daKDa3KD":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAMm1kYXTeBABMYXZjNTcuMTA3LjEwMABCIAjBGDghEARgjBwhEARgjBwhEARgjBwAAAMbbW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAAAEsAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAkV0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAAEsAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAA1AAAEAAABAAAAAAG9bWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAADgZVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAABaG1pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAABLHN0YmwAAABqc3RzZAAAAAAAAAABAAAAWm1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAANmVzZHMAAAAAA4CAgCUAAQAEgICAF0AVAAAAAAH0AAAAEYwFgICABRGQVuUABoCAgAECAAAAMHN0dHMAAAAAAAAABAAAAAEAAAQAAAAAAQAABBgAAAABAAAEAAAAAAEAAAHuAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAAEAAAAAQAAACRzdHN6AAAAAAAAAAAAAAAEAAAAGAAAAAYAAAAGAAAABgAAABRzdGNvAAAAAAAAAAEAAAAsAAAAGnNncGQBAAAAcm9sbAAAAAIAAAAB//8AAAAcc2JncAAAAAByb2xsAAAAAQAAAAQAAAABAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ny44My4xMDA=";let Rm;!function(e){e.AutomaticallyGenerated="AutomaticallyGenerated",e.HardcodedParams="HardcodedParams",e.IOS9OrLess="IOS9OrLess",e.HTML5VideoIsNotSupported="HTML5VideoIsNotSupported",e.WindowHasBeenActive="WindowHasBeenActive",e.RAAStopped="RAAStopped",e.OldIE="OldIE",e.MediaError="MediaError",e.NotRecognized="NotRecognized",e.YaBroAllowedToPlay="YaBroAllowedToPlay"}(Rm||(Rm={}));const _m=Ds(),Pm=e=>{const{paused:r}=e;return()=>{r?e.pause():e.paused&&t(function(e){if(!ns)return Promise.reject();const t=(r=e.play).__yaMuffleVideoPlayPromiseOriginalPlay||r;var r;if(p(t))return t.call(e);const i=ma("HTMLVideoElement")||ma("HTMLMediaElement");if(i)return i.call(e);const n=document.createElement("div");n.style.display="none",document.body.appendChild(n);const o=ma("HTMLMediaElement",I(n).contentWindow);if(o){const t=o.call(e);return b(n),t}return e.play()}(e))}},Im=e=>{const t=(e=>{const{muted:t}=e;return()=>{e.muted=t}})(e),r=(e=>{const{volume:t}=e;return()=>{e.volume=t}})(e),i=Pm(e);return()=>{t(),r(),i()}},bm=_m>-1&&_m<=16,Cm=Aa({canPlayUnMuted:!1,canPlayMuted:!1,detectionMethod:Rm.AutomaticallyGenerated}),Om=Aa({canPlayUnMuted:!0,canPlayMuted:!0,detectionMethod:Rm.AutomaticallyGenerated}),wm=Nl(500);class km{constructor(e,t){let{checkSoundEnabled:r,promise:i}=t;if(this.video=e,this.promise=void 0,this.stop=ne,this.isStopped=!1,this.revertVideoState=ne,this.getIsActiveWindow())return this.promise=Promise.resolve(Ea({},Om,{detectionMethod:Rm.WindowHasBeenActive})),this;if(i)return this.promise=i,this;const n=document.createElement("div");n.style.display="none";const o=Im(e),a=mo(e,()=>function(e,t){const r={};return E(t).forEach(t=>{r[t]=e.getAttribute(t)}),Ro(e,t),G(()=>{Ro(e,r)})}(e,{src:Sm}));let s;this.revertVideoState=G(()=>{a(),e.load(),o(),b(n)}),this.promise=new Promise(async(e,t)=>{let i,n,o;if(s=t,r){const e=await this.requestAutoplayAbilityByMuted(!1);n=e.autoplayAbility,i=e.detectionMethod}else n=!1;if(!this.isStopped){if(n)o=!0;else{const e=await this.requestAutoplayAbilityByMuted(!0);o=e.autoplayAbility,i=i&&i!==e.detectionMethod?"DifferentDetectionMethods unmuted=["+i+"] muted=["+e.detectionMethod+"]":e.detectionMethod}this.isStopped||(this.revertVideoState(),this.isStopped=!0,e(Aa({canPlayUnMuted:n,canPlayMuted:o,detectionMethod:i||Rm.NotRecognized})))}}),this.stop=()=>{this.isStopped||(this.isStopped=!0,s(new Error("requestAutoplayAbility has been stopped")),this.revertVideoState())}}async requestAutoplayAbilityByMuted(e){const{video:t}=this;if(mo(t,()=>{t.load()}),await(async(e,t)=>{let r;try{await new Promise((i,n)=>{t&&t.then(i,n),r=window.setTimeout(i,e)})}finally{window.clearTimeout(r)}})(0),this.isStopped)return{autoplayAbility:!1,detectionMethod:Rm.RAAStopped};t.muted=e,t.volume=e?0:1;const r=await new Promise(e=>{bo(t,{useProgressEvent:!0,timeoutForNonPromisePlay:wm}).then(t=>{e({autoplayAbility:!0,detectionMethod:t})}).catch(r=>{const i=Fn(t);i&&i.code===zv.MEDIA_ERR_DECODE?setTimeout(()=>{e({autoplayAbility:!0,detectionMethod:Rm.MediaError})},0):e({autoplayAbility:!1,detectionMethod:r})})});return this.isStopped?{autoplayAbility:!1,detectionMethod:Rm.RAAStopped}:r}getIsActiveWindow(){const e=aa(this.video);if(!e)return!1;const t=pa(e);return Boolean(t&&t.hasBeenActive)}}let Dm;!function(e){e.AutoplayDisabled="AutoplayDisabled",e.RASAborted="RASAborted"}(Dm||(Dm={}));const Nm=p(Object.getPrototypeOf)?e=>Object.getPrototypeOf(e):e=>e.__proto__||Object.prototype;var Lm=e(8139),Mm=e.n(Lm);const Vm=["resourceTimings"],xm=document.createElement("video"),Fm=Nl(500);class Um extends Ad{get state(){return this.playerStore.getState()}constructor(e,r,n,o){var a;super(),a=this,this.plannedAdViewers=[],this.callbacks=void 0,this.videoController=void 0,this.maxBufferLength=void 0,this.multiroll=zf,this.visibilityDetectPromise=void 0,this.defineAutoplaySettingsPromise=void 0,this.abortRequestAutoplaySettings=ne,this.clearRequestAutoplaySettingsTimeout=ne,this.onlineMonitor=new Qf,this.resourceTimingsMonitor=void 0,this.playbackProgressStorage=new Zf,this.visualState=void 0,this.debug=!1,this.container=void 0,this.video=void 0,this.videoSizeSensor=void 0,this.div=void 0,this.adDiv=void 0,this.sizeSensor=void 0,this.playbackQualityController=void 0,this.playerStore=void 0,this.broadcastAd=void 0,this.playCallbacks=[],this.preferNative=void 0,this.config=void 0,this.currentAdPlaybackQueue=void 0,this.stopLoadSource=ne,this.onReady=void 0,this.preloaders=[],this.cachePreloaders=[],this.playDeferred=void 0,this.stopAd=()=>Promise.resolve(),this.setHiddenControls=e=>{e.indexOf(Jl.ALL)>-1?this.playerStore.dispatch(vu(Zl)):this.playerStore.dispatch(vu(e)),this.videoController&&!this.playerStore.getState().ad.adInfo&&this.videoController.updateNativeControlsVisibility()},this.seekToLive=()=>{if(!this.videoController||!this.videoController.isDvrEnabled())return;const{skinDVRStartTime:e,skinDVRDuration:t}=this.state.skin,r=xl(e,t);this.seek({videoTime:r})},this.setPlaybackRate=e=>{const{max:t,min:r}=Ei(this.state);this.videoController.setPlaybackRate(c(e,r,t))},this.seek=function(e,t){let{videoTime:r,utc:i}=e;if(void 0===t&&(t=!1),"number"===typeof i){const e=a.videoController.getUtcStartTime(),r=Fl(i,e);a.seekToVideoPosition(r,t)}else"number"===typeof r&&a.seekToVideoPosition(r,t)},this.setVolume=e=>{if(!this.videoController)return this.playerStore.dispatch(yc({muted:this.state.controller.muted,volume:e,changeReason:nf.SetVolume})),void this.abortRequestAutoplaySettings(Yp.VolumeChange);const{muted:t,volume:r}=this.state.controller;let i=e,n=t;if(0===e){const{userVolume:e}=this.state.controller;i=e||r||1,n=!0}this.playerStore.dispatch(yc({volume:i,muted:n,changeReason:nf.SetVolume})),this.currentAdPlaybackQueue&&Er(this.state)?this.currentAdPlaybackQueue.setVolume(e):this.videoController&&(this.videoController.setVolume(i),this.videoController.setMuted(n))},this.setMuted=e=>{const t={volume:this.state.controller.volume,muted:e,changeReason:nf.SetMuted};if(!this.videoController)return this.playerStore.dispatch(yc(t)),void this.abortRequestAutoplaySettings(Yp.MuteChange);this.playerStore.dispatch(yc(t)),this.currentAdPlaybackQueue&&Er(this.state)?this.currentAdPlaybackQueue.setVolume(e?0:this.state.controller.volume):this.videoController&&this.videoController.setMuted(e)},this.playInrollAd=e=>{this.multiroll.inroll.schedule(Ra({},e,{timeOffset:(null==e?void 0:e.timeOffset)||0}))},this.playAdViewers=async(e,t,r)=>{try{await this.playAdViewersInternal(e,t,r)}catch(i){this.onError(new Cd(i,{code:ps.PLAY_AD_VIEWERS_ERROR,isFatal:!1,details:{adType:e,adViewersWithData:t,adDisplayConfig:r}}))}},this.handleSizeSensorUpdate=e=>{let{width:t,height:r}=e;this.emit("VisualStateChange",Ra({},this.visualState.getState(),{width:t,height:r}))},this.defineAutoplaySettingsAndLoadSource=()=>{const e=this.config.source,t=this.playerStore.getState(),{initialAutoplay:r,allowMuted:i,muted:n,volume:o,togglePlaybackOnVisibilityChangeSetting:s}=t.controller;this.defineAutoplaySettings(this.video,{autoplay:r,muted:n||0===o,allowMuted:!(!s||!s.forceAutoplay)||i}),this.loadSource(e,{shouldSaveProgress:!1}).catch(e=>{Ld.error("load source error",e),en(e,sp.INIT),this.onError(e)}).then(()=>{this.onReady(),this.state.controller.autoplay||this.playerStore.dispatch(fu(!0))}).then(()=>{void 0!==e.params.adConfig&&(ds?Xe({method:"GET",url:ls,retries:2,checkStatus:e=>e>=200&&e<400}).then(e=>{if(-1===e.responseText.trim().indexOf('<VAST version="3.0">'))throw new Error("Invalid XML in response from ["+ls+"]")}):Promise.resolve()).catch((function(e){let{message:t}=void 0===e?{}:e;a.playerStore.dispatch(ic(!0)),a.onError(new Cd({code:ps.STRM_ABD_INVALID_RESPONSE,isFatal:!0,details:{reason:t}}))}))})},this.subscribeHandlers=()=>{this.onlineMonitor.on("Online",()=>{this.playerStore.dispatch(Vc(!0)),Er(this.state)||this.videoController&&this.videoController.onOnline(),this.callbacks.onExpectedStalledChange(qt(kd.Offline,void 0))}),this.onlineMonitor.on("Offline",()=>{this.playerStore.dispatch(Vc(!1)),this.videoController&&this.videoController.onOffline()}),this.on("VideoTypeChange",e=>{this.playerStore.dispatch(Pc(e))}),this.on("DurationChange",e=>{this.playerStore.dispatch(Rc(e)),this.videoController.updateDVRParams(),this.updateVideoInfo()}),this.on("DvrChange",()=>{this.updateVideoInfo()}),this.on("ProgramDateTimeChange",e=>{this.playerStore.dispatch(Fc(e))}),this.on("CurrentTimeChange",this.handleVideoControllerCurrentTimeChange),this.on("BufferingRangesChange",e=>{this.playerStore.dispatch(Yc(e))}),this.on("VideoTrackValueChange",e=>{this.playerStore.dispatch(zc({videoTrackValue:e,isAbrEnabled:this.state.controller.isAbrEnabled}))}),this.on("VideoTrackChange",e=>{this.playerStore.dispatch(Qc(e))}),this.on("AudioTrackValueChange",e=>{this.playerStore.dispatch(Zc(e))}),this.on("AudioTracksChange",e=>{this.playerStore.dispatch($c(e))}),this.on("TextTrackValueChange",e=>{const{controller:{textTrackEnabled:t,textTrackValue:r}}=this.getState(),i=void 0!==e,n=void 0===e?r:e;this.playerStore.dispatch(ru(i)),this.playerStore.dispatch(ou(n));if((t?r:void 0)===(i?e:void 0))return;const o=i?mi(this.getState()):void 0;this.callbacks.onTextTrackChange(o)}),this.on("TextTracksChange",e=>{this.playerStore.dispatch(tu(e))}),this.on("VideoPlayingStateChange",e=>{this.playerStore.dispatch(Eu(e))});const e=this.logCanPlay(sp.INIT);this.once("CanPlay",e),this.once("SetSource",()=>this.off("CanPlay",e));const t=this.logLoadStartHavingCurrentData(sp.INIT);this.once("LoadedData",t),this.once("SetSource",()=>this.off("LoadedData",t)),this.once("Destroy",()=>{this.off("ContentImpression")});const r=P(this.getContainerDocument(),e=>{this.playerStore.dispatch(uu(e))});var i;this.once("Destroy",r),this.once("Destroy",(i=e=>{this.callbacks.logEvent({event:Od.DrmSystemsSupportDetected,params:e})},void 0===Uf?(xf.push(i),()=>{const e=xf.indexOf(i);-1!==e&&xf.splice(e,1)}):(i(Uf),ne)))},this.setBackgroundImage=e=>{this.div.style.backgroundImage=e?"url('"+e+"')":""},this.setBackgroundVisibility=e=>{this.div.style.backgroundSize=e?"contain":"0  0"},this.shouldCaptureScreenshot=()=>{var e;return this.videoController&&this.videoController.engine===rf.MPD&&this.state.controller.videoType===rp.VOD&&!(null!=(e=this.state.controller.stream)&&e.drmConfig)},this.playAdViewersInternal=async(e,r,i)=>{const{ad:{adInfo:n},controller:{isFullscreen:o,isPip:a}}=this.state,s=o&&H(this.getContainerDocument().defaultView,this.video)===this.video,l=s||a?r.filter(e=>{const{adViewer:t}=e;return t.filterAdPodsIndependentOnHtmlControls("StreamPlayer can't play CPC ads: ["+(a?"PiP":s?"FullScreen":"unknown")+"] mode"),t.getAdPodsCount()>0}):r,d=l.map(e=>{let{adViewer:t}=e;return t}),c=function(e){return e.reduce((e,t)=>xl(e,F(t.getAdPodsCount())),F(0))}(d),u=Ve(d);if(0===c)return void this.callbacks.logEvent({event:"NoAdPodsToPlayAd",params:void 0});n&&this.onError(new Cd({code:ps.AD_IS_ALREADY_PLAYING,isFatal:!1,details:{currentAdType:n.adType,adType:e}})),this.prepareBeforeOrAfterAd(!1,e),this.callbacks.logEvent({event:"PlayAdViewers",params:{adType:e,adPodsCount:c}});const h=e===wd.inroll?{cueId:this.state.ad.originalBroadcastAdCueId,startProgramDateTime:Ll(this.state.controller.programDateTime/1e3),startVideoTime:Ll(this.videoController?this.videoController.getCurrentTime():this.state.controller.currentTime),startTimestamp:Ll(Date.now()/1e3)}:{};let p=!1;const f=G(async r=>{let{data:i,stopAdReason:n}=r;this.shouldCaptureScreenshot()&&(this.resetPosterFitStyle(),this.setBackgroundVisibility(!0),this.once("CanPlay",()=>{this.setBackgroundImage(),this.videoController.clearScreenshot()}));const o=this.state.ad.inStreamPlayingState;p=!0,this.currentAdPlaybackQueue&&(this.currentAdPlaybackQueue.destroy(n),this.currentAdPlaybackQueue=void 0),e!==wd.postroll&&(Ld.log("videoController.play()"),o!==Ql.PAUSE&&t(this.videoController.play())),this.playerStore.dispatch(ec(void 0)),this.callbacks.onExpectedStalledChange(qt(kd.AdEnd,{adType:e})),this.prepareBeforeOrAfterAd(!0,e);const a=async()=>{await this.attachEncoder()};if(n===Dd.InsertIntoCalled)return a();const{loadPositionAfterAd:s}=i;s&&(this.playerStore.dispatch(Mc(s)),await a())});this.stopAd=f;const v=this.getSeekPositionAfterAd({adType:e,adViewersDuration:u});if(this.playerStore.dispatch(Mc(v)),this.shouldCaptureScreenshot()&&this.videoController.captureScreenshot(this.video).then(e=>{e&&(this.setBackgroundImage(e),this.setBackgroundVisibility(!1))}),await this.detachEncoder(),(()=>{this.playerStore.dispatch(ec({adType:e,params:h}))})(),p)return;let g=!1;const m=new Hd({video:this.video,onAdStartRejected:e=>{var t;null==(t=this.playDeferred)||t.reject(e)},onAdSkippableStateChange:e=>{this.callbacks.onAdSkippableStateChange(e)},onAdPodCloseStateChange:e=>{this.callbacks.onAdPodCloseStateChange(e)},onAdVolumeAvailabilityStateChange:e=>{this.callbacks.onAdVolumeAvailabilityStateChange(e)},onAdPodError:()=>{this.callbacks.onAdError()},onAdPodDurationChange:e=>{this.callbacks.onAdPodDurationChange(e)},onAdPodCurrentTimeChange:e=>{this.callbacks.onAdPodCurrentTimeChange(e)},onAdPodTimeToSkipChange:e=>{this.callbacks.onAdPodTimeToSkipChange(e)},onAdInteraction:()=>{this.callbacks.onAdInteraction()},onFirstAdPodStarted:()=>{var t;this.hidePoster(),e!==wd.postroll&&this.preloadVideoControllerSource(),null==(t=this.playDeferred)||t.resolve()},onLastAdPodStopped:e=>{this.multiroll.dispatchEvent({event:"AdBreakEnd",data:e})},onBeforeAdPodStart:e=>{this.callbacks.onBeforeAdPodStart(e)},onAdPodStarted:e=>{let{isFullyClickable:t}=e;this.playerStore.dispatch(fu(!0)),this.callbacks.onAdPodStart({isFullyClickable:t})},onAdPodSkipped:()=>{this.callbacks.onAdPodSkip()},onAdPodStopped:()=>{g=!0,this.playerStore.dispatch(hc(void 0)),this.callbacks.onAdPodEnd()},onAdPodPlayingStateChange:e=>{let{playingState:t,expectedStalledReason:r,adType:i}=e;t===Ql.BUFFERING&&this.callbacks.onExpectedStalledChange(qt(r,{adType:i})),this.playerStore.dispatch(hc(t))},onAdClickThru:()=>{this.callbacks.onAdPodClick()},onAdSizeChange:e=>{this.playerStore.dispatch(_c({videoWidth:Vl(void 0===e.width?NaN:e.width),videoHeight:Vl(void 0===e.height?NaN:e.height)}))},getControlsSettings:()=>function(e){const{ad:{nativeAdControlsVisibility:t}}=e;return{controlsVisibility:t?{}:{mute:!1,timeline:!1,play:!1,loader:!1}}}(this.playerStore.getState()),logEvent:this.callbacks.logEvent,onError:e=>{this.onError(e)},adConfig:this.state.ad.adConfig,playerContainer:this.config.useFriendlyFrame?ga(this.state.controller.vsid,window.parent.document):document.getElementById("q"),lang:this.config.lang,yaDirectPixel:this.preparePixelData()});this.currentAdPlaybackQueue=m,l.forEach(t=>{let{adViewer:r,additionalData:n,adType:o}=t;m.playAdViewers({adType:e,adPodType:o,adViewer:r,additionalData:n,adDisplayConfig:i,adElement:this.adDiv,posterUrl:this.getPosterUrlForAd()})}),this.plannedAdViewers=[],await m.getDestroyPromise(),p||await f({stopAdReason:Dd.AdCompleted,data:{loadPositionAfterAd:v}})},this.handleVideoControllerCurrentTimeChange=e=>{if(this.state.controller.encoderState!==ep.Attached)return;!(e<Ll(.5)&&this.state.controller.engine===rf.NATIVE&&this.state.controller.videoType===rp.LIVE)&&(this.playerStore.dispatch(bc(e)),this.playerStore.getState().ad.adInfo||this.playbackProgressStorage.saveProgress(e)),this.videoController.updateDVRParams(),this.updateVideoInfo()},this.handleVisualStateChange=e=>{let{isPip:t,isFullScreen:r,isVisible:i}=e;this.playerStore.dispatch(lu(r));const{isSupportedPipMode:n,isYandexPipMode:o,isVisibilitySupported:a}=this.visualState;this.emit("VisualStateChange",Ra({isPip:t,isVisible:i,isFullScreen:r,isSupportedPipMode:n,isYandexPipMode:o,isVisibilitySupported:a},this.sizeSensor.getSize())),n&&!o&&(this.playerStore.dispatch(du(t)),a&&this.playerStore.dispatch(cu(i)))},this.onRecover=async e=>{const t=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(this.getSyncDebugInfo(),Vm);this.callbacks.onRecover(Ra({},e,t)),this.callbacks.onExpectedStalledChange(qt(kd.Recover,{recoverReason:e.reason}))},this.logLoadStartHavingCurrentData=e=>()=>{if(!Ls){if(this.video.readyState<this.video.HAVE_CURRENT_DATA){const t=this.logLoadStartHavingCurrentData(e);return this.once("LoadedData",t),void this.once("SetSource",()=>this.off("LoadedData",t))}this.isCanPlayAndStartHavingCurrentDataLog()&&this.emit("ContentImpression")}},this.logCanPlay=e=>()=>{Ls||this.isCanPlayAndStartHavingCurrentDataLog()&&(this.callbacks.logEvent({event:Od.CanPlay,params:{stage:e}}),this.emit("ContentImpression"))},this.isCanPlayAndStartHavingCurrentDataLog=()=>!this.state.ad.hasPreroll&&this.state.controller.preload,this.startStream=()=>this.state.controller.encoderState===ep.Attached?Promise.resolve():this.attachEncoder().catch(Ld.error),this.handleFirstContentImpression=()=>{this.resetPosterFitStyle(),this.callbacks.logEvent({event:Od.ContentImpression,params:{}}),this.callbacks.onContentImpression({hasPreroll:this.state.ad.adSyncInit,engine:this.state.controller.engine}),this.playerStore.dispatch(fu(!0)),this.hidePoster()},this.setMaxListeners(14),this.container=e,this.preferNative=!0===r.preferNative,this.config=r,this.onReady=G(o);const s=r.source,{params:l}=s,{additionalParams:d}=l,h=r.volume,{togglePlaybackOnVisibilityChange:p}=r;this.callbacks=r.callbacks,this.maxBufferLength=r.maxBufferLength,this.resourceTimingsMonitor=new nv(r.resourceTimingsMonitor);const{autoplay:f}=r,v=r.hidden;this.debug=Boolean(r.debug),this.debug&&Ld.enableConsole(),this.div=document.createElement("div"),this.div.className=gm().locals.StreamPlayer,u(r.backgroundColor)&&(this.div.style.backgroundColor=r.backgroundColor),this.adDiv=document.createElement("div"),this.adDiv.className=gm().locals.StreamPlayer_ui,this.div.tabIndex=-1,this.container.appendChild(this.div),this.container.appendChild(this.adDiv);const g=Boolean(r.allowMuted),m=Ra({},r);delete m.callbacks;const E=gi(this,{controller:Ra({},tp,{autoplay:f,initialAutoplay:f,allowMuted:g,preload:r.preload,from:d.from,vsid:d.vsid,volume:r.volume,muted:r.muted,userVolume:void 0===r.volume?NaN:h,isFullscreen:!1,togglePlaybackOnVisibilityChangeSetting:p,isDocumentVisible:_(this.getContainerDocument()),isOnline:!0,isAbrEnabled:r.autoQuality,defaultQuality:r.defaultQuality,feed:r.feed,preview:l.preview,playerConfig:m}),ad:Ra({},zh,{adblockDetected:ds,nativeAdControlsVisibility:r.useNativeAdControls}),skin:Ra({},Bp,{hiddenControls:v,useNativeSubtitles:!0,nativeControlsVisibility:!$l(v)})});this.playerStore=E;const A=this.container.getElementsByTagName("video")[0]||function(){const e=document.createElement("video");return window.parent&&window.parent.HTMLVideoElement&&ym(HTMLMediaElement.prototype,window.parent.HTMLVideoElement.prototype),e}();this.video=A,A.poster||(A.poster=od),this.playbackQualityController=new mm(A);const y=function(e){const t=Nm(e);return t?()=>{Nm(e)!==t&&Mm()(e,t)}:ne}(A);this.div.appendChild(A),y();const T=this.getContainerDocument().getElementsByTagName("head")[0];!function(e,t){const r=document.createElement("style");r.textContent+=e,t?t.appendChild(r):i(window).appendChild(r)}(gm().toString(),T),R(A,gm().locals.player__video),this.videoSizeSensor=new Hl(A),function(e){e.setAttribute("playsinline","playsinline"),e.setAttribute("webkit-playsinline","webkit-playsinline")}(A),this.visualState=n.visualState,this.visualState.setVideoElement(A),this.on("VisualStateChange",e=>{e&&this.callbacks.onVisualStateChange(e)});const S=function(e,t,r){let i,n=0;const o=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];e.call(r,...i)};return function(){const e=Date.now(),r=e-n;clearTimeout(i);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];r<t?i=window.setTimeout(o,t-r,...s):(n=e,o(...s))}}(this.handleSizeSensorUpdate,Fm);this.sizeSensor=this.videoSizeSensor,this.sizeSensor.onResize.add(e=>{let{width:t,height:r}=e;return S({width:Vl(t),height:Vl(r)})}),S(this.sizeSensor.getSize()),this.once("Destroy",()=>this.sizeSensor.destroy()),p&&this.visualState.isYandexPipMode&&rn(window,!1,this.video),this.visualState.observe(this.handleVisualStateChange),this.handleVisualStateChange(this.visualState.getState()),this.visibilityDetectPromise=Promise.resolve(this.visualState.getState()),this.defineAutoplaySettingsAndLoadSource(),Promise.resolve().then(()=>{this.initEventSubscribes(r,A)})}recoverStream(){return this.videoController?this.videoController.recoverStream():Promise.resolve()}getRecoverHelper(){if(this.videoController)return this.videoController.recoverHelper}toggleNativeSubtitles(e){this.videoController&&this.videoController.toggleNativeSubtitles(e)}updateVideoControllerNativeControlsVisibility(){this.videoController&&this.videoController.updateNativeControlsVisibility()}getMultiroll(){return this.multiroll}getConnectionQuality(){return this.videoController?this.videoController.getConnectionQuality():bp.UNKNOWN}setPictureInPictureEnabled(e){rn(window,e,this.video)}setFeed(e){this.playerStore.dispatch(nu(e))}getRemainingBufferedTime(){return this.videoController?this.videoController.getRemainingBufferedTime():{total:Ll(0)}}getSegmentSize(){var e;return null==(e=this.videoController)?void 0:e.getSegmentSize()}getVideoPlaybackQuality(){return this.playbackQualityController.getPlaybackQuality()}getMaxCapAllowedVideoTrack(){if(this.videoController)return this.videoController.getMaxCapAllowedVideoTrack()}getContainerSize(){var e;return null==(e=this.videoController)?void 0:e.getContainerSize()}getVideoTrack(){return ei(this.state)}getVideoTracks(){return this.state.controller.videoTracks}getAudioTrack(){return Sr(this.state)}getAudioTracks(){return this.state.controller.audioTracks}getTextTrack(){return function(e){const{textTrackEnabled:t}=e.controller;if(t)return mi(e)}(this.state)}getTextTracks(){return this.state.controller.textTracks}setNativeTextTrackVisibility(e){this.playerStore.dispatch(iu(e))}setNativeAdControlsVisibility(e){this.playerStore.dispatch(cc(e))}getMuted(){return this.state.controller.muted}getLiveLatency(){return void 0===this.videoController?void 0:this.videoController.getLiveLatency()}getPlayingState(){return this.state.controller.playingState}getDuration(){return this.state.controller.duration}getCurrentTime(){return this.state.controller.currentTime}getTimelineInfo(){const{controller:{duration:e,currentTime:t},skin:{skinDVRStartTime:r,skinDVRDuration:i}}=this.state;return{currentTime:t,duration:e,utcStartTime:this.getUtcStartTime(),dvrStartTime:r,dvrDuration:i}}getWatchedTime(){return this.state.controller.watchedTime}getPreloadDetails(){const{preloadDetails:e}=this.state.controller;if((null==e?void 0:e.preloadingMethod)!==$p.Internal)return e}async getLongStalledDebugInfo(){if(this.videoController&&this.videoController.shouldLogStalledDebugInfo())return this.requestDebugInfo()}getBandwidthEstimate(){return(void 0===this.videoController?this.state.controller.lastKnownBandwidthEstimate:this.videoController.getBandwidthEstimate())||void 0}getCurrentStream(){return this.state.controller.stream}setVideoStyle(e){this.playerStore.dispatch(mu(e)),h(this.video,e)}setSource(e,t){let{shouldSaveProgress:r=!1}=void 0===t?{}:t;this.loadSource(e,{shouldSaveProgress:r}).catch(e=>{en(e,sp.SET_SOURCE),this.onError(e)}),this.emit("SetSource",e);const i=this.logCanPlay(sp.SET_SOURCE);this.once("CanPlay",i),this.once("SetSource",()=>this.off("CanPlay",i));const n=this.logLoadStartHavingCurrentData(sp.SET_SOURCE);this.once("LoadedData",n),this.once("SetSource",()=>this.off("LoadedData",n))}getSourceId(){return this.playerStore.getState().controller.sourceId}getUtcPosition(){return this.videoController?this.videoController.getUtcPosition():Ng}planAdViewers(e){this.plannedAdViewers=e}play(){var e,t;if(this.performPlayCallbacks(),this.currentAdPlaybackQueue&&Er(this.state))return this.currentAdPlaybackQueue.resumeAd(),null==(e=this.playDeferred)||e.resolve(),Promise.resolve();if(this.plannedAdViewers.length>0)return this.playAdViewers(wd.postPauseroll,this.plannedAdViewers,{}),null==(t=this.playDeferred)||t.resolve(),Promise.resolve();if(!this.videoController||this.state.controller.encoderState!==ep.Attached)return this.playerStore.dispatch(vc(!0)),this.playerStore.dispatch(gc($h.starting)),this.abortRequestAutoplaySettings(Yp.ApiPlay),this.playDeferred||(this.playDeferred=new ad,this.playDeferred.promise.catch(ne).then(()=>this.playDeferred=void 0)),this.playDeferred.promise;const r=this.videoController.getCurrentTime(),i=this.videoController.getDuration();i>0&&r>=i&&this.seek({videoTime:Ll(0)}),Ld.log("StreamPlayer.play() -> videoController.play()");const n=this.videoController.play();return n.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()},e=>{var t;return null==(t=this.playDeferred)?void 0:t.reject(e)}),n}pause(){var e;this.playerStore.dispatch(fu(!0)),this.state.controller.startStage!==$h.started&&(this.playerStore.dispatch(vc(!1)),this.playerStore.dispatch(gc($h.waitForUserPlay))),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()")),this.currentAdPlaybackQueue&&Er(this.state)?this.currentAdPlaybackQueue.pauseAd():this.videoController&&this.state.controller.encoderState===ep.Attached?this.videoController.pause():this.playerStore.dispatch(vc(!1))}getPlaybackRate(){return this.state.controller.playbackRate}setVideoTrack(e){const t=this.getVideoTrack();if(Sa(t,e))return;this.playerStore.dispatch(Xc(e===Qp.value));const r=e===Qp.value&&this.state.controller.isAbrSupported?Qp:this.state.controller.videoTracks.find(t=>t.value===String(e)),{videoHeight:i}=this.state.controller,n=((null==r?void 0:r.height)||0)>i;r&&r.value!==Qp.value&&n&&function(e,t){void 0===t&&(t=jp),t in Cg?Cg[t].preferHd=e:Cg[t]={preferHd:e},Ef.setItem("videoplayer-prefer-hd",JSON.stringify(Cg))}(!0,this.state.controller.from),this.playerStore.dispatch(Jc({name:r&&r.value!==Qp.value&&r.name||void 0,height:r&&r.height?Vl(r.height):void 0})),r&&(this.videoController.setVideoTrack(r),this.callbacks.onExpectedStalledChange(qt(kd.VideoTrackChange,{newTrack:r,oldTrack:t})),Ld.log("SELECTED VIDEO TRACK: ",r))}setAudioTrack(e){const t=this.getAudioTrack();if(Sa(t,e))return;const r=this.state.controller.audioTracks.find(t=>t.value===String(e));r&&(this.playerStore.dispatch(eu({name:r.name||void 0,lang:r.lang||void 0})),this.videoController.setAudioTrack(r),this.callbacks.onExpectedStalledChange(qt(kd.AudioTrackChange,{newTrack:r,oldTrack:t})),Ld.log("SELECTED AUDIO TRACK: ",r))}getSyncDebugInfo(){const{resourceTimingsMonitor:e,videoController:t}=this;return{recoverHelperState:t?t.getRecoverHelperState():ef.OFF,state:this.getState(),remainingBufferedTime:Yr(this.state),resourceTimings:e.getAllResourcesTimings(),connectionQuality:t?t.getConnectionQuality():bp.UNKNOWN}}async requestDebugInfo(){return Ra({},this.getSyncDebugInfo(),{videoController:this.videoController?await this.videoController.requestDebugInfo():{noController:!0}})}getState(){return this.state}setTextTrack(e){const{textTracks:t,userTextTrackLang:r,userTextTrackName:i,textTrackEnabled:n,textTrackValue:o}=this.state.controller;if(n&&o===e)return;if("auto"===e)return void this.playerStore.dispatch(su());const a=void 0===e?void 0:t.find(t=>t.value===e),s={enabled:Boolean(a),lang:a?a.lang||void 0:r,name:a?a.name||void 0:i};this.playerStore.dispatch(au(s)),a?(this.videoController.setTextTrack(a),Ld.log("SELECTED TEXT TRACK: ",a)):(this.videoController.disableTextTrack(),Ld.log("DISABLE TEXT TRACK"))}getVolume(){return this.state.controller.volume}setFullscreen(e){if(e)try{this.visualState.changeFullscreenState({isFullScreen:!0})}catch(t){Ld.error("Request fullscreen for element:",t)}else try{this.visualState.changeFullscreenState({isFullScreen:!1})}catch(t){Ld.error("Exit fullscreen for element:",t)}}async destroy(){this.stopAd({stopAdReason:Dd.PlayerDestroy,data:{loadPositionAfterAd:void 0}}),this.stopLoadSource(tf.destroy),this.multiroll.destroy(),this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.destroy(Dd.PlayerDestroy),this.onlineMonitor.destroy(),this.visualState.destroy(),this.resourceTimingsMonitor.destroy(),this.playbackQualityController.destroy(),this.emit("Destroy"),await this.destroyVideoController(),function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(this.container)}skipAdPod(){this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.skipAdPod()}stop(){this.seek({videoTime:Ll(0)}),this.pause()}preloadSource(e){this.callbacks.logEvent({event:Od.PreloadSource,params:{source:e}});let t=ne,r=!1;return{promise:this.preloadSourceImpl(e,()=>r,e=>t=e),abort:()=>{r||(r=!0,t())}}}initEventSubscribes(e,t){this.once("Destroy",g(this.getMainContainer(),"click",t=>{if(this.state.controller.watchedTime>0)return;if(void 0!==this.state.ad.inStreamPlayingState)return;void 0!==e.shouldPlayOnFirstClick&&e.shouldPlayOnFirstClick&&this.play()},{once:!0})),Ns&&this.once("Destroy",fa(()=>this.destroy())),this.once("Destroy",g(this.div,"selectstart",e=>{e.preventDefault(),e.stopPropagation()})),this.once("Destroy",L(()=>{this.playerStore.dispatch(dc())})),this.once("Destroy",g(this.getMainContainer(),"click",t=>{this.state.controller.watchedTime>0||void 0===this.state.ad.inStreamPlayingState&&e.shouldPlayOnFirstClick&&this.play()},{once:!0})),Ns&&this.once("Destroy",fa(()=>this.destroy())),this.once("Destroy",()=>{this.off("VisualStateChange")}),this.initClickerEventListener(this.div),this.initTouchZoomPreventor(this.div),this.once("Destroy",g(this.video,"volumechange",()=>{(this.videoController||this.currentAdPlaybackQueue)&&this.updateVolumeInfo()})),this.subscribeHandlers()}initClickerEventListener(e){const t=new Td(e);this.once("Destroy",()=>t.destroy()),t.on("Event",e=>{let{type:t,event:r}=e;if(Er(this.state))return;const i=Ra({},r);i.preventDefault=void 0,this.callbacks.onVideoClickerEvent({type:t,event:i})})}initTouchZoomPreventor(e){const t=new Id(e);this.once("Destroy",()=>t.destroy())}requestAutoplaySettings(e,t,i){return function(e){return void 0===e&&(e=window),As(e).some(e=>{const{hasBeenActive:t}=r(()=>pa(e))||{hasBeenActive:!1};return t})}(window)?{promise:Promise.resolve({autoplay:t.autoplay,muted:t.muted,detectionMethod:"ACTIVATED_WINDOW"}),abort:ne,skipCacheUpdate:!0}:Ta(Ra({},t,i,{videoSlot:e}))}defineAutoplaySettings(e,t){if(this.state.controller.autoplay&&!this.state.controller.isDocumentVisible)return this.playerStore.dispatch(gc($h.waitForDocumentVisibility)),this.playerStore.dispatch(vc(!1)),void(this.defineAutoplaySettingsPromise=Promise.resolve());let i;const n=ha(t),{promise:o,skipCacheUpdate:a=!1,abort:s}=this.requestAutoplaySettings(e,t,n),{promise:l,clear:d}=Yl(Xp);this.clearRequestAutoplaySettingsTimeout=()=>{d()},l.then(()=>{this.state.controller.startStage===$h.init&&this.playerStore.dispatch(gc($h.waitForUserPlay))});const c=Y();this.abortRequestAutoplaySettings=e=>{void 0===i&&this.callbacks.logEvent({event:"PlayWithoutRAAResults",params:{delay:Nl(c()),reason:e}}),s()},this.runRequestAutoplaySettingsLogger(o,t,n),o.then(e=>{var i,o;a||(o=e,function(e,t){return!t||e.allowMuted!==t.allowMuted||e.autoplay!==t.autoplay||e.muted!==t.muted}(i=t,n)&&r(()=>{Ef.setItem(ua(i),JSON.stringify(ca({},o,{cacheVersion:2,time:Date.now()})))}))}),this.defineAutoplaySettingsPromise=Promise.all([o,this.visibilityDetectPromise]).then(e=>{let[t]=e;i=t,this.clearRequestAutoplaySettingsTimeout();const{isVisible:r}=this.state.controller;Ld.log("Autoplay settings defined",i);const{autoplay:n,muted:o,autoplayImpossible:a,requireAllowMutedToAutoplay:s}=i;this.playerStore.dispatch(yc({muted:o,volume:this.state.controller.volume,changeReason:nf.RequestAutoplaySettings}));const l=function(e){const{controller:{togglePlaybackOnVisibilityChangeSetting:t,muted:r}}=e;return!!t&&!(t.onlyMuted&&!r)}(this.state)&&!1===r;l&&this.callbacks.logEvent({event:"HiddenAutoplayPrevented",params:{autoplaySettingsRequestResult:i}});const d=n&&!l&&this.state.controller.autoplay;Ld.log("autoplay status:",n),Ld.log("isVisible",r),Ld.log("preventHiddenAutoplay",l);const c=d?$h.starting:$h.waitForUserPlay;var u;(this.playerStore.dispatch(gc(c)),d)?this.playerStore.dispatch(mc(!0)):null==(u=this.playDeferred)||u.reject(new Error("playing rejected cause of autoplay-false"));if(this.playerStore.dispatch(vc(d)),a){this.playerStore.dispatch(Tc(!0)),this.callbacks.logEvent({event:"AutoplayImpossible",params:{autoplaySettingsRequestResult:i}});try{console.warn("Cannot autoplay video"+(s?" with sound":"")+" in this environment."+(s?" Use autoplay={allowMuted: true} if you prefer mute video and enable autoplay.":""))}catch(h){}}})}createVideoController(e,t){let{stream:r,supportInfo:i}=e;const n={playerStore:this.playerStore,video:this.video,videoSizeSensor:this.videoSizeSensor,stream:r,sourceParams:t,debug:this.debug,liveOffset:this.config.liveOffset,slowConnection:this.config.slowConnection,maxBufferLength:this.maxBufferLength,defaultQuality:this.state.controller.defaultQuality,maxRecoverAttempts:this.config.maxRecoverAttempts,bandwidthEstimateOffset:this.config.bandwidthEstimateOffset,resourceTimingsMonitor:this.resourceTimingsMonitor,setPlayerBackgroundImage:this.setBackgroundImage,setPlayerBackgroundVisibility:this.setBackgroundVisibility,onError:e=>this.onError(e),onRecover:this.onRecover,logEvent:this.callbacks.logEvent,onSubtitlesChange:this.callbacks.onSubtitlesChange,onThumbnailTileGeneralMetaInfoChange:this.callbacks.onThumbnailTileGeneralMetaInfoChange,onExpectedStalledChange:this.callbacks.onExpectedStalledChange,getPipWindowSize:()=>this.visualState.getPipWindowSize()},o=(a=i.engine,s=n,l=this.getPreloader(r,t),a===rf.HLS?new Fg(s):a===rf.MPD?new lm(s,l):a===rf.MP4?new Wg(s):new hm(s));var a,s,l;this.cleanCachePreloaders();const d=e=>{this.videoController=e,this.playerStore.dispatch(fc(i.engine)),this.callbacks.onEngineChange(i.engine,this.playerStore.getState().controller.sourceId),e.on("VideoPlayingStateChange",e=>this.emit("VideoPlayingStateChange",e)),e.on("MetadataChange",e=>this.emit("MetadataChange",e)),e.on("CurrentTimeChange",e=>this.emit("CurrentTimeChange",e)),e.on("DurationChange",e=>this.emit("DurationChange",e)),e.on("DvrChange",()=>this.emit("DvrChange")),e.on("DVRDurationChange",e=>this.callbacks.onDVRDurationChange(e)),e.on("DVRStartTimeChange",e=>this.callbacks.onDVRStartTimeChange(e)),e.on("ProgramDateTimeChange",e=>this.emit("ProgramDateTimeChange",e)),e.on("BufferingRangesChange",e=>this.emit("BufferingRangesChange",e)),e.on("CanPlay",()=>this.emit("CanPlay")),e.on("ContentImpression",()=>this.emit("ContentImpression")),e.on("DrmSystemChange",this.callbacks.onDrmSystemChange),e.on("LoadedData",()=>this.emit("LoadedData")),e.on("VideoTypeChange",e=>this.emit("VideoTypeChange",e)),e.on("VideoTrackValueChange",e=>this.emit("VideoTrackValueChange",e)),e.on("AudioTrackValueChange",e=>this.emit("AudioTrackValueChange",e)),e.on("TextTrackValueChange",e=>this.emit("TextTrackValueChange",e)),e.on("VideoTracksChange",e=>this.emit("VideoTrackChange",e)),e.on("AudioTracksChange",e=>this.emit("AudioTracksChange",e)),e.on("TextTracksChange",e=>this.emit("TextTracksChange",e))};return Wl(o)?Promise.resolve().then(async()=>d(await o)):d(o)}cleanCachePreloaders(){for(;this.cachePreloaders.length>0&&this.config.cacheSourcesCount<this.cachePreloaders.length;)this.cachePreloaders[0].destroy(),this.cachePreloaders.splice(0,1)}getPreloader(e,t){const r=Ki(e.url),i=this.preloaders.filter(e=>Ki(e.getSource().stream.url)===r);var n;i.push(...this.cachePreloaders.filter(e=>Ki(e.getSource().stream.url)===r)),i.sort((n=t.startPosition.videoTime||Ll(0),function(e,t){const{total:r,audio:i,video:o}=Hi(e.getBufferedInfo(),n),{total:a,audio:s,video:l}=Hi(t.getBufferedInfo(),n);return r!==a?a-r:o!==l?l-o:s-i}));const o=i[0];if(void 0===o)return;let a=this.preloaders.indexOf(o);return a>-1?this.preloaders.splice(a,1):(a=this.cachePreloaders.indexOf(o),a>-1&&this.cachePreloaders.splice(a,1)),o}getPreparedSourceParams(e,t,r){return Ra({},qp,t,{startPosition:this.getInitialStartPosition(t,r),withCredentials:qi(e,t)})}getInitialStartPosition(e,t){const r=e&&e.startPosition||qp.startPosition;if(r){if(E(r).some(e=>W(r[e])))return r}const i=null==t?void 0:t.getProgress();return void 0===i?r:{videoTime:i}}async loadSource(e,t){let{shouldSaveProgress:r}=t;Ld.log("loadSource start",e),this.callbacks.onEngineChange(void 0,this.playerStore.getState().controller.sourceId),this.callbacks.onDrmSystemChange(void 0);const i=r?"LoadSourceWithSaveProgress":"LoadSource";this.callbacks.logEvent({event:i,params:{source:e}}),this.shouldCaptureScreenshot()&&(this.setBackgroundImage(),this.setBackgroundVisibility(!1),this.videoController.clearScreenshot()),this.stopAd({stopAdReason:Dd.LoadSource,data:{loadPositionAfterAd:void 0}}),this.plannedAdViewers=[],this.stopLoadSource(tf.setSource),this.playbackProgressStorage.clearVideoContentId(),this.playerStore.dispatch(Lc(void 0)),this.playerStore.dispatch(wc(void 0)),this.playerStore.dispatch(kc(void 0)),this.playerStore.dispatch(Nc(e.streams)),this.playerStore.dispatch(fu(!1));const{preferredAudioLangs:n,preferredTextLangs:o}=e.params.preferredTracks;n.length>0&&this.playerStore.dispatch(eu({lang:n[0],name:void 0})),o.length>0&&this.playerStore.dispatch(au({lang:o[0],name:void 0,enabled:!0}));const a=new Mu;this.stopLoadSource=e=>a.stop(e);try{this.multiroll.destroy()}catch(YE){}this.multiroll=zf;const s=!this.videoController,{streams:l}=e,c=Ui({streams:l,video:this.video,preferNative:this.preferNative}),u=ji(e.params),h=function(e){return d(e)&&!1===e.hasPreroll}(u);this.playerStore.dispatch(lc(d(u)&&(!h||!1!==u.hasPreroll)));let p=h?null:this.initMultirollModule(u,a);const f=this.destroyVideoController(),v=await c;if(this.playerStore.dispatch(Lc(v.streamsWithSupportInfo)),a.stopReason)return void this.callbacks.logEvent({event:Od.StreamStopWhileChoosingStream,params:void 0});if("error"===v.status)throw v.error;const{supportedStream:g}=v;var m;(m=g).supportInfo.engine===rf.MPD?da(bv):m.supportInfo.engine===rf.HLS&&da(Iv);const{stream:E}=g;this.playbackProgressStorage.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const A=this.getPreparedSourceParams(E,e.params,this.playbackProgressStorage);if(await f,a.stopReason)return void this.callbacks.logEvent({event:Od.StreamStopWhileDestroyVideoController,params:void 0});if(this.resetPlayerStore(E,A,{shouldSaveProgress:r,isFirstLoad:s}),await Promise.race([this.defineAutoplaySettingsPromise,a.stopPromise]),a.stopReason)return void this.callbacks.logEvent({event:Od.StreamStopDuringDefineAutoplaySettings,params:void 0});const y=this.createVideoController(g,A);if(Wl(y)&&(await Promise.race([y,a.stopPromise]),a.stopReason))return;this.state.ad.hasPreroll||!this.state.controller.preload&&!this.state.controller.autoplay||this.preloadVideoControllerSource(),s?(Promise.resolve().then(()=>{this.initBroadcastAd()}),Wi(E.url,Boolean(A.withCredentials)).then(e=>{this.playerStore.dispatch(ic(e||ds))}),this.setMuted(this.state.controller.muted),this.setVolume(this.state.controller.volume)):this.prepareNextSource(E,A),this.setPosterFitStyle(),this.once("ContentImpression",this.handleFirstContentImpression),this.once("SetSource",()=>this.off("ContentImpression",this.handleFirstContentImpression));const T=async()=>{p||(p=this.initMultirollModule(u,a));const e=await p;if(a.stopReason)return this.callbacks.logEvent({event:Od.StreamStopWhileLoadingMultiroll,params:{streamStopReason:a.stopReason}}),void e.destroy();this.multiroll=e};if(h){const{adInitOffset:e=0}=u||{};new Promise(t=>{let r=!1;const i=()=>{this.off("CurrentTimeChange",n),this.off("ContentImpression",o)},n=()=>{if(!r)return;this.getWatchedTime()<=e||(i(),t())},o=()=>r=!0;this.on("ContentImpression",o),this.on("CurrentTimeChange",n),this.once("SetSource",i)}).then(()=>{a.stopReason||T()})}else await T();a.stopReason||this.startPrerollAndContent(a,s)}async preloadSourceImpl(e,t,r){const{streams:i}=e,n=Ui({streams:i,video:xm,preferNative:this.preferNative}),o=await n;if(t())throw new Error("abort preloadSource");if("error"===o.status)throw o.error;const{supportedStream:a}=o,{stream:s,supportInfo:l}=a,d=new Zf;d.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const c=this.getPreparedSourceParams(s,e.params,d),u=Xi({stream:s,sourceParams:c}),h=this.preloaders.find(e=>Xi(e.getSource())===u);if(h)return r(()=>h.destroy()),h.preload();const p=function(e){let{engine:t,source:r,getState:i,getCapSizes:n}=e;switch(t){case rf.MPD:return new Xv({source:r,getState:i,getCapSizes:n,type:$p.Api});default:return}}({engine:l.engine,source:{stream:s,sourceParams:c},getState:()=>this.playerStore.getState(),getCapSizes:()=>{var e;return null==(e=this.videoController)?void 0:e.getCapSizes()}});if(!p)throw new Error("can not create preloader");return this.preloaders.splice(0,0,p),this.preloaders=this.preloaders.filter(e=>!e.isDestroyed).slice(0,10),r(()=>p.destroy()),p.preload()}preparePixelData(){var e,t;if(this.config.yaDirectPixelUrl&&this.config.yaDirectPixelData)return{url:this.config.yaDirectPixelUrl,data:Ra({},this.config.yaDirectPixelData,{containerId:this.container.id,pageId:null==(e=this.config.source.params.adConfig)?void 0:e.partnerId,impId:null==(t=this.config.source.params.adConfig)?void 0:t.impId})}}async initMultirollModule(e,r){let i=zf;if(!e)return i;try{const n=je(window,e,this.state.controller.vsid,this.preparePixelData()),o=await Promise.race([n,r.stopPromise.then(()=>{})]);if(void 0===o)return i;const{loadMultiroll:a}=o,s={adSdkVersion:Ue(window),adSdkLoaderVersion:Fe(window)};this.callbacks.onAdSDKVersionDefined(s);const l=a(Ra({},e,{secureMode:"Safe",getSTRMChunkHost:()=>{const e=Hr(this.resourceTimingsMonitor.getAllResourcesTimings());if(0===e.length)return;const{hostname:t,protocol:r}=K(e[0]);return r+"//"+t+"/"}}),{preroll:{shouldPreload:()=>{const{preload:e,startStage:t}=this.state.controller;return e&&(t===$h.waitForUserPlay||t===$h.waitForDocumentVisibility)}},midroll:{preloadOffset:20,preloadMinTime:Ll(5)},postroll:{preloadOffset:20,preloadMinTime:Ll(5)},getPreloadParams:()=>{const e={videoSlot:this.video};if(!this.videoController||!this.state.ad.nextAdInfo)return e;const t=this.videoController.getBandwidthEstimate();return t.value?Ra({},e,{desiredBitrate:t.value/1e3}):e},adLoaded:e=>{let{adBreakType:t}=e;const r=(()=>{switch(t){case wd.preroll:return wd.preroll;case wd.midroll:return wd.midroll;case wd.postroll:return wd.postroll;case wd.inroll:return wd.inroll;case wd.postPauseroll:return wd.postPauseroll}})();void 0!==r&&this.callbacks.onAdLoaded({adType:r})}});t(r.stopPromise.then(()=>l).then(e=>e.destroy()));const d=await Promise.race([l,r.stopPromise.then(()=>{})]);if(void 0===d)return i;i=d}catch(YE){this.callbacks.onAdError(),this.onError(new Cd({isFatal:n(_s)&&("0"===String(YE.code)||!YE.code),code:ps.MULTIROLL_INIT_ERROR,details:{error:YE,adConfig:e}}))}return i}async startPrerollAndContent(e,t){Ld.log("startPrerollAndContent");let r=[];const i=G(()=>this.startStream()),n=G(async()=>{const t=this.multiroll.preroll.loadViewers({}),i=await Promise.race([t,e.stopPromise.then(()=>{})]);if(void 0===i)return;r=i;const n=r.length>0;this.playerStore.dispatch(sc(n)),n&&this.callbacks.logEvent({event:Od.PrerollInit,params:{}})}),{startStage:o,preload:a}=this.state.controller;if(o===$h.waitForUserPlay||o===$h.waitForDocumentVisibility){if(Ld.log("Waiting for "+(o===$h.waitForUserPlay?"user gesture":"document visibility")),this.callbacks.logEvent({event:o===$h.waitForUserPlay?Od.WaitForUserGesture:Od.WaitForDocumentVisibility,params:{preload:a}}),a){if(Ld.log("Preload preroll in player"),await Promise.race([n(),e.stopPromise]),e.stopReason)return void this.callbacks.logEvent({event:Od.StreamStopWhilePreloadingPreroll,params:{streamStopReason:e.stopReason}});this.state.ad.hasPreroll||(Ld.log("No preroll, preload content"),i())}if(o===$h.waitForDocumentVisibility&&await function(e,t){return _(e)===t?Promise.resolve():new Promise(r=>{P(e,e=>{e===t&&r()})})}(this.getContainerDocument(),!0),this.state.controller.startStage===$h.waitForUserPlay&&await this.waitForPlay(),e.stopReason)return void this.callbacks.logEvent({event:o===$h.waitForUserPlay?Od.StreamStopWhileWaitingForPlay:Od.StreamStopWhileWaitingForDocumentVisibility,params:{streamStopReason:e.stopReason}})}if(Ld.log("Start playing"),t&&this.playerStore.dispatch(vc(!0)),await Promise.race([n(),e.stopPromise]),e.stopReason)this.callbacks.logEvent({event:Od.StreamStopWhileLoadingPreroll,params:{streamStopReason:e.stopReason}});else{if(!this.state.ad.hasPreroll)return await i(),this.playAfterWaitingForDocumentVisibility(),void this.performPlayCallbacks();this.playerStore.dispatch(mc(!0)),Ld.log("Start preroll"),this.playAdViewers(wd.preroll,ue(r,wd.preroll),{videoSlotCanAutoPlay:o!==$h.waitForDocumentVisibility||void 0})}}waitForPlay(){const e=Y();return new Promise(t=>{let r=ne,i=0;const n=n=>{r(),clearInterval(i),this.callbacks.logEvent({event:Od.WaitForPlayCompleted,params:{reason:n,timeout:Nl(e())}}),this.playerStore.getState().controller.startStage!==$h.started&&this.playerStore.dispatch(gc($h.starting)),t()};this.video.paused?(this.playCallbacks.push(()=>{n(Zp.PlayCallback)}),r=g(this.video,"play",()=>{n(Zp.VideoPlayEvent)}),i=window.setInterval(()=>{this.video.paused||n(Zp.DetectByInterval)},250)):n(Zp.VideoIsNotPausedOnInit)})}initBroadcastAd(){const{video:e,playerStore:t}=this;if(this.broadcastAd=new Lu(e,e.parentElement,t,this,e=>this.onError(e)),this.videoController&&this.videoController.engine===rf.NATIVE){let t=0;e.addEventListener("timeupdate",()=>{const{currentTime:r}=e;this.isLive()&&r<t&&this.broadcastAd&&this.playerStore.dispatch(nc({})),t=r})}this.on("MetadataChange",e=>{const{fragmentMetadataArray:t,fragmentStart:r}=e;if(Ld.log("receive metadata: ",t),!this.broadcastAd)return;const{programDateTime:i}=this.state.controller;if(void 0===i)return;const n=xl(i,Ul(r,1e3));let o;Math.random()<.01&&this.callbacks.logEvent({event:Od.StreamPlayerReceivedMetadata,params:e}),t.forEach(e=>{try{const t=JSON.parse(e);if(!function(e){return d(e)&&u(e.cue_id)&&W(e.offset)}(t))return;o=Ra({},t,{pts:n})}catch(t){Ld.log("metadata is not valid ["+e+"]")}}),o&&this.broadcastAd.handleInrollFrame(o).catch(e=>{Ld.error(e),this.onError(new Cd(e,{code:ps.BROADCAST_AD_BLOCK_INIT_ERROR,isFatal:!1,details:{code:e.code,message:e.message,id:e.id,details:e.details,stack:e.stack,metadata:{cueId:o.cue_id,podStart:n+o.offset}}}))})}),this.broadcastAd.on("AdIntervalRemoved",e=>{this.playerStore.dispatch(ac(e))}),this.broadcastAd.on("AdIntervalUpdated",e=>{let{cueId:t,start:r,end:i}=e;this.playerStore.dispatch(oc({cueId:t,start:Bl(r,1e3),end:Bl(i,1e3)}))}),this.broadcastAd.on("InrollAdPlayRequest",e=>{this.playAdViewers(wd.inroll,e,{})})}getPosterUrlForAd(){var e;const t=null==(e=this.state.controller.sourceParams)?void 0:e.preview;return t&&t!==od?t:null}prepareBeforeOrAfterAd(e,t){this.broadcastAd&&t!==wd.inroll&&this.broadcastAd.setEnabled(e)}getSeekPositionAfterAd(e){let{adType:t,adViewersDuration:r}=e;const i=this.getUtcPosition();if(t===wd.inroll){const e=xl(this.state.controller.currentTime,r);return{utc:i?xl(i,r):void 0,videoTime:e}}return t===wd.preroll?this.state.controller.startPosition:t===wd.midroll||t===wd.postPauseroll?{utc:Ll(i)||void 0,videoTime:Ll(this.videoController.getCurrentTime())}:t===wd.postroll?{videoTime:Ll(0)}:{}}updateVideoInfo(){Er(this.state)?this.playbackQualityController.persist():this.playbackQualityController.update()}resetPlayerStore(e,t,r){let{shouldSaveProgress:i,isFirstLoad:n}=r;this.playerStore.dispatch(Dc()),this.playerStore.dispatch(wc(e)),this.playerStore.dispatch(kc(t));const o=this.getStartPositionForLoadSource(t,{shouldSaveProgress:i});if(this.playerStore.dispatch(Mc(o)),i||this.playerStore.dispatch(Rc(tp.duration)),this.playerStore.dispatch(bc(Ml(Math.max(0,o.videoTime||tp.currentTime)))),!n){const{additionalParams:e=Kp}=t,{from:r=jp}=e;this.playerStore.dispatch(Oc(r)),this.playerStore.dispatch(hu(t.preview||qp.preview)),this.playerStore.dispatch(Yc(tp.bufferingRanges)),i||this.playerStore.dispatch(pu(tp.watchedTime)),this.playerStore.dispatch(Pc(void 0)),this.playerStore.dispatch(Fc(void 0)),this.playerStore.dispatch(Qc(tp.videoTracks)),this.playerStore.dispatch(Zc(tp.audioTrackValue)),this.playerStore.dispatch($c(tp.audioTracks)),this.playerStore.dispatch(ru(tp.textTrackEnabled)),this.playerStore.dispatch(ou(tp.textTrackValue)),this.playerStore.dispatch(tu(tp.textTracks)),this.callbacks.onSubtitlesChange([]),this.callbacks.onThumbnailTileGeneralMetaInfoChange(void 0),this.playerStore.dispatch(nc({})),this.state.controller.playingState===Ql.END&&this.playerStore.dispatch(Ic(Ql.PAUSE)),this.playerStore.dispatch(hc(void 0)),this.playerStore.dispatch(sc(!1)),this.playerStore.dispatch(pc(void 0)),this.playerStore.dispatch(Au(tp.preloadDetails))}this.playerStore.dispatch($d(ji(t)))}prepareNextSource(e,t){this.playerStore.dispatch(jc({})),this.emit("DurationChange",Ll(NaN)),this.playerStore.dispatch(mc(!0)),this.playbackQualityController.reset(),this.playCallbacks=[],this.playerStore.dispatch(zc({videoTrackValue:tp.videoTrackValue,isAbrEnabled:this.state.controller.isAbrEnabled})),this.broadcastAd&&this.playerStore.dispatch(nc({})),this.callbacks.onExpectedStalledChange(qt(kd.SetSource,{stream:e,params:t}))}performPlayCallbacks(){this.playCallbacks.length>0&&(w(this.playCallbacks),this.playCallbacks=[])}seekToVideoPosition(e,t){Number.isNaN(e)||(Er(this.state)&&!t?this.playerStore.dispatch(Mc({videoTime:e})):this.videoController.seek(e))}isLive(){return this.state.controller.videoType===rp.LIVE}getStartPositionForLoadSource(e,t){let{shouldSaveProgress:r}=t;const{controller:{currentTime:i,watchedTime:n}}=this.state,o=this.getUtcStartTime(),a=void 0===o?void 0:xl(o,i),s=d(e.startPosition)?e.startPosition:{};return r&&n>0?{videoTime:i,utc:a}:s}getUtcStartTime(){const{controller:{programDateTime:e}}=this.state;return void 0===e?void 0:Bl(e,1e3)}onError(e){const t=e instanceof Cd?e:new Cd(e,{code:e.code||ps.DEFAULT_ERROR});this.playerStore.dispatch(jc({error:t})),t.isFatal&&(!Er(this.state)&&this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.destroy(Dd.PlayerError),this.playerStore.dispatch(Eu(Ql.PAUSE)),this.resourceTimingsMonitor.updateInfo(),this.destroyVideoController())}async detachEncoder(){this.videoController&&(await this.videoController.detachEncoder(),this.playerStore.dispatch(Ec(ep.Detached)))}async attachEncoder(){this.state.controller.isOnline||await new Promise(e=>this.onlineMonitor.once("Online",e)),this.playerStore.dispatch(Ec(ep.Attaching));try{await this.videoController.attachEncoder()}catch(YE){throw this.playerStore.dispatch(Ec(ep.Detached)),YE}this.playerStore.dispatch(Ec(ep.Attached)),this.updateVolumeInfo();const e=this.state.controller.playingState,t=this.videoController.getPlayingState();t&&e!==t&&this.emit("VideoPlayingStateChange",t)}async destroyVideoController(){this.videoController&&(this.cacheVideoController(),await this.videoController.destroy(),this.playerStore.dispatch(Ec(ep.Detached)))}cacheVideoController(){if(this.config.cacheSourcesCount<=0)return;if(!this.videoController)return;if(this.state.controller.videoType!==rp.VOD)return;const e=this.videoController.createCachePreloader();if(!e)return;const t=Ki(this.videoController.getStreamUrl()),r=this.cachePreloaders.findIndex(e=>Ki(e.getSource().stream.url)===t);r>-1&&(this.cachePreloaders[r].destroy(),this.cachePreloaders.splice(r,1)),this.cachePreloaders.push(e)}runRequestAutoplaySettingsLogger(e,t,r){e.then(e=>{this.callbacks.logEvent({event:e.autoplay?"AutoplayAllowed":"AutoplayDisabled",params:{autoplaySettingsRequestResult:e,initialAutoplayParams:t,cachedAutoplayParams:r}})})}async playAfterWaitingForDocumentVisibility(){const{videoController:e}=this,{startStage:t,initialAutoplay:r}=this.state.controller;if(t===$h.waitForDocumentVisibility&&r&&e){this.callbacks.logEvent({event:Od.PlayAfterWaitingForDocumentVisibility,params:{}});try{var i;this.performPlayCallbacks(),await e.play(),null==(i=this.playDeferred)||i.resolve()}catch(a){var n,o;if(null!=(n=this.state.controller.errorInfo.error)&&n.isFatal)return void(null==(o=this.playDeferred)||o.reject(a));const{allowMuted:t,muted:r}=this.state.controller;if(!(t&&!r))return;this.setMuted(!0),e.play().then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()},e=>{var t;return null==(t=this.playDeferred)?void 0:t.reject(e)})}}}getContainerDocument(){return this.container.ownerDocument||document}getMainContainer(){return this.config.useFriendlyFrame?this.container:document}setPosterFitStyle(){h(this.video,Ra({objectFit:"cover"},this.playerStore.getState().controller.videoElementStyle))}resetPosterFitStyle(){h(this.video,Ra({objectFit:"contain"},this.playerStore.getState().controller.videoElementStyle))}hidePoster(){this.video.poster=od}preloadVideoControllerSource(){void 0!==this.videoController?(this.callbacks.logEvent({event:Od.PreloadSource,params:{whileAd:!0}}),t(this.videoController.preloadSource())):console.warn("preloadVideoControllerSource: videoController is undefined")}updateVolumeInfo(){this.playerStore.dispatch(yc({volume:this.video.volume,muted:this.video.muted,changeReason:nf.VolumeChangeEvent}))}}class Bm{constructor(e,t){void 0===e&&(e=window),this.handlers=[],this.onDestroy=new Pl,this.fullscreenElement=null,this.setFullScreenElementFromAPI=()=>{const e=H(this.win,this.video);this.setFullscreenElement(e)},this.win=e,this.video=t,t&&ud&&(this.onDestroy.addOne(g(t,"webkitbeginfullscreen",()=>{this.setFullscreenElement(t)})),this.onDestroy.addOne(g(t,"webkitendfullscreen",()=>{this.setFullscreenElement(null)}))),this.names=B(e,t),this.names&&(this.onDestroy.addOne(g(this.win.document,this.names.events.change,this.setFullScreenElementFromAPI)),this.setFullScreenElementFromAPI())}requestFullscreenForElement(e,t){if(void 0===this.names)throw new this.win.Error("Fullscreen is not supported");{const{request:r}=this.names;if(!(r in e))throw new this.win.Error("Fullscreen is not supported");e[r](t)}}isFullscreen(){return null!==this.fullscreenElement}exit(){if(void 0===this.names)throw new Error("Fullscreen is not supported");this.video&&this.fullscreenElement===this.video?this.video[this.names.exit]():this.win.document[this.names.exit]()}getFullscreenElement(){return this.fullscreenElement}addHandler(e){if("function"!==typeof e)throw new this.win.Error("Fullscreen handler must be a function");this.handlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e)}destroy(){this.handlers.length=0,this.onDestroy.dispatch(void 0)}setFullscreenElement(e){this.fullscreenElement=e,this.handlers.forEach(t=>t(e))}}const Hm=(e,t,r)=>{const i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=t.call(r,e[n],n,e);return i};class Gm{constructor(e){this.args=e,this.runningCount=0,this.callback=(e,t)=>{const r=e+1;t?r===this.strategies.length?this.args.callback(t):r===this.runningCount&&this.startNext():(this.stopUntil(r),this.args.callback(t))},this.strategies=Hm(e.strategyFactories,(e,t)=>e(e=>this.callback(t,e)))}static from(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{const r=[];for(const i of t){let t=()=>null;const n=i(_a({},e,{callback:e=>t(e)}));if(!n)return null;r.push(e=>(t=e,n))}return new Gm({callback:e.callback,strategyFactories:r})}}start(){!this.runningCount&&this.strategies.length&&this.startNext()}stop(){this.stopUntil(0)}get isDetermined(){for(const e of this.strategies)if(!e.isDetermined)return!1;return!0}getIsVisible(){for(let e=0;e<this.strategies.length;e++)if(!this.strategies[e].getIsVisible())return!1;return!0}startNext(){this.strategies[this.runningCount++].start()}stopUntil(e){for(;this.runningCount>e;)this.strategies[--this.runningCount].stop()}}const Wm=(e,t,r,i)=>function(){try{return t.apply(r||this,arguments)}catch(o){if(n(i)&&i(o),!0===o.preventProtect)throw o;Wm.log(o,e)}};Wm.log=function(e,t){console.log("LOG:"+t+":"+e)},Wm.setTimeout=(e,t,r,i)=>window.setTimeout(Wm("timeout",e,r,i),t);class Ym{}Ym.YaContextCallbacks=Pa("Ya.C","ontext._callbacks"),Ym.YaContextCallbacksCalls=Pa("Ya.C","ontext._callbacks_call"),Ym.AdvManager=Pa("A","dvManager"),Ym.AdvBlock=Pa("A","dvBlock"),Ym.RTB=Pa("R","TB"),Ym.Rtb=Pa("R","tb"),Ym.MetrikaAdtune=Pa("metrika_a","dtune");let jm="hidden",Km="visibilitychange";if(!(jm in document)){const e=["webkit","moz","ms","o"];for(const t of e){const e=t+"Hidden";if(e in document){jm=e,Km=t+"visibilitychange";break}}}const qm=new class{constructor(e){void 0===e&&(e=window),this.windowObj=e,this.initYaBrowserApi()}canUseYaBroApi(){return Boolean(this.yaBroApiInstance&&this.yaBroApiInstance.isInCustoPage)}isPageHiddenYaBroApi(){return!(this.yaBroApiInstance&&this.yaBroApiInstance.pageVisible)}initYaBrowserApi(){this.windowObj.browser&&this.windowObj.browser.BrowserEmbeddedApi&&this.windowObj.browser.BrowserEmbeddedApi.getInstance().then(e=>{this.yaBroApiInstance=e})}};class Xm{constructor(e){this.args=e,this.isDetermined=!0,this.onVisibilityChangeCallback=()=>{this.args.callback(this.getIsVisible())}}static factory(e){return new Xm(e)}start(){this.timer=window.setTimeout(()=>{this.onVisibilityChangeCallback(),this.subscription=function(e,t,r,i,n){if(!e||!r)return null;let o=Ca(Wm("handler:"+t,r,i));const a={un(){Vs(e,t,o)}};var s;return n&&n.once&&!xs&&(s=o,o=function(e){s.call(this,e),Oa(a)}),Ms(e,t,o,Fs?n:n&&n.capture),a}(document,Km,this.onVisibilityChangeCallback)})}stop(){window.clearTimeout(this.timer),Oa(this.subscription)}getIsVisible(){return!(qm.canUseYaBroApi()?qm.isPageHiddenYaBroApi():Boolean(document[jm]))}}const zm=function(e){void 0===e&&(e=window);const t=e.navigator.userAgent;return-1!==t.indexOf("Opera Mini")||(-1!==t.indexOf("; wv)")&&-1!==t.indexOf(" OPR/")||-1!==t.indexOf(" OPiOS/"))}();class Qm{constructor(e){this.args=e,this.isDetermined=!0,this.callback=e=>{const t=e[0].intersectionRatio>=this.observer.thresholds[0];this.args.callback(t)},this.threshold=Math.max(2**-149,this.args.portion),this.observer=new IntersectionObserver(this.callback,{threshold:this.threshold})}static factory(e){return"undefined"===typeof IntersectionObserver?null:"thresholds"in IntersectionObserver.prototype&&e.element?new Qm(e):null}start(){this.observer.observe(this.args.element)}stop(){this.observer.disconnect()}getIsVisible(){return e=this.args.element,t=this.threshold,zm?e.offsetWidth>0&&e.offsetHeight>0:ka(e)>=(t||Number.MIN_VALUE);var e,t}}let Jm;!function(e){e.PiP="PiP",e.YaBroEarly="YaBroEarly",e.YaBroAttrLegacy="YaBroAttrLegacy",e.YaBroAttrCurrent="YaBroAttrCurrent",e.OperaPopOut="OperaPopOut",e.SafariPresentationMode="SafariPresentationMode"}(Jm||(Jm={}));const Zm={[Jm.PiP]:{isSupported:e=>{if("pictureInPictureEnabled"in e.document){if(Na()){const t=Da(e);return 20===t.major&&t.minor>4||t.major>20}return!0}return!1},getCurrent:e=>e.document.pictureInPictureElement||null,observe:(e,t,r)=>t?(t.addEventListener("enterpictureinpicture",r),t.addEventListener("leavepictureinpicture",r),()=>{t.removeEventListener("enterpictureinpicture",r),t.removeEventListener("leavepictureinpicture",r)}):ne,getPipWindow:e=>e.pictureInPictureWindow||null},[Jm.YaBroEarly]:{isSupported:(e,t)=>"broughtOut"in t,getCurrent:(e,t)=>t&&"broughtOut"in t&&t.broughtOut?t:null,observe:(e,t,r)=>t?(t.addEventListener("oowvideobringin",r),t.addEventListener("oowvideobringout",r),()=>{t.removeEventListener("oowvideobringin",r),t.removeEventListener("oowvideobringout",r)}):ne},[Jm.YaBroAttrCurrent]:{isSupported:e=>{if(Na()){const t=Da(e);return 18===t.major&&t.minor>=6||t.major>18}return!1}},[Jm.YaBroAttrLegacy]:{isSupported:e=>Na()&&Da(e).major<18},[Jm.SafariPresentationMode]:{isSupported:(e,t)=>"webkitPresentationMode"in t,getCurrent:(e,t)=>t&&"picture-in-picture"===t.webkitPresentationMode?t:null,observe:(e,t,r)=>t?(t.addEventListener("webkitpresentationmodechanged",r),()=>t.removeEventListener("webkitpresentationmodechanged",r)):ne},[Jm.OperaPopOut]:{isSupported:(e,t)=>"onoperadetachedviewcontrol"in t&&"onoperadetachedviewchange"in t}},$m=[Jm.PiP,Jm.YaBroEarly,Jm.YaBroAttrCurrent,Jm.YaBroAttrLegacy,Jm.SafariPresentationMode,Jm.OperaPopOut];class eE extends Ad{constructor(e,t){void 0===e&&(e=window),super(),this.api=null,this.apiName=null,this.window=void 0,this.pipWindow=null,this.currentElement=null,this.unsubscribeFromApi=ne,this.handlePipEvent=e=>{var t;const r=e.target;this.digestCurrentElement(r);const i=Boolean(this.getCurrentElement());this.pipWindow=(null==(t=this.api)||null==t.getPipWindow?void 0:t.getPipWindow(e))||null,this.emit("Change",i)},this.window=e;const r=t||window.HTMLVideoElement.prototype;for(let n=0;n<$m.length;n++){const e=$m[n],t=Zm[e];try{if(t.isSupported(this.window,r)){this.api=t,this.apiName=e;break}}catch(i){}}this.digestCurrentElement(t),this.api&&this.api.observe&&(this.unsubscribeFromApi=this.api.observe(this.window,t,this.handlePipEvent))}getSupportedApiName(){return this.apiName}getCurrentElement(){return this.currentElement}addHandler(e){return this.api&&this.api.observe?(this.on("Change",e),()=>this.off("Change",e)):null}getPipWindowSize(){if(!this.pipWindow)return null;const{width:e,height:t}=this.pipWindow;return e&&t?{width:e,height:t}:null}destroy(){this.currentElement=null;const e=this.window.document;null!=e&&e.pictureInPictureElement&&(null==e.exitPictureInPicture||e.exitPictureInPicture()),this.off("Change"),this.unsubscribeFromApi()}digestCurrentElement(e){this.api&&this.api.getCurrent&&(this.currentElement=this.api.getCurrent(this.window,e))}}let tE,rE=null;try{"undefined"!==typeof IntersectionObserver&&(rE=Gm.from(Qm.factory,Xm.factory))}catch(jE){}class iE extends Ad{constructor(e){super(),this.isSupportedPipMode=!0,this.isYandexPipMode=!1,this.isVisibilitySupported=Boolean(rE),this.window=void 0,this.element=void 0,this.fullscreenApi=void 0,this.pipApi=void 0,this.video=void 0,this.state={isPip:!1,isFullScreen:!1,isVisible:!0},this.observe=e=>(this.on("Change",e),()=>this.off("Change")),this.fireVisualStateHandlers=()=>{const{isPip:e,isVisible:t,isFullScreen:r}=this.state,i={isPip:e,isVisible:t,isFullScreen:r,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode};this.emit("Change",i)},this.handleVisibilityChange=e=>{this.state.isVisible!==e&&(this.state.isVisible=e,this.fireVisualStateHandlers())},this.handlePipChange=e=>{this.state.isPip!==e&&(this.state.isPip=e,this.state.isFullScreen=this.getFullscreenStateProperty(this.fullscreenApi.getFullscreenElement()),this.fireVisualStateHandlers())},this.getFullscreenStateProperty=e=>La(this.video.ownerDocument,this.video)||this.video===e,this.handleFullscreenChange=e=>{const t=this.getFullscreenStateProperty(e);this.state.isFullScreen!==t&&(this.state.isFullScreen=t,this.fireVisualStateHandlers())},this.element=e,this.window=sa(this.element)}setVideoElement(e){void 0===this.video&&(this.video=e,this.observeFullscreen(),this.observePip())}setExternalVisibility(e){this.handleVisibilityChange(e)}setExternalFullscreen(e){this.state.isFullScreen!==e&&(this.state.isFullScreen=e,this.fireVisualStateHandlers())}changeFullscreenState(e){e.isFullScreen!==this.state.isFullScreen&&(e.isFullScreen?this.fullscreenApi.requestFullscreenForElement(this.video,{navigationUI:"hide"}):this.fullscreenApi.exit())}changePipState(e){e.isPip!==this.state.isPip&&(e.isPip||this.pipApi.destroy())}destroy(){this.emit("Destroy"),this.off("Destroy")}getState(){const{isPip:e,isVisible:t,isFullScreen:r}=this.state;return{isPip:e,isVisible:t,isFullScreen:r,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode}}getPipWindowSize(){return this.pipApi.getPipWindowSize()}observePip(){this.pipApi=new eE(sa(this.video),this.video),this.pipApi.addHandler(this.handlePipChange),this.once("Destroy",()=>{this.pipApi.destroy()});const e=this.pipApi.getSupportedApiName();this.isSupportedPipMode=e!==Jm.OperaPopOut,this.isYandexPipMode=e===Jm.YaBroAttrCurrent||e===Jm.YaBroAttrLegacy}observeFullscreen(){this.fullscreenApi=new Bm(this.window,this.video),this.fullscreenApi.addHandler(this.handleFullscreenChange),this.once("Destroy",()=>{this.fullscreenApi.destroy()})}}!function(e){e.Unknown="Unknown",e.ExternalApi="ExternalApi",e.VisiblePlayback="VisiblePlayback",e.RestoreAfterInsertInto="RestoreAfterInsertInto",e.WaitForSourceConfigUpdate="WaitForSourceConfigUpdate",e.CompletedRecoverSourceConfig="CompletedRecoverSourceConfig"}(tE||(tE={}));class nE extends Error{constructor(e,t){const r="object"===typeof e?e:{message:String(e)};if(super(String(r.message)),this.message=void 0,this.messageDetails=void 0,this.code=void 0,this.category=void 0,this.isFatal=void 0,this.details=void 0,this.stack=void 0,this.vsid=void 0,Mm()(this,nE.prototype),this.message=r.message||this.message,this.messageDetails=r.messageDetails,this.code=r.code||0,this.category=a(this.code),this.details=r.details,this.isFatal=void 0===r.isFatal||r.isFatal,this.stack=r.stack&&"?:?:?"!==r.stack?r.stack:this.details&&this.details.stack||((e,t)=>{const{url:r,line:i,col:n,fileName:o,columnNumber:a,lineNumber:s}=e;return String(t||(r||o||"?")+":"+(i||s||"?")+":"+(n||a||"?"))})(r,this.stack),!this.stack||this.stack===ol)try{throw new Error(this.message)}catch(i){this.stack=i.stack||ol}this.vsid=t||r.vsid}toString(){return JSON.stringify(this.toJSON())}toJSON(){const e={message:this.message,messageDetails:this.messageDetails,code:this.code,category:this.category,isFatal:this.isFatal,details:this.details,stack:this.stack,vsid:this.vsid};return Ma({},e,{raw:JSON.stringify(e)})}}class oE{setTimeout(e,t){if(t<=0)return void r(e,Va);const i=window.setTimeout(e,t);return()=>window.clearTimeout(i)}now(){return pl()}}class aE{constructor(e,t){void 0===t&&(t=new oE),this.distributionFunction=e,this.clock=t,this.stopped=!0,this.cancel=void 0,this.lastNow=0,this.lastKnockTime=void 0,this.lastTimeout=0,this.restTime=0,this.destroyed=!1,this.isFirstKnock=!0,this.count=0}setEnabled(e){return e?this.start():this.stop(),this}stop(){return this.stopped||(this.stopped=!0,this.cancelTimeout(),this.restTime=Math.max(this.restTime-(this.clock.now()-this.lastKnockTime),0)),this}start(){return this.stopped&&!this.destroyed&&(this.stopped=!1,this.lastKnockTime=this.clock.now(),this.setTimeout(()=>this.knock(this.lastNow+this.lastTimeout),this.restTime)),this}destroy(){this.cancelTimeout(),this.stopped=!0,this.destroyed=!0}knock(e){this.lastNow=e,this.lastKnockTime=this.clock.now(),this.isFirstKnock?this.isFirstKnock=!1:this.count++;const t=this.restTime=this.lastTimeout=this.distributionFunction({time:e,count:this.count});this.stopped||this.destroyed||this.setTimeout(()=>this.knock(e+t),t)}cancelTimeout(){void 0!==this.cancel&&this.cancel(),this.cancel=void 0}setTimeout(e,t){this.cancelTimeout();const r=this.clock.setTimeout(e,t);void 0!==r&&(this.cancelTimeout(),this.cancel=r)}}const sE=[0,1,4,5];let lE=Ll(0);const dE=sE.map(e=>(lE=xl(Ll(e),lE),lE)),cE=Ul(dE[dE.length-1],1e3),uE=[kd.Init];const hE=["from","vsid"],pE=["playready-proxy.ott.yandex.ru","playready-proxy-preproduction.ott.yandex.ru","widevine-proxy.ott.yandex.ru","widevine-proxy-preproduction.ott.yandex.ru","fairplay-proxy.ott.yandex.ru","fairplay-proxy-preproduction.ott.yandex.ru","drm.yandex-team.ru"],fE=e=>{let t=e;return cl(e)?[].concat(e).map(e=>fE(e)):np(e)?new Date(e.getTime()):(!n(e)&&d(e)&&(t={},y(e,(e,r)=>{t[r]=fE(e)})),t)};let vE;!function(e){e.play="play",e.pause="pause",e.seek="seek",e.setSource="setSource",e.preloadSource="preloadSource",e.abortPreloadSource="abortPreloadSource",e.setVolume="setVolume",e.setMuted="setMuted",e.setFullscreen="setFullscreen",e.setPictureInPicture="setPictureInPicture",e.setPlaybackRate="setPlaybackRate",e.setVideoTrack="setVideoTrack",e.setAudioTrack="setAudioTrack",e.setTextTrack="setTextTrack",e.changeAdditionalParams="changeAdditionalParams",e.setNativeTextTrackVisibility="setNativeTextTrackVisibility",e.setNativeAdControlsVisibility="setNativeAdControlsVisibility",e.setHiddenControls="setHiddenControls",e.setVideoStyle="setVideoStyle",e.setPictureInPictureEnabled="setPictureInPictureEnabled",e.setFeed="setFeed",e.setExternalVisualState="setExternalVisualState",e.getExternalVisualState="getExternalVisualState",e.getConfig="getConfig",e.requestDebugInfo="requestDebugInfo",e.xhrRequest="xhrRequest",e.stopAd="stopAd",e.playInrollAd="playInrollAd",e.skipAdPod="skipAdPod",e.destroy="destroy"}(vE||(vE={}));let gE=0;const mE=["requestId"],EE=Nl(6e4);const AE=e=>void 0===e?void 0:String(e),yE={state:ap.NOT_PLAYING,type:void 0,adParams:{}},TE={sourceId:NaN,data:void 0},SE=Nl(1e4),RE=Nl(1e3),_E=Nl(5e3),PE=Nl(3e4);class IE extends _l{constructor(e,t){super(),this.onTick=e,this.onFlush=t,this.wasFirstFlush=!1,this.lastFlushTime=void 0,this.startTime=void 0,this.timer=void 0,this.handleTimeout=()=>{this.onTick(),this.handleFlush(),this.nextTick()},this.startTime=this.lastFlushTime=El(),this.timer=window.setTimeout(()=>{this.onTick(),this.nextTick()},0)}next(){this.isDestroyed||(window.clearTimeout(this.timer),this.handleFlush(),this.nextTick())}destroy(){super.destroy(),window.clearTimeout(this.timer)}nextTick(){this.isDestroyed||(window.clearTimeout(this.timer),this.timer=window.setTimeout(this.handleTimeout,this.getTimeout()))}handleFlush(){this.needFlush()&&(this.onFlush(),this.lastFlushTime=this.wasFirstFlush?El():this.startTime,this.wasFirstFlush=!0)}needFlush(){const e=El();return this.wasFirstFlush?e-this.lastFlushTime>=PE:e-this.startTime>=SE}getTimeout(){return El()-this.startTime<SE?RE:_E}}class bE extends _l{constructor(e){super(),this.props=e,this.prevState=void 0,this.states=[],this.timer=void 0,this.timer=new IE(()=>{this.writeState()},()=>{this.flushStates()})}destroy(){super.destroy(),this.timer.destroy(),this.flushStates()}getStates(){return[...this.states]}flushStates(){const e=this.getStates();e.length>0&&this.props.onFlushStates(e),this.states.length=0}writeStateManually(){this.writeState(),this.timer.next()}writeState(){const e=this.props.getState();void 0!==e&&(Vp()(this.prevState,e)||(this.prevState=e,this.states.push(Ja({},e,{timestamp:F(Nl(Date.now()))}))))}}const CE=NaN,OE={remainingBufferedTime:x(Ll(0)),state:Ql.BUFFERING,currentTime:x(Qh),watchedTime:x(Ll(0)),duration:x(tp.duration)},wE=Ka(window.location),kE=wE.vsid,DE="true"===wE.use_friendly_frame,NE=DE;var LE;let ME;d(LE=wE)&&r(()=>{!function(e){Vd.flagsInited||(Vd.flagsInited=!0,d(e)&&d(e.flags)&&r(()=>{y(e.flags,(e,t)=>{Vd.flags[t]=String(e)})}))}({flags:JSON.parse(LE.flags)})});const VE=new class extends Ad{getDataFromPostMessageEvent(e){let{data:t}=e;if("object"!==typeof t)return;const{id:r,batch:i}=t;return"string"===typeof r&&0!==r.length&&i&&Array.isArray(i)?{id:r,batch:i}:void 0}constructor(e){let{id:t,sender:r,receiver:i,syncMode:n=!1,internal:o=!1}=e;super(),this.id=void 0,this.key=void 0,this.abortRequestMap=Object.create(null),this.sender=void 0,this.receiver=void 0,this.sendPromise=void 0,this.messagesBatch=[],this.receiverCallback=void 0,this.id=t,this.key=n?"handle_data_"+t:void 0,this.sender=r,this.receiver=i;const a=e=>{const{id:t,batch:r}=e;t===this.id&&r.forEach(e=>{let{answer:t,command:r,event:i}=e;if(t&&void 0!==t.requestId&&this.emit("Answer",t),i&&this.emit("Event",i),!r)return;const a=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(r,mE),s=qa({},o&&n?fE(a):a,{sendAnswer:e=>{this.sendAnswer(e,r.requestId)}});this.emit("Command",s)})};this.receiverCallback=e=>{const t=this.getDataFromPostMessageEvent(e);void 0!==t&&a(t)},this.key&&(i[this.key]=a),i.addEventListener("message",this.receiverCallback)}sendEvent(e,t){let{data:r,sourceId:i}=t;const n={eventName:e,data:r,sourceId:i};this.sendPostMessage({event:n})}sendCommand(e,t){const r={commandName:e,params:t};this.sendPostMessage({command:r})}sendRequest(e,t,r){void 0===r&&(r=EE);const i={commandName:e,params:t,requestId:gE++},n=this.waitForAnswer(i,r);return this.sendPostMessage({command:i}),n}destroy(){this.receiver.removeEventListener("message",this.receiverCallback),this.off("Command"),this.off("Answer"),this.off("Event"),this.off("Error"),y(this.abortRequestMap,e=>e())}flush(){if(this.sendPromise=void 0,0===this.messagesBatch.length)return;const e={id:this.id,batch:[...this.messagesBatch]};this.messagesBatch=[];try{this.sender.postMessage(e,"*")}catch(t){this.safeSendClonedData(e,"*")}}waitForAnswer(e,t){let r,i=ne;const n=()=>{clearTimeout(r),i(),delete this.abortRequestMap[e.requestId]};return new Promise(o=>{r=window.setTimeout(()=>{const t=this.abortRequestMap[e.requestId];"function"===typeof t&&t()},t);const a=t=>{t.requestId===e.requestId&&(n(),o(t.data))};this.on("Answer",a),i=()=>this.off("Answer",a),this.abortRequestMap[e.requestId]=n})}sendAnswer(e,t){void 0===t&&(t=-1);const r={data:e,requestId:t};this.sendPostMessage({answer:r})}sendPostMessage(e){let{event:t,command:r,answer:i}=e;if(this.key)try{const e={id:this.id,batch:[{event:t,answer:i,command:r}]};return void this.sender[this.key](e)}catch(jE){}this.messagesBatch.push({event:t,answer:i,command:r}),this.planRealSend()}safeSendClonedData(e,t){try{this.sender.postMessage(JSON.parse(JSON.stringify(e)),t)}catch(YE){this.emit("Error",YE)}}planRealSend(){void 0===this.sendPromise&&(this.sendPromise=Promise.resolve().then(()=>this.flush()))}}({id:kE,sender:window.parent,receiver:window,syncMode:NE,internal:!0}),xE=e=>{VE.sendEvent("onLogEvent",{sourceId:-1,data:e})},FE=new class extends Ad{constructor(e){super(),this.getPreloadDetails=e,this.isBuffering=!1,this.timer=void 0,this.stalledId=1,this.expectedStalled=qt(kd.Init,void 0),this.currentStalled=void 0,this.stalledTime=Ll(0),this.stalledCount=0}setBuffering(e){var t;if(e!==this.isBuffering)if(this.isBuffering=e,this.isBuffering)this.timer=new aE(e=>{let{count:t}=e;const r=this.getExpectedStalled();if(t>0){const e=Ll(dE[t-1]),i=this.currentStalled?this.currentStalled.id:this.stalledId++;this.currentStalled||this.stalledCount++,this.currentStalled={id:i,expectedStalled:r,duration:e,getElapsedTime:Y()},this.send(!1,r,e,i),e===Ll(10)&&this.sendLongStalledDebugLog()}return t>=sE.length?(this.destroyTimer(),1/0):1e3*sE[t]}),this.timer.start();else{if(this.currentStalled){const{expectedStalled:e,id:r}=this.currentStalled,i=void 0===(t=this.currentStalled)?Ll(0):xl(t.duration,Bl(t.getElapsedTime(),1e3));this.send(!0,e,i,r),this.currentStalled=void 0,this.stalledTime=xl(i,this.stalledTime)}this.destroyTimer()}}getStalledHistory(){const{stalledCount:e,stalledTime:t}=this;return{stalledCount:F(e),stalledTime:x(t)}}clearStalledHistory(){this.stalledCount=0,this.stalledTime=Ll(0)}destroy(){this.destroyTimer()}getCurrentStalledReason(){var e;return null==(e=this.currentStalled)?void 0:e.expectedStalled.reason}setExpectedStalled(e){this.expectedStalled=e}isExpiredStalled(e){const{getElapsedTime:t,reason:r}=e;return!(uE.indexOf(r)>-1)&&((!this.currentStalled||this.currentStalled.expectedStalled!==e)&&t()>=cE)}getExpectedStalled(){const e=this.expectedStalled;return this.isExpiredStalled(e)?qt(kd.Other,void 0):e}destroyTimer(){this.timer&&(this.timer.destroy(),this.timer=void 0)}send(e,t,r,i){const{reason:n,details:o}=t,a={id:i,isStalledEnd:e,reason:n,stalledDuration:r,details:xa({},o,n===kd.SetSource&&this.getPreloadDetails())};this.emit("SendStalled",a)}sendLongStalledDebugLog(){this.emit("SendLongStalledDebugLog")}}(()=>{var e;return null==(e=ME)?void 0:e.getPreloadDetails()});FE.on("SendStalled",e=>{var t,r,i;xE({event:e.isStalledEnd?"StalledEnd":"Stalled",params:es({},e.details,{stalledDuration:e.stalledDuration,remainingBufferedTime:null==(t=ME)?void 0:t.getRemainingBufferedTime(),videoTrack:null==(r=ME)?void 0:r.getVideoTrack(),stalledId:e.id,isMuted:null==(i=ME)?void 0:i.getMuted()}),additionalStatsLabels:{reason:e.reason}})}),FE.on("SendLongStalledDebugLog",async()=>{var e;const t=await(null==(e=ME)?void 0:e.getLongStalledDebugInfo());t&&xE({event:"LongStalledDebugLog",params:es({},t)})});const UE=e=>{const t=Xa(e),r=t.isFatal?s(t.code,HE):void 0,i=Xa(new nE(es({},t,{messageDetails:r})));VE.sendEvent("onError",{sourceId:ts(),data:i})};let BE=tE.Unknown,HE=ds,GE=Ql.PAUSE;ve(window).playerJsLoaded=!0;const WE={};(async()=>{const e=async function(e){const t=DE&&Md.initialStreamPlayerParams?fE(Md.initialStreamPlayerParams):await e.sendRequest(vE.getConfig,void 0);return es({},t,{maxRecoverAttempts:t.maxRecoverAttempts,env:t.env,device:t.device,bandwidthEstimateOffset:t.bandwidthEstimateOffset,maxBufferLength:t.maxBufferLength,skinConfig:t.skinConfig,backgroundColor:t.backgroundColor,togglePlaybackOnVisibilityChange:t.togglePlaybackOnVisibilityChange})}(VE),t={onDrmSystemChange:e=>{VE.sendEvent("onDrmSystemChange",{sourceId:ts(),data:e})},onChangeStream:e=>{VE.sendEvent("onChangeStream",{sourceId:ts(),data:e}),e&&(Qa({preview:s.preview,adConfig:s.adConfig,additionalParams:o},e.url),s.stream=e)},onError:UE,onRecover:e=>{VE.sendEvent("onRecover",{sourceId:ts(),data:e})},onStateChange:e=>{const t=ts();GE===Ql.BUFFERING&&e===Ql.PLAY&&FE.setExpectedStalled(qt(kd.Other,void 0)),e===Ql.BUFFERING?FE.setBuffering(!0):FE.setBuffering(!1),s.playingState!==e&&(s.playingState=e,VE.sendEvent("onStateChange",{sourceId:t,data:{playingState:e,reason:BE}}),BE=tE.Unknown,d.writeStateManually()),GE=e},onAdStateChange:e=>{const{adState:t,playingState:r}=s;t.state===ap.NOT_PLAYING&&e.state===ap.PLAYING&&FE.setBuffering(!1);t.state===ap.PLAYING&&e.state===ap.NOT_PLAYING&&r===Ql.BUFFERING&&FE.setBuffering(!0),t.state!==e.state&&(BE=tE.Unknown),s.adState=e,VE.sendEvent("onAdStateChange",{sourceId:ts(),data:e})},onAdLoaded:e=>{VE.sendEvent("onAdLoaded",{sourceId:ts(),data:e})},onAdError:()=>{VE.sendEvent("onAdError",{sourceId:ts(),data:void 0})},onBeforeAdPodStart:e=>{NE&&VE.sendEvent("onBeforeAdPodStart",{sourceId:ts(),data:e})},onAdPodStart:e=>{VE.sendEvent("onAdPodStart",{sourceId:ts(),data:e})},onAdPodClick:()=>{VE.sendEvent("onAdPodClick",{sourceId:ts(),data:void 0})},onAdPodSkip:()=>{VE.sendEvent("onAdPodSkip",{sourceId:ts(),data:void 0})},onAdPodEnd:()=>{VE.sendEvent("onAdPodEnd",{sourceId:ts(),data:void 0})},onAdSkippableStateChange:e=>{VE.sendEvent("onAdSkippableStateChange",{sourceId:ts(),data:e})},onAdPodCloseStateChange:e=>{VE.sendEvent("onAdPodCloseStateChange",{sourceId:ts(),data:e})},onAdPodDurationChange:e=>{VE.sendEvent("onAdPodDurationChange",{sourceId:ts(),data:e})},onAdPodCurrentTimeChange:e=>{VE.sendEvent("onAdPodCurrentTimeChange",{sourceId:ts(),data:e})},onAdPodTimeToSkipChange:e=>{VE.sendEvent("onAdPodTimeToSkipChange",{sourceId:ts(),data:e})},onAdVolumeAvailabilityStateChange:e=>{VE.sendEvent("onAdVolumeAvailabilityStateChange",{sourceId:ts(),data:e})},onAdInteraction:()=>{VE.sendEvent("onAdInteraction",{sourceId:ts(),data:void 0})},onVideoTypeChange:e=>{VE.sendEvent("onVideoTypeChange",{sourceId:ts(),data:e})},onDVRStartTimeChange:()=>{void 0!==ME&&VE.sendEvent("onTimelineInfoChange",{sourceId:ts(),data:ME.getTimelineInfo()})},onDVRDurationChange:()=>{void 0!==ME&&VE.sendEvent("onTimelineInfoChange",{sourceId:ts(),data:ME.getTimelineInfo()})},onCurrentTimeChange:()=>{void 0!==ME&&(VE.sendEvent("onPositionChange",{sourceId:ts(),data:{time:ME.getCurrentTime(),utcTime:ME.getUtcPosition(),watchedTime:ME.getWatchedTime(),videoPlaybackQuality:ME.getVideoPlaybackQuality(),liveLatency:ME.getLiveLatency()}}),VE.sendEvent("onTimelineInfoChange",{sourceId:ts(),data:ME.getTimelineInfo()}))},onFullScreenChange:e=>{VE.sendEvent("onFullScreenChange",{sourceId:ts(),data:e})},onVolumeChange:e=>{VE.sendEvent("onVolumeChange",{sourceId:ts(),data:e})},onVideoTrackChange:e=>{VE.sendEvent("onVideoTrackChange",{sourceId:ts(),data:e})},onVideoTracksChange:e=>{VE.sendEvent("onVideoTracksChange",{sourceId:ts(),data:e})},onAudioTrackChange:e=>{VE.sendEvent("onAudioTrackChange",{sourceId:ts(),data:e})},onAudioTracksChange:e=>{VE.sendEvent("onAudioTracksChange",{sourceId:ts(),data:e})},onTextTrackChange:e=>{VE.sendEvent("onTextTrackChange",{sourceId:ts(),data:e})},onTextTracksChange:e=>{VE.sendEvent("onTextTracksChange",{sourceId:ts(),data:e})},onSubtitlesChange:e=>{VE.sendEvent("onSubtitlesChange",{sourceId:ts(),data:e})},onPlaybackRateChange:e=>{VE.sendEvent("onPlaybackRateChange",{sourceId:ts(),data:e})},onThumbnailTileGeneralMetaInfoChange:e=>{VE.sendEvent("onThumbnailTileGeneralMetaInfoChange",{sourceId:ts(),data:e})},onOriginalBroadcastAdStateChange:e=>{VE.sendEvent("onOriginalBroadcastAdStateChange",{sourceId:ts(),data:e})},onAdblockDetected:e=>{HE=e},onContentImpression:e=>{VE.sendEvent("onContentImpression",{sourceId:ts(),data:e})},onResourcesIdle:()=>{VE.sendEvent("onResourcesIdle",{sourceId:ts(),data:void 0})},onVisualStateChange:e=>{VE.sendEvent("onVisualStateChange",{sourceId:ts(),data:e})},onBufferingRangesChange:e=>{VE.sendEvent("onBufferingRangesChange",{sourceId:ts(),data:e})},onStartStageChange:e=>{VE.sendEvent("onStartStageChange",{sourceId:ts(),data:e})},onVideoSizeChange:e=>{VE.sendEvent("onVideoSizeChange",{sourceId:ts(),data:e})},onNextAdRemainingTimeChange:e=>{VE.sendEvent("onNextAdRemainingTimeChange",{sourceId:ts(),data:e})},onVideoClickerEvent:e=>{VE.sendEvent("onVideoClickerEvent",{sourceId:ts(),data:e})},logEvent:xE,onAdSDKVersionDefined:e=>{VE.sendEvent("onAdSDKVersionDefined",{sourceId:ts(),data:e})},onStreamsWithSupportInfoChange:e=>{VE.sendEvent("onStreamsWithSupportInfoChange",{sourceId:ts(),data:e})},onEngineChange:(e,t)=>{VE.sendEvent("onEngineChange",{sourceId:t,data:e})},onNetworkStatusChange:e=>{VE.sendEvent("onNetworkStatusChange",{sourceId:ts(),data:e})},onBandwidthEstimateChange:e=>{VE.sendEvent("onBandwidthEstimateChange",{sourceId:ts(),data:e})},onExpectedStalledChange:e=>{FE.setExpectedStalled(e)}},r=await e.then(e=>es({},e,{callbacks:t}));let o=r.source.params.additionalParams;r.env&&jf.setDeviceType(r.env.deviceType),VE.sendEvent("onInit",TE);const a=function(e){const t=DE?window.parent.document.getElementById(va(kE)):document.getElementById("q");if(!t)throw new nE({code:fs.PLAYER_CONTAINER_NOT_FOUND,isFatal:!1,details:e,message:"Player container was not found"});return t}(r);(function(e){return void 0===e&&(e=window),oe(e.document.querySelectorAll("style[data-ya-player-style]"))})().forEach(e=>function(e,t){aa(e)!==aa(t)&&t.appendChild(e)}(e,a)),function(e){if(e.source.streams.some(e=>{let{url:t}=e;return Jt(t)})){const e=i(window),t=document.createElement("link");t.rel="preconnect",t.href="https://strm.yandex.ru",e.appendChild(t)}}(r);const s=function(e){const[t]=e.source.streams;return{playingState:void 0,startPosition:e.source.params.startPosition.videoTime,env:e.env,withCredentials:e.source.params.withCredentials,preview:e.source.params.preview,stream:t,adConfig:e.source.params.adConfig,adState:yE,yaDirectPixelUrl:e.source.params.yaDirectPixelUrl,yaDirectPixelData:e.source.params.yaDirectPixelData}}(r),l=new iE(a),d=function(e,t,r,i){const n=new bE({getState:()=>{var r;const n=$a({},OE,{isMuted:i.muted,saveData:Io()},t.getStalledHistory()),o=e();if(void 0===o)return n;const a=o.getVideoTrack(),s=o.getAudioTrack(),{droppedVideoFrames:l,totalVideoFrames:d}=o.getVideoPlaybackQuality(),c=o.getState(),{videoWidth:u,videoHeight:h}=c.controller,p=o.getBandwidthEstimate(),f=o.getVideoTracks()[0],v=o.getMaxCapAllowedVideoTrack(),g=o.getLiveLatency(),m=o.getRemainingBufferedTime(),E=null==(r=c.ad.adInfo)?void 0:r.adType,A=!E,y=o.getPlayingState(),T=o.getSegmentSize(),S=o.getContainerSize();return $a({},n,{isVisible:c.controller.isVisible,currentTime:x(o.getCurrentTime()),watchedTime:x(o.getWatchedTime()),duration:x(isNaN(o.getDuration())?Ll(0):o.getDuration()),liveLatency:void 0===g?void 0:x(g),isMuted:c.controller.muted,ad:E,remainingBufferedTime:x(m.total),remainingVideoBufferedTime:void 0===m.video?void 0:x(m.video),remainingAudioBufferedTime:void 0===m.audio?void 0:x(m.audio),state:y,auto:void 0===a?void 0:a.auto,bitrate:a&&a.bitrate?Math.max(0,Math.floor(Ul(a.bitrate,1e3))):void 0,width:F(u)||void 0,height:F(h)||void 0,maxWidth:A&&null!=f&&f.width?F(Vl(f.width)):void 0,maxHeight:A&&null!=f&&f.height?F(Vl(f.height)):void 0,capWidth:A&&null!=v&&v.width?F(Vl(v.width)):void 0,capHeight:A&&null!=v&&v.height?F(Vl(v.height)):void 0,containerWidth:void 0!==S?F(S.width):void 0,containerHeight:void 0!==S?F(S.height):void 0,audioBitrate:s&&s.bitrate?Math.max(0,Math.floor(Ul(s.bitrate,1e3))):void 0,audioTrack:s&&s.value||void 0,audioLang:s&&s.lang||void 0,droppedFrames:F(l)||void 0,shownFrames:F(d-l)||void 0,bandwidthEstimate:void 0===p||isNaN(p.value)?void 0:F(wl(Math.round(p.value))),bandwidthSource:(null==p?void 0:p.source)||void 0,rtt:Za()||void 0,stalledReason:t.getCurrentStalledReason(),segmentWidth:A&&T?F(T.width):void 0,segmentHeight:A&&T?F(T.height):void 0})},onFlushStates:e=>{r({event:"PlayerAlive",params:{states:e}})}}),o=P(document,e=>{e||n.flushStates()});return n.addDestroyHandler(o),n}(()=>ME,FE,xE,r);ME=new Um(a,r,{visualState:l},()=>VE.sendEvent("onReady",TE)),VE.on("Command",e=>{switch(e.commandName){case vE.pause:BE=e.params,void 0!==ME&&ME.pause(),e.sendAnswer();break;case vE.play:BE=e.params,ME?ME.play().then(()=>{e.sendAnswer(!0)}).catch(()=>{e.sendAnswer(!1)}):e.sendAnswer(!1);break;case vE.seek:ME.seek({videoTime:e.params});break;case vE.setPlaybackRate:ME.setPlaybackRate(e.params);break;case vE.changeAdditionalParams:d.flushStates();break;case vE.setSource:const{sourceConfig:t,shouldSaveProgress:i}=e.params;if(!t)throw new nE("setSource method receives an object");d.flushStates(),FE.clearStalledHistory(),e.sendAnswer(),VE.flush(),s.adConfig=t.params.adConfig,s.yaDirectPixelUrl=t.params.yaDirectPixelUrl,s.yaDirectPixelData=t.params.yaDirectPixelData,s.startPosition=t.params.startPosition.videoTime,s.withCredentials=t.params.withCredentials,s.stream=t.streams[0],s.preview=t.params.preview;const{additionalParams:a}=t.params;a&&(o=a),t.streams=t.streams.map(e=>es({},e,{drmConfig:e.drmConfig?Ba(e.drmConfig,o.vsid):void 0,url:Fa({url:e.url,adConfig:s.adConfig,additionalParams:o})})),Qa(t,t.streams[0].url),ME.setSource(t,{shouldSaveProgress:i});break;case vE.preloadSource:const{sourceConfig:c,requestId:u}=e.params,{additionalParams:h}=c.params;c.streams=c.streams.map(e=>es({},e,{drmConfig:e.drmConfig?Ba(e.drmConfig,h.vsid):void 0,url:Fa({url:e.url,adConfig:c.params.adConfig,additionalParams:h})}));const{promise:p,abort:f}=ME.preloadSource(c);WE[u]=f,p.then(()=>{VE.sendEvent("onPreloadSourceResolve",{sourceId:-1,data:u})}).catch(()=>{VE.sendEvent("onPreloadSourceReject",{sourceId:-1,data:u})}).then(()=>{delete WE[u]});break;case vE.abortPreloadSource:const v=WE[e.params];n(v)&&(v(),delete WE[e.params]);break;case vE.setVolume:e.params>0&&ME.setMuted(!1),ME.setVolume(e.params);break;case vE.setMuted:ME.setMuted(e.params);break;case vE.setVideoTrack:ME.setVideoTrack(e.params);break;case vE.setAudioTrack:ME.setAudioTrack(e.params);break;case vE.setTextTrack:ME.setTextTrack(e.params);break;case vE.setNativeTextTrackVisibility:ME.setNativeTextTrackVisibility(e.params);break;case vE.setNativeAdControlsVisibility:ME.setNativeAdControlsVisibility(e.params);break;case vE.setFullscreen:ME.setFullscreen(e.params);break;case vE.setPictureInPicture:l.changePipState({isPip:e.params});break;case vE.setHiddenControls:ME.setHiddenControls(e.params);break;case vE.setVideoStyle:ME.setVideoStyle(e.params);break;case vE.setPictureInPictureEnabled:ME.setPictureInPictureEnabled(e.params);break;case vE.setFeed:ME.setFeed(e.params);break;case vE.requestDebugInfo:(async function(){let e={};void 0!==ME&&(e=await ME.requestDebugInfo());const{playingState:t}=s;return es({},e,s,{playingState:t,vsid:kE,version:"1.0-1025",utcPosition:ME.getUtcPosition(),currentTime:ME.getCurrentTime(),system:ja(),clientTimestamp:Date.now(),streamUrl:s.stream.url,internalInitialConfig:r})})().then(t=>e.sendAnswer(t));break;case vE.stopAd:ME.stopAd({stopAdReason:Dd.InsertIntoCalled,data:{loadPositionAfterAd:void 0}}).then(()=>{e.sendAnswer()});break;case vE.playInrollAd:ME.playInrollAd(e.params);break;case vE.skipAdPod:ME.skipAdPod();break;case vE.destroy:l.destroy(),FE.destroy(),d.destroy(),void 0!==ME&&ME.destroy(),e.sendAnswer(e.params);break;case vE.setExternalVisualState:"boolean"===typeof e.params.isVisible&&l.setExternalVisibility(e.params.isVisible),"boolean"===typeof e.params.isFullscreen&&l.setExternalFullscreen(e.params.isFullscreen);break;default:throw new Error("IFrameApi Error: unexpected command in MessageEvent: "+e.commandName)}}),VE.on("Error",e=>{const t=new bd(e,{code:fs.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR,details:{},isFatal:!1});VE.sendEvent("onError",{sourceId:ts(),data:t.toJSON()})}),"boolean"===typeof Md.initialVisibility?l.setExternalVisibility(Md.initialVisibility):VE.sendRequest(vE.getExternalVisualState,void 0).then(e=>{let{isVisible:t}=e;l.setExternalVisibility(t)})})().catch(e=>{VE.sendEvent("onInitError",{sourceId:1,data:Xa(new bd(e,{isFatal:"boolean"!==typeof e.isFatal||e.isFatal,code:e.code||fs.ON_PLAYER_INIT_ERROR}))})})})()})();